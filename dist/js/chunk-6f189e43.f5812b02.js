(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6f189e43"],{"150f":function(a,e,t){(e=t("24fb")(!1)).push([a.i,".content-main[data-v-04ba104a]{padding:0 15px}.form-table-box[data-v-04ba104a]{background-color:#fff}.order-search[data-v-04ba104a]{overflow:hidden}.order-search[data-v-04ba104a] .el-date-editor,.order-search[data-v-04ba104a] .el-select{width:100%;height:40px;-webkit-box-sizing:border-box;box-sizing:border-box}.order-search[data-v-04ba104a] .el-select>>>.el-input{height:40px}.order-search[data-v-04ba104a] .el-range-input{background-color:#fff;font-size:12px;line-height:32px}.order-search[data-v-04ba104a] .el-date-editor .el-range-separator{font-size:12px}.order-search .fixHeight[data-v-04ba104a]{height:40px}.order-search[data-v-04ba104a] .el-date-editor .date-tip-logo{display:none}.form-table-box .filter-link-more[data-v-04ba104a]{float:right;padding:9px 20px;margin-top:6px}.order-search>.s-query>li .td[data-v-04ba104a]{height:40px}.s-query>li.long-column[data-v-04ba104a]{width:360px}.s-query>li.margin-next[data-v-04ba104a]{margin-left:20px}.form-tip-box[data-v-04ba104a]{color:#999}.form-table-box .batch-btn-area[data-v-04ba104a]{text-align:right}.batch-form-box[data-v-04ba104a] .el-form-item{margin-bottom:0}",""]),a.exports=e},"1c30":function(a,e,t){var i=t("150f");"string"==typeof i&&(i=[[a.i,i,""]]),i.locals&&(a.exports=i.locals);(0,t("499e").default)("9992668e",i,!0,{sourceMap:!1,shadowMode:!1})},"1f88":function(a,e,t){"use strict";t.r(e);var i=t("ed86"),s=t.n(i);for(var l in i)["default"].indexOf(l)<0&&function(a){t.d(e,a,(function(){return i[a]}))}(l);e.default=s.a},"9ee8":function(a,e,t){"use strict";t.r(e);var i=t("f16a"),s=t("1f88");for(var l in s)["default"].indexOf(l)<0&&function(a){t.d(e,a,(function(){return s[a]}))}(l);t("cefa");var o=t("2877"),r=Object(o.a)(s.default,i.a,i.b,!1,null,"04ba104a",null);e.default=r.exports},cefa:function(a,e,t){"use strict";t("1c30")},ed86:function(a,e,t){"use strict";var i=t("4ea4");t("4160"),t("c975"),t("a15b"),t("a434"),t("d3b7"),t("ac1f"),t("25f0"),t("5319"),t("159b"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=i(t("5530")),l=t("0475"),o=t("2af9"),r=t("2f62"),c={name:"label-list",data:function(){return{fixedCol:!0,labelDate:[],orderId:"",zxsModel:"",zxsManaModel:"",labelSeleId:"",labelSeleName:"",appealDate:[],cityId:"",formList:[],zxsList:[],zxsLeadList:[],tableList:[],configPara:{},tablePara:{},tableFilterFlag:!0,pageLimit:20,dataSum:0,isPage:!0,tableLabel:[],isBatchBtnShow:!1,tableData:[],page:1,curRole:"",hasCheckBox:!1,headerFlag:!1,cityFlag:!1,labelList:[],isBatch:!1,checkInit:!1,isOperate:!0,isTag:!1,searchType:"1",batchDis:!0,passDialog:!1,appealId:[],tbRef:"",failObj:{},appeal_id:"",batchPassNum:{waitNum:0,allNum:0},tipText:"您是想一键通过这00个标签（或订单）的申诉吗？系统会记录您的审核日志，请谨慎操作。",status:[],repeatSub:!0,batchSub:!0,batchForm:{selectId:"",batchLabelName:"",tagList:""},appealStatusList:[],appealStatus:"",cityListAppeal:[],batchFormRules:{},pickerOptions:{}}},components:{SelectTo:o.SelectTo,TableBox:l.TableBox,TableBoxAppealFixed:l.TableBoxAppealFixed,Modal:l.Modal},created:function(){var a=this;if(this.employeeName.role){if(this.curRole=this.employeeName.role,"admin"===this.employeeName.role||"admin-sop"===this.employeeName.role||"brand_administration"===this.employeeName.role||"brand_commissioner"===this.employeeName.role||"brand_manager"===this.employeeName.role||"service_product"===this.employeeName.role){this.cityFlag=!0;this.axios.get("/backend-api/select2/select2/get-city-list-select2",{params:{city_type:"1"}}).then((function(e){0===e.data.code&&(a.cityListAppeal=e.data.data)})).catch((function(a){console.log(a)}))}else this.cityFlag=!1;"header_manager"===this.employeeName.role?this.headerFlag=!1:this.headerFlag=!0,"header_manager"===this.employeeName.role||"brand_administration"===this.employeeName.role||"brand_commissioner"===this.employeeName.role||"brand_manager"===this.employeeName.role?this.isBatchBtnShow=!0:this.isBatchBtnShow=!1}},mounted:function(){var a=this;this.$nextTick((function(){a.doSearch(a.page),a.curRole=a.employeeName.role,a.getLabel(),a.getAppealList()}))},computed:(0,s.default)({},(0,r.mapState)({employeeName:function(a){return a.employeeName},uid:function(a){return a.uid},cityList:function(a){return a.cityList}})),methods:{getAppealList:function(){var a=this;this.axios.post("/backend-api/bk-api-tag-manage/get-appeal-status").then((function(e){0===e.data.code&&(a.appealStatusList=e.data.data)})).catch((function(a){console.log(a)}))},timeFocus:function(a){"labelDate"===a?this.labelDate=[]:"appealDate"===a&&(this.appealDate=[])},checkRole:function(a){return parseInt(a)},pageUpdate:function(a){this.page=a,this.doSearch(a)},resetSearch:function(){this.labelDate=[],this.orderId="",this.zxsModel="",this.zxsManaModel="",this.labelSeleId="",this.labelSeleName="",this.appealDate=[],this.cityId="",this.appealStatus="",this.doSearch(1)},doSearch:function(a){var e=this;"1"===this.searchType?this.tablePara={tab_datetime_start:this.labelDate?this.labelDate[0]:"",tab_datetime_end:this.labelDate&&Array.isArray(this.labelDate)&&this.labelDate.length>1?this.labelDate[1]:"",order_id:this.orderId,tag_id:this.labelSeleId,tag_config_id:this.labelSeleName,employee_id:this.zxsModel,employee_leader_id:this.zxsManaModel,employee_city_id:this.cityId,status:this.status,create_datetime_start:this.appealDate?this.appealDate[0]:"",create_datetime_end:this.appealDate&&Array.isArray(this.appealDate)&&this.appealDate.length>1?this.appealDate[1]:"",appeal_status:this.appealStatus,page:parseInt(a)}:this.tablePara={batch_type:this.batchForm.selectId,tag_config_id:this.batchForm.batchLabelName,batch_ids:this.batchForm.tagList.replace(/，/gi,",")},this.checkInit=!1,this.axios.post("/backend-api/bk-api-tag-manage/appeal-list",this.tablePara).then((function(a){if(0===a.data.code){if("1"===e.searchType)e.dataSum=parseInt(a.data.data.count),e.tableLabel=a.data.data.title,e.tableFilterFlag=!0;else{e.checkInit=!0;var t=a.data.data.title;t.splice(t.length-1,1),e.tableLabel=t,e.hasCheckBox=!0,e.tableFilterFlag=!1}e.tableList=a.data.data.list}})).catch((function(a){console.log(a)}))},resDetaildata:function(){this.doSearch(this.page)},getLabel:function(){var a=this;this.axios.post("/backend-api/bk-api-tag-manage/tags-down-list",this.tablePara).then((function(e){0===e.data.code&&(a.labelList=e.data.data)})).catch((function(a){console.log(a)}))},showBatchBox:function(){this.isBatch=!this.isBatch,this.isBatch||(this.searchType="1",this.isPage=!0,this.batchDis=!0,this.batchForm.selectId="",this.batchForm.batchLabelName="",this.batchForm.tagList="",this.hasCheckBox=!1,this.tableFilterFlag=!0,this.doSearch(1))},labelChange:function(a){"tag"===a?this.isTag=!0:(this.isTag=!1,this.batchForm.batchLabelName="")},batchResult:function(){var a=this;this.searchType="2",this.page=1,this.$refs.batchForm.validate((function(e){if(!e)return!1;a.isPage=!1,a.batchDis=!1,a.doSearch(1)}))},operateBtn:function(a){switch(a.operateId.toString()){case"view":var e=this.$router.resolve({path:"/sopDetail",query:{appeal_id:a.appealId}});window.open(e.href,"_blank");break;case"pass":this.passAlone(a.appealId);break;case"fail":this.failBtn(a.appealId)}},failBtn:function(a){var e=this;this.appeal_id=a;var t={appeal_id:a};this.axios.post("/backend-api/bk-api-tag-manage/reject-pop",t).then((function(a){0===a.data.code&&(e.failObj=a.data.data,e.$refs.Modalchild.openModal())})).catch((function(a){console.log(a)}))},passAlone:function(a){var e=this;if(this.repeatSub){var t={appeal_id:a,auditor:this.uid};this.repeatSub=!1,this.axios.post("/backend-api/bk-api-tag-manage/exam-passed",t).then((function(a){0===a.data.code&&(e.doSearch(e.page),e.repeatSub=!0)})).catch((function(a){e.repeatSub=!0,console.log(a)}))}},tableFilter:function(a){this.status=a.join(","),this.doSearch(this.page)},passBtn:function(){var a=this;if(this.appealId.length>0){if(this.batchSub){this.batchSub=!1;var e={appeal_id:this.appealId.length>0?this.appealId.join(","):"",auditor:this.uid};this.axios.post("/backend-api/bk-api-tag-manage/exam-passed",e).then((function(e){0===e.data.code&&(a.passDialog=!1,a.doSearch(1),alert("操作成功"),a.batchSub=!0)})).catch((function(e){a.batchSub=!0,console.log(e)}))}}else this.passDialog=!1},checkedList:function(a){var e=this;this.appealId=[],"1"!==this.searchType&&(this.batchPassNum.waitNum=0,this.batchPassNum.allNum=a.length,a.forEach((function(a){"header_manager"===e.employeeName.role?"1"===a.operation&&(e.batchPassNum.waitNum++,-1===e.appealId.indexOf(a.id)&&e.appealId.push(a.id)):"brand_administration"!==e.employeeName.role&&"brand_commissioner"!==e.employeeName.role&&"brand_manager"!==e.employeeName.role||"3"===a.operation&&(e.batchPassNum.waitNum++,-1===e.appealId.indexOf(a.id)&&e.appealId.push(a.id))})))},batchPass:function(){var a;a="header_manager"===this.employeeName.role?"审核":"审批",this.batchPassNum.waitNum===this.batchPassNum.allNum?this.tipText="您是想一键通过这"+this.batchPassNum.allNum+"个标签ID（或申诉ID）的申诉吗？系统会记录您的"+a+"日志，请谨慎操作。":this.batchPassNum.waitNum<this.batchPassNum.allNum&&0===this.batchPassNum.waitNum?this.tipText="您一共输入"+this.batchPassNum.allNum+"个标签ID（或申诉ID）；系统未检测到其中需要"+a+"的订单（标签），无法执行审核通过。":this.batchPassNum.waitNum<this.batchPassNum.allNum&&this.batchPassNum.waitNum>0&&(this.tipText="您一共输入"+this.batchPassNum.allNum+"个标签ID（或申诉ID）；系统检测到"+(this.batchPassNum.allNum-this.batchPassNum.waitNum)+"个申诉状态不是‘"+a+"中’，无法执行"+a+"通过；您需要对其他订单（标签）进行"+a+"通过吗？系统会记录您的"+a+"日志，请谨慎操作。"),this.passDialog=!0}},watch:{employeeName:{deep:!0,handler:function(a){var e=this;if(this.curRole=this.employeeName.role,"admin"===this.employeeName.role||"admin-sop"===this.employeeName.role||"brand_administration"===this.employeeName.role||"brand_commissioner"===this.employeeName.role||"brand_manager"===this.employeeName.role||"service_product"===this.employeeName.role){this.cityFlag=!0;this.axios.get("/backend-api/select2/select2/get-city-list-select2",{params:{city_type:"1"}}).then((function(a){0===a.data.code&&(e.cityListAppeal=a.data.data)})).catch((function(a){console.log(a)}))}else this.cityFlag=!1;"header_manager"===this.employeeName.role?this.headerFlag=!1:this.headerFlag=!0,"header_manager"===this.employeeName.role||"brand_administration"===this.employeeName.role||"brand_commissioner"===this.employeeName.role||"brand_manager"===this.employeeName.role?this.isBatchBtnShow=!0:this.isBatchBtnShow=!1}}}};e.default=c},f16a:function(a,e,t){"use strict";t.d(e,"a",(function(){return i})),t.d(e,"b",(function(){return s}));var i=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"el-row"},[t("el-col",{staticClass:"content-main",attrs:{span:24}},[t("el-breadcrumb",{staticClass:"bread-crumb-box",attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",[t("a",{attrs:{href:"/"}},[a._v("首页")])]),t("el-breadcrumb-item",[a._v("申诉管理列表页")])],1),t("div",{staticClass:"v-box form-table-box"},[t("div",{staticClass:"hd"},[t("h2",[a._v("搜索条件")]),a.isBatchBtnShow?t("el-button",{staticClass:"filter-link-more",attrs:{type:"info"},on:{click:a.showBatchBox}},[a._v("批量通过")]):a._e()],1),t("div",{staticClass:"bd"},[t("div",{staticClass:"order-search"},[a.isBatch?t("div",{staticClass:"batch-form-box"},[t("el-form",{ref:"batchForm",staticClass:"demo-ruleForm",attrs:{model:a.batchForm,rules:a.batchFormRules}},[t("ul",{staticClass:"s-query"},[t("li",{staticClass:"auto-column"},[t("div",{staticClass:"th required"},[a._v("请选择（申诉ID或标签ID）：")]),t("div",{staticClass:"td"},[t("el-form-item",{attrs:{label:"",prop:"selectId",required:""}},[t("el-select",{attrs:{placeholder:"请选择"},on:{change:a.labelChange},model:{value:a.batchForm.selectId,callback:function(e){a.$set(a.batchForm,"selectId",e)},expression:"batchForm.selectId"}},[t("el-option",{attrs:{label:"申诉ID",value:"appeal"}}),t("el-option",{attrs:{label:"标签ID",value:"tag"}})],1)],1)],1)]),a.isTag?t("li",{staticClass:"auto-column margin-next"},[t("div",{staticClass:"td"},[t("el-form-item",{attrs:{label:"",prop:"batchLabelName",required:""}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:a.batchForm.batchLabelName,callback:function(e){a.$set(a.batchForm,"batchLabelName",e)},expression:"batchForm.batchLabelName"}},a._l(a.labelList,(function(a){return t("el-option",{key:a.tag_config_id,attrs:{label:a.tag_name,value:a.tag_config_id}})})),1)],1)],1)]):a._e(),t("li",{staticClass:"auto auto-column"},[t("div",{staticClass:"th required"},[a._v("请输入（申诉ID或标签ID）：")]),t("div",{staticClass:"td"},[t("el-form-item",{attrs:{label:"",prop:"tagList",required:""}},[t("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:4},placeholder:"请输入内容"},model:{value:a.batchForm.tagList,callback:function(e){a.$set(a.batchForm,"tagList",e)},expression:"batchForm.tagList"}}),t("div",{staticClass:"form-tip-box"},[a._v("支持输入多个，2个申诉ID（或者标签ID）之间，支持用逗号隔开。")])],1)],1)])])])],1):t("ul",{staticClass:"s-query"},[t("li",[t("div",{staticClass:"th"},[a._v("标记日期：")]),t("div",{staticClass:"td"},[t("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd","range-separator":"至","prefix-icon":"date-tip-logo","picker-options":a.pickerOptions,"start-placeholder":"请输入时间","end-placeholder":"请输入时间"},on:{focus:function(e){return a.timeFocus("labelDate")}},model:{value:a.labelDate,callback:function(e){a.labelDate=e},expression:"labelDate"}})],1)]),t("li",[t("div",{staticClass:"th"},[a._v("订单ID：")]),t("div",{staticClass:"td"},[t("el-input",{attrs:{placeholder:"请输入订单ID"},model:{value:a.orderId,callback:function(e){a.orderId=e},expression:"orderId"}})],1)]),t("li",[t("div",{staticClass:"th"},[a._v("咨询师：")]),t("div",{staticClass:"td"},[t("select-to",{attrs:{role:a.checkRole(1),uid:a.uid,curRole:a.curRole},model:{value:a.zxsModel,callback:function(e){a.zxsModel=e},expression:"zxsModel"}})],1)]),a.headerFlag?t("li",[t("div",{staticClass:"th"},[a._v("咨询师主管：")]),t("div",{staticClass:"td"},[t("select-to",{attrs:{role:a.checkRole(2),uid:a.uid,curRole:a.curRole},model:{value:a.zxsManaModel,callback:function(e){a.zxsManaModel=e},expression:"zxsManaModel"}})],1)]):a._e(),t("li",[t("div",{staticClass:"th"},[a._v("标签ID：")]),t("div",{staticClass:"td"},[t("el-input",{attrs:{placeholder:"请输入标签ID"},model:{value:a.labelSeleId,callback:function(e){a.labelSeleId=e},expression:"labelSeleId"}})],1)]),t("li",[t("div",{staticClass:"th"},[a._v("标签名称：")]),t("div",{staticClass:"td"},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:a.labelSeleName,callback:function(e){a.labelSeleName=e},expression:"labelSeleName"}},a._l(a.labelList,(function(a){return t("el-option",{key:a.tag_config_id,attrs:{label:a.tag_name,value:a.tag_config_id}})})),1)],1)]),t("li",[t("div",{staticClass:"th"},[a._v("申诉日期：")]),t("div",{staticClass:"td"},[t("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd","range-separator":"至","prefix-icon":"date-tip-logo","picker-options":a.pickerOptions,"start-placeholder":"请输入时间","end-placeholder":"请输入时间"},on:{focus:function(e){return a.timeFocus("appealDate")}},model:{value:a.appealDate,callback:function(e){a.appealDate=e},expression:"appealDate"}})],1)]),a.cityFlag?t("li",[t("div",{staticClass:"th"},[a._v("城市：")]),t("div",{staticClass:"td"},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:a.cityId,callback:function(e){a.cityId=e},expression:"cityId"}},a._l(a.cityListAppeal,(function(a){return t("el-option",{key:a.id,attrs:{label:a.text,value:a.id}})})),1)],1)]):a._e(),t("li",[t("div",{staticClass:"th"},[a._v("申诉状态：")]),t("div",{staticClass:"td"},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:a.appealStatus,callback:function(e){a.appealStatus=e},expression:"appealStatus"}},a._l(a.appealStatusList,(function(a){return t("el-option",{key:a.id,attrs:{label:a.text,value:a.id}})})),1)],1)])])]),a.isBatch?t("div",{staticClass:"btn-area batch-btn-area"},[t("el-button",{attrs:{type:"primary"},on:{click:a.batchResult}},[a._v("查看结果")]),t("el-button",{attrs:{type:"primary",disabled:a.batchDis},on:{click:a.batchPass}},[a._v("批量通过")])],1):t("div",{staticClass:"btn-area"},[t("el-button",{on:{click:a.resetSearch}},[a._v("重置")]),t("el-button",{attrs:{type:"primary"},on:{click:function(e){return a.doSearch(1)}}},[a._v("搜索")])],1)])]),t("div",{staticClass:"v-box form-table-box"},[t("div",{staticClass:"bd"},[t("div",{staticClass:"search-result"},[t("table-box-appeal-fixed",{attrs:{tableData:a.tableList,paging:a.isPage,limit:a.pageLimit,totalCount:a.dataSum,tableLabel:a.tableLabel,fixedCol:a.fixedCol,hasCheckBox:a.hasCheckBox,tableFilter:a.tableFilterFlag,role:a.employeeName,uid:a.uid,checkInit:a.checkInit},on:{pageUpdate:a.pageUpdate,tableFilterList:a.tableFilter,operateBtn:a.operateBtn,checkedList:a.checkedList}})],1)])])],1),t("el-dialog",{attrs:{title:"提示",visible:a.passDialog,width:"30%"},on:{"update:visible":function(e){a.passDialog=e}}},[t("div",[a._v(a._s(a.tipText))]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(e){a.passDialog=!1}}},[a._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:a.passBtn}},[a._v("确 定")])],1)]),t("Modal",{ref:"Modalchild",attrs:{tagid:a.failObj.tag_id,orderid:a.failObj.order_id,appealreason:a.failObj.appeal_reason,desc:a.failObj.desc,appealImage:a.failObj.appeal?a.failObj.appeal.appealImage:[],appeal_id:a.appeal_id},on:{resDetaildata:a.resDetaildata}})],1)},s=[]}}]);