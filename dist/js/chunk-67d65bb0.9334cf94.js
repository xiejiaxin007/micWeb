(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-67d65bb0"],{"2a96":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a("23f7"),o={creattTransferOrder:function(e){return r.axios.post("/backend-api/org/transfer-order/create",e)}};t.default=o},"2e8f":function(e,t,a){"use strict";a("76c7")},"334b":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a("23f7"),o={getDepartList:function(e){return r.axios.post("/backend-api/select2/select2/get-org-list",e)},getOrderCitys:function(e){return r.axios.post("/backend-api/select2/select2/get-all-city",e)},getOrgDepartList:function(e){return r.axios.get("/backend-api/select2/select2/get-org-depart-list",{params:e})},getJobs:function(e){return r.axios.get("/backend-api/select2/select2/get-org-post-list",{params:e})},getAllCityData:function(e){return r.axios.post("/backend-api/select2/select2/get-all-city-code",e)},getCompanyCommonData:function(e){return r.axios.post("/backend-api/org/org/common-select",e)}};t.default=o},"39a9":function(e,t,a){"use strict";a.r(t);var r=a("eba6"),o=a("3f04");for(var n in o)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return o[e]}))}(n);a("2e8f");var s=a("2877"),c=Object(s.a)(o.default,r.a,r.b,!1,null,"79d86ffa",null);t.default=c.exports},"3f04":function(e,t,a){"use strict";a.r(t);var r=a("f799"),o=a.n(r);for(var n in r)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(n);t.default=o.a},"76c7":function(e,t,a){var r=a("ea80");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,a("499e").default)("1ac796a2",r,!0,{sourceMap:!1,shadowMode:!1})},ea80:function(e,t,a){(t=a("24fb")(!1)).push([e.i,".order-transfer[data-v-79d86ffa]{padding:20px 30px;background-color:#fff}.sale-form[data-v-79d86ffa]{margin-top:20px;padding:40px 10px 10px;background-color:#fff}",""]),e.exports=t},eba6:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return o}));var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"order-transfer"},[a("el-breadcrumb",{staticClass:"bread-crumb",attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[a("a",{attrs:{href:"/"}},[e._v("首页")])]),a("el-breadcrumb-item",[e._v("加盟商管理")]),a("el-breadcrumb-item",[e._v("跨公司转移订单")])],1),a("el-form",{ref:"saleForm",staticClass:"sale-form",attrs:{model:e.saleForm,rules:e.rules,"label-position":"right","label-width":"180px"}},[a("el-form-item",{attrs:{label:"选择公司：",prop:"companyId"}},[a("el-select",{attrs:{filterable:"",clearable:"",remote:"","remote-method":function(t){return e.getCompanyList(t,"from")},placeholder:"请选择"},on:{change:function(t){return e.changeCompany(t,"from")}},model:{value:e.saleForm.companyId,callback:function(t){e.$set(e.saleForm,"companyId",t)},expression:"saleForm.companyId"}},e._l(e.companyList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"选择咨询师：",prop:"consultorId"}},[a("el-select",{attrs:{filterable:"",clearable:"",remote:"","remote-method":function(t){return e.getConsultorInfo(t,"from")},placeholder:"请选择"},model:{value:e.saleForm.consultorId,callback:function(t){e.$set(e.saleForm,"consultorId",t)},expression:"saleForm.consultorId"}},e._l(e.consultList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"选择订单状态：",prop:"orderStatus"}},[a("el-checkbox-group",{model:{value:e.saleForm.orderStatus,callback:function(t){e.$set(e.saleForm,"orderStatus",t)},expression:"saleForm.orderStatus"}},e._l(e.statusList,(function(t){return a("el-checkbox",{key:t.value,attrs:{label:t.value}},[e._v(" "+e._s(t.name)+" ")])})),1)],1),a("el-form-item",{attrs:{label:"接受订单的公司：",prop:"acceptCompanyId"}},[a("el-select",{attrs:{filterable:"",clearable:"",remote:"","remote-method":function(t){return e.getCompanyList(t,"to")},placeholder:"请选择"},on:{change:function(t){return e.changeCompany(t,"to")}},model:{value:e.saleForm.acceptCompanyId,callback:function(t){e.$set(e.saleForm,"acceptCompanyId",t)},expression:"saleForm.acceptCompanyId"}},e._l(e.toCompanyList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"选择接受订单的咨询师：",prop:"acceptConsultorId"}},[a("el-select",{attrs:{filterable:"",clearable:"",remote:"","remote-method":function(t){return e.getConsultorInfo(t,"to")},placeholder:"请选择"},model:{value:e.saleForm.acceptConsultorId,callback:function(t){e.$set(e.saleForm,"acceptConsultorId",t)},expression:"saleForm.acceptConsultorId"}},e._l(e.toConsultList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1),a("el-form-item",{staticClass:"btn-box"},[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("确定转移以上订单")])],1)],1)],1)},o=[]},f799:function(e,t,a){"use strict";var r=a("4ea4");a("99af"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("96cf");var o=r(a("1da1")),n=r(a("2a96")),s=r(a("f946")),c=r(a("334b")),l={name:"TransferOrder",data:function(){return{loading:!1,saleForm:{companyId:"",consultorId:"",orderStatus:[],acceptCompanyId:"",acceptConsultorId:""},rules:{companyId:[{required:!0,message:"公司没有填写",trigger:"change"}],consultorId:[{required:!0,message:"咨询师没有填写",trigger:"change"}],orderStatus:[{type:"array",required:!0,message:"订单状态没有填写",trigger:"change"}],acceptCompanyId:[{required:!0,message:"接受订单的公司没有填写",trigger:"change"}],acceptConsultorId:[{required:!0,message:"接受订单的咨询师没有填写",trigger:"change"}]},consultList:[],toConsultList:[],companyList:[],toCompanyList:[],statusList:[],step:1}},mounted:function(){this.getStatusList(),this.getCompanyList()},methods:{changeCompany:function(e,t){"from"===t?(this.saleForm.consultorId="",this.consultList=[]):"to"===t&&(this.saleForm.acceptConsultorId="",this.toConsultList=[]),""!==e&&this.getConsultorList(t,e)},onSubmit:function(){var e=this;return(0,o.default)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$refs.saleForm.validate();case 3:if(t.sent){t.next=6;break}return t.abrupt("return");case 6:if(e.saleForm.companyId!==e.saleForm.acceptCompanyId){t.next=9;break}return e.$message.warning("不能选择相同的公司"),t.abrupt("return");case 9:e.saveData(),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.warn(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))()},saveData:function(){var e=this;return(0,o.default)(regeneratorRuntime.mark((function t(){var a,r,o,s,c,l,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e.loading){t.next=3;break}return t.abrupt("return");case 3:return e.loading=!0,a=e.saleForm,r={from_org:a.companyId,from_employee_id:a.consultorId,to_org:a.acceptCompanyId,to_employee_id:a.acceptConsultorId,order_status:a.orderStatus,step:e.step},t.next=8,n.default.creattTransferOrder(r);case 8:o=t.sent,s=o.data,c=s.code,l=s.data,i=s.msg,e.loading=!1,5002===c?e.showMessageBox(1,l.list):4===c?e.showMessageBox(2,l.list):e.$message.error(i),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(0),e.loading=!1,console.warn(t.t0);case 21:case"end":return t.stop()}}),t,null,[[0,17]])})))()},showMessageBox:function(e,t){var a=this;if(e&&t){var r=t.order_num,o=t.from_org_name,n=t.to_org_name,s=t.from_employee_name,c=t.to_employee_name,l=['<div>\n                    <div class="title">共计'.concat(r,'个订单,转移信息如下：</div>\n                    <div style="margin-left:20px">\n                        <div>公司：【').concat(o,"】转移到【").concat(n,"】</div>\n                        <div>咨询师：【").concat(s,"】转移到【").concat(c,"】</div>\n                    </div>\n                </div>"),"<div>\n                    <div>共计".concat(r,"个订单，已经转移成功，从咨询师").concat(s,"转移给了咨询师").concat(c,"</div>\n                </div>")];this.$confirm(l[e-1],["确认订单转移信息","转移成功"][e-1],{confirmButtonText:"确认",cancelButtonText:"取消",showCancelButton:1===e,dangerouslyUseHTMLString:!0}).then((function(){if(e>1)return a.step=1,void window.location.reload();a.step++,a.saveData()})).catch((function(){a.step=1,console.log("已取消操作")}))}},getStatusList:function(){var e=this;return(0,o.default)(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,t.next=4,c.default.getCompanyCommonData({type:"transfer_order_status"});case 4:a=t.sent,r=a.data.data,e.loading=!1,e.statusList=r.transfer_order_status||[],t.next=14;break;case 10:t.prev=10,t.t0=t.catch(0),e.loading=!1,console.warn(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))()},getCompanyList:function(e,t){var a=this;return(0,o.default)(regeneratorRuntime.mark((function r(){var o,n,s,l;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,c.default.getDepartList({is_without_julive:!1,q:e});case 3:o=r.sent,n=o.data,s=n.code,l=n.data,0===s&&("from"===t?a.companyList=l:("to"===t||(a.companyList=l),a.toCompanyList=l)),r.next=13;break;case 10:r.prev=10,r.t0=r.catch(0),console.warn(r.t0);case 13:case"end":return r.stop()}}),r,null,[[0,10]])})))()},getConsultorInfo:function(e,t){var a="";"from"===t?a=this.saleForm.companyId:"to"===t&&(a=this.saleForm.acceptCompanyId),this.getConsultorList(t,a,e)},getConsultorList:function(e,t){var a=arguments,r=this;return(0,o.default)(regeneratorRuntime.mark((function o(){var n,c,l;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return n=a.length>2&&void 0!==a[2]?a[2]:"",o.prev=1,o.next=4,s.default.getStaffList({org_id:t,role:"header",status:1,q:n});case 4:c=o.sent,l=c.data.data,"from"===e?r.consultList=l.list:"to"===e&&(r.toConsultList=l.list),o.next=12;break;case 9:o.prev=9,o.t0=o.catch(1),console.warn(o.t0);case 12:case"end":return o.stop()}}),o,null,[[1,9]])})))()}}};t.default=l}}]);