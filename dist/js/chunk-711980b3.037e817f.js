(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-711980b3"],{"15fd":function(e,t,a){"use strict";a("a4d3"),a("c975"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(null==e)return{};var a,r,n=(0,i.default)(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)a=l[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n};var r,i=(r=a("ccb5"))&&r.__esModule?r:{default:r}},1935:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a("23f7"),i={getApprvalDetail:function(e){return r.axios.get("/backend-api/expand/ex-contract/direct-sign-apprval-detail",{params:e})},approvalDirectSign:function(e){return r.axios.post("/backend-api/expand/ex-contract/direct-sign-approval",e)},revokeApproval:function(e){return r.axios.post("/backend-api/expand/ex-contract/revoke",e)},addFirstLevelApprover:function(e){return r.axios.post("/backend-api/expand/ex-contract/add-approver",e)}};t.default=i},"24c9":function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i}));var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"file-list-view"},[a("div",{staticClass:"file-show-box"},[e.docFileArr.length>0?a("ul",{staticClass:"file-list"},e._l(e.docFileArr,(function(t,r){return a("li",{key:r},[a("a",{staticClass:"preview-file",attrs:{href:e.OSSView+t.file_url,target:"_blank",rel:"noopener noreferrer"}},[a("span",[e._v(e._s(t.file_name))])]),e.canEdit?a("el-button",{staticClass:"color-error",attrs:{type:"text"},on:{click:function(t){return e.delFile("file",r)}}},[e._v("删除")]):e._e()],1)})),0):e._e(),e.imgFileArr.length>0?a("ul",{staticClass:"img-list clearfix"},e._l(e.imgFileArr,(function(t,r){return a("li",{key:r},[a("div",{staticClass:"img-item-box"},[a("img",{attrs:{src:t.file_url,alt:"图片凭证"},on:{click:function(t){return e.showPreview(r)}}})]),e.canEdit?a("i",{staticClass:"ico-close el-icon-error",attrs:{"aria-hidden":"true"},on:{click:function(t){return e.delFile("img",r)}}}):e._e()])})),0):e._e()]),e.photoIsShow?a("jl-image-preview",{attrs:{showViewer:e.photoIsShow,urlList:e.previewUrl,currentIndex:e.curIndex},on:{closeViewer:e.closeViewer}}):e._e()],1)},i=[]},2847:function(e,t,a){"use strict";a.r(t);var r=a("24c9"),i=a("52c7");for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);a("b17c");var l=a("2877"),s=Object(l.a)(i.default,r.a,r.b,!1,null,"5120f874",null);t.default=s.exports},"2a01":function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i}));var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"turn-sign-detail"},[a("el-breadcrumb",{staticClass:"bread-nav",attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[a("a",{attrs:{href:"/"}},[e._v("首页")])]),a("el-breadcrumb-item",{attrs:{to:"/channelPerfor/contractList"}},[e._v(" 合同列表页 ")]),a("el-breadcrumb-item",[e._v(" 转直签审批详情页 ")])],1),a("div",{staticClass:"part apply-content"},[a("h3",{staticClass:"title"},[e._v("申请内容")]),a("div",{staticClass:"box-wrap"},[a("div",{staticClass:"content-list"},[a("ul",{staticClass:"base-info"},[a("li",{staticClass:"item"},[a("label",{staticClass:"label"},[e._v("合同ID：")]),a("a",{staticClass:"a-link",attrs:{href:e.detailInfo.contract_url}},[e._v(e._s(e.detailInfo.id))])]),a("li",{staticClass:"item"},[a("label",{staticClass:"label"},[e._v("申请人：")]),a("span",{staticClass:"content"},[e._v(e._s(e.detailInfo.apply_employee))])]),a("li",{staticClass:"item"},[a("label",{staticClass:"label"},[e._v("直签类型：")]),a("span",{staticClass:"content"},[e._v(e._s(e.detailInfo.direct_sign_type))])]),a("li",{staticClass:"item"},[a("label",{staticClass:"label"},[e._v("楼盘ID：")]),a("span",{staticClass:"content"},[e._v(e._s(e.detailInfo.project_id))])]),a("li",{staticClass:"item"},[a("label",{staticClass:"label"},[e._v("楼盘名称：")]),a("span",{staticClass:"content"},[e._v(e._s(e.detailInfo.project_name))])])])]),a("div",{staticClass:"certify-file"},[a("div",{staticClass:"certify-notice"},[e._v("证明材料要求： "),a("div",{domProps:{innerHTML:e._s(e.detailInfo.direct_sign_type_tip_text)}})]),a("div",{staticClass:"certify-file-show"},[a("label",{staticClass:"label"},[e._v("证明材料：")]),a("file-preview",{attrs:{"file-list":e.fileList}})],1)]),a("div",{staticClass:"apply-reason"},[a("label",{staticClass:"label"},[e._v("申请理由：")]),a("pre",{staticClass:"reason-content"},[e._v(e._s(e.detailInfo.apply_reason))])])])]),a("div",{staticClass:"part examine-content"},[a("h3",{staticClass:"title"},[e._v("审批流")]),a("div",{staticClass:"box-wrap"},[a("ul",{staticClass:"examine-box"},e._l(e.approvalFlow,(function(t){return a("li",{key:t.status_value+t.level,staticClass:"examine-item"},[a("label",{staticClass:"ex-title"},[e._v("第"+e._s(t.level)+"级")]),a("div",{staticClass:"exmine-content"},[a("div",[a("span",{staticClass:"status",style:e.getStyle(t.status_value)},[e._v(e._s(t.status))]),e._v("， "),a("span",{staticClass:"info"},[e._v(e._s(t.approver)+" "+e._s(t.operate_datetime&&","+t.operate_datetime))]),a("div",{staticClass:"rmark"},[e._v(e._s(e.getApproveText(t.status_value,t.remarks))+" "+e._s(t.remarks))])])])])})),0),e.back.approval_status?a("div",{staticClass:"back-box"},[a("span",{staticClass:"info"},[e._v(e._s(e.back.approval_status)+","+e._s(e.back.operator)+" "+e._s(e.back.operating_time&&","+e.back.operating_time))]),a("div",{staticClass:"rmark"},[e._v("撤销原因： "+e._s(e.back.approval_note))])]):e._e()])]),a("div",{staticClass:"detail-footer"},[1===e.btnAuth.can_reject?a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.handleApprove(!0,"驳回原因","1")}}},[e._v("驳回")]):e._e(),1===e.btnAuth.can_pass?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleApprove(!1,"备注","2")}}},[e._v("通过")]):e._e(),1===e.btnAuth.can_revoke?a("el-button",{attrs:{type:"warning",size:"small"},on:{click:function(t){return e.handleApprove(!0,"撤销原因","3")}}},[e._v("撤销")]):e._e(),1===e.btnAuth.can_add_approver?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("增加一级审批人")]):e._e()],1),a("RejectDialog",{attrs:{label:e.approveDialog.text,title:e.approveDialog.text,maxLength:200,visible:e.approveDialog.rejectShow,"is-required":e.approveDialog.required},on:{confirm:e.rejectConfrim,close:e.rejectClose}}),a("change-employee-dialog",{attrs:{visible:e.dialogVisible,title:"增加一级审批人",label:"新的审批人",apiInfo:e.oFollower},on:{"update:visible":function(t){e.dialogVisible=t},confirm:e.handleChangeApprover}})],1)},i=[]},"2ca0":function(e,t,a){"use strict";var r,i=a("23e7"),n=a("06cf").f,l=a("50c4"),s=a("5a34"),o=a("1d80"),c=a("ab13"),f=a("c430"),p="".startsWith,u=Math.min,d=c("startsWith");i({target:"String",proto:!0,forced:!!(f||d||(r=n(String.prototype,"startsWith"),!r||r.writable))&&!d},{startsWith:function(e){var t=String(o(this));s(e);var a=l(u(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return p?p.call(t,r,a):t.slice(a,a+r.length)===r}})},"52c7":function(e,t,a){"use strict";a.r(t);var r=a("b6c0"),i=a.n(r);for(var n in r)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(n);t.default=i.a},"5a34":function(e,t,a){var r=a("44e7");e.exports=function(e){if(r(e))throw TypeError("The method doesn't accept regular expressions");return e}},"5b6e":function(e,t,a){"use strict";a.r(t);var r=a("e711"),i=a.n(r);for(var n in r)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(n);t.default=i.a},"646f":function(e,t,a){"use strict";a.r(t);var r=a("731d"),i=a.n(r);for(var n in r)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(n);t.default=i.a},"6d6d":function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i}));var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.title,visible:e.dialogVisble,"close-on-click-modal":!1,width:"600px",center:""},on:{"update:visible":function(t){e.dialogVisble=t},close:e.cancel}},[a("el-form",{ref:"auditForm",attrs:{model:e.forms,"label-width":"100px"}},[a("el-form-item",{attrs:{prop:"user",label:e.label,rules:[{required:!0,message:"请选择"+e.label,trigger:"change"}]}},[a("search-select-radio",e._b({attrs:{clearable:"",placeholder:"请选择"},model:{value:e.forms.user,callback:function(t){e.$set(e.forms,"user",t)},expression:"forms.user"}},"search-select-radio",e.$attrs,!1))],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancel}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确定")])],1)],1)},i=[]},"731d":function(e,t,a){"use strict";var r=a("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(a("5530")),n={name:"ChangeEmployeeDialog",components:{SearchSelectRadio:a("2af9").SearchSelectRadio},inheritAttrs:!1,props:{title:{type:String,default:"提示"},visible:{type:Boolean,default:!1},label:{type:String,default:"请选择"}},data:function(){return{dialogVisble:this.visible,forms:{user:""}}},watch:{visible:function(e){this.dialogVisble=e}},methods:{cancel:function(){this.$refs.auditForm.resetFields(),this.$emit("close"),this.$emit("update:visible",!1)},confirm:function(){var e=this;this.$refs.auditForm.validate((function(t){t&&e.$emit("confirm",(0,i.default)({},e.forms))}))}}};t.default=n},"9e33":function(e,t,a){"use strict";a("f9de")},a1dd:function(e,t,a){"use strict";a.r(t);var r=a("2a01"),i=a("5b6e");for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);a("9e33");var l=a("2877"),s=Object(l.a)(i.default,r.a,r.b,!1,null,"0f22578a",null);t.default=s.exports},ab13:function(e,t,a){var r=a("b622")("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(a){try{return t[r]=!1,"/./"[e](t)}catch(e){}}return!1}},b17c:function(e,t,a){"use strict";a("eab0")},b6c0:function(e,t,a){"use strict";a("c740"),a("4160"),a("d81d"),a("a434"),a("159b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={name:"FilePreview",props:{fileList:{type:Array,default:function(){return[]}},canEdit:{type:Boolean,default:!1}},data:function(){return{docFileArr:[],imgFileArr:[],photoIsShow:!1,previewUrl:[],curIndex:0}},watch:{fileList:function(e){this.handleFileList(e)}},methods:{handleFileList:function(e){var t=this;this.docFileArr=[],this.imgFileArr=[],e.forEach((function(e){"1"===e.file_type?t.imgFileArr.push(e):"2"===e.file_type&&t.docFileArr.push(e)}))},delFile:function(e,t){var a,r=this;"file"===e?(a=this.fileList.findIndex((function(e){return e.file_url===r.docFileArr[t].file_url})),this.docFileArr.splice(t,1)):"img"===e&&(a=this.fileList.findIndex((function(e){return e.file_url===r.imgFileArr[t].file_url})),this.imgFileArr.splice(t,1)),this.$emit("delFile",a)},showPreview:function(e){this.photoIsShow=!0,this.curIndex=e,this.previewUrl=this.imgFileArr.map((function(e){return e.file_url}))},closeViewer:function(){this.photoIsShow=!1,this.previewUrl=[]}}};t.default=r},cbd2:function(e,t,a){(t=a("24fb")(!1)).push([e.i,".turn-sign-detail[data-v-0f22578a]{padding:0 30px;background-color:#fff;font-size:14px}.bread-nav[data-v-0f22578a]{padding:20px 0 10px}.a-link[data-v-0f22578a]{color:#409eff}.part[data-v-0f22578a]{margin-top:15px}.part .title[data-v-0f22578a]{padding:10px 0;font-size:16px;font-weight:700}.part .box-wrap[data-v-0f22578a]{padding:0 20px}.apply-content .base-info[data-v-0f22578a]{display:-webkit-box;display:-ms-flexbox;display:flex}.apply-content .base-info .item[data-v-0f22578a]{-webkit-box-flex:1;-ms-flex:1;flex:1}.apply-content .base-info .label[data-v-0f22578a]{color:rgba(0,0,0,.85);line-height:1.5}.apply-content .base-info .content[data-v-0f22578a]{color:rgba(0,0,0,.65);line-height:1.5}.certify-file[data-v-0f22578a]{margin-top:15px}.certify-file .certify-notice[data-v-0f22578a]{color:#f56c6c}.certify-file .certify-file-show[data-v-0f22578a]{margin-top:15px}.apply-reason[data-v-0f22578a],.certify-file .certify-file-show[data-v-0f22578a]{display:-webkit-box;display:-ms-flexbox;display:flex}.apply-reason[data-v-0f22578a]{margin-top:25px}.apply-reason .reason-content[data-v-0f22578a]{-webkit-box-flex:1;-ms-flex:1;flex:1;white-space:pre-wrap;word-wrap:break-word;word-break:break-all}.examine-box .examine-item[data-v-0f22578a]{display:-webkit-box;display:-ms-flexbox;display:flex;padding:10px 0}.examine-box .ex-title[data-v-0f22578a]{margin-right:25px}.examine-box .exmine-content[data-v-0f22578a]{-webkit-box-flex:1;-ms-flex:1;flex:1}.rmark[data-v-0f22578a]{word-break:break-all;margin-top:10px}.back-box[data-v-0f22578a]{padding-left:60px;line-height:1.8}.detail-footer[data-v-0f22578a]{padding:20px 0;text-align:center}",""]),e.exports=t},ccb5:function(e,t,a){"use strict";a("c975"),a("b64b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(null==e)return{};var a,r,i={},n=Object.keys(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||(i[a]=e[a]);return i}},e711:function(e,t,a){"use strict";var r=a("4ea4");a("99af"),a("d81d"),a("2ca0"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(a("5530")),n=r(a("15fd"));a("96cf");var l=r(a("1da1")),s=r(a("1935")),o=r(a("f946")),c=r(a("0c32")),f=r(a("f4ef")),p=r(a("2847")),u={name:"TurnExamineDetail",components:{RejectDialog:c.default,ChangeEmployeeDialog:f.default,FilePreview:p.default},data:function(){return{detailInfo:{id:"",contract_url:"",direct_sign_type:"",project_id:"",project_name:"",direct_sign_type_tip_text:"",apply_reason:""},btnAuth:{can_reject:"",can_pass:"",can_add_approver:"",can_revoke:""},approvalFlow:[],fileList:[],dialogVisible:!1,approveDialog:{rejectShow:!1,required:!0,text:""},back:{approval_status:"",approval_note:"",operating_time:"",operator:""}}},created:function(){this.oFollower={api:o.default.getStaffList,params:{q:"",status:"1",role:"all"}},this.contractId=this.$route.query.id||""},mounted:function(){this.getDetailInfo()},methods:{getStyle:function(e){return{color:{1:"#303133",2:"#67C23A",3:"#f56c6c",4:"#e6a23c",5:"#909399"}[e]}},getApproveText:function(e,t){return{1:"",2:t&&"备注：",3:"驳回原因：",4:"撤销原因：",5:""}[e]},handleApprove:function(e,t,a){this.approveDialog.required=e,this.approveDialog.text=t,this.approveDialog.rejectShow=!0,this.curDialogStatus=a},getDetailInfo:function(){var e=this;return(0,l.default)(regeneratorRuntime.mark((function t(){var a,r,l,o,c,f,p,u,d,v,b,h,_,m,g,x,w,y;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a={id:e.contractId},t.next=4,s.default.getApprvalDetail(a);case 4:r=t.sent,l=r.data,o=l.code,c=l.data,f=l.msg,0===o?(p=c.file_list,u=c.approval_flow,d=c.approval_id,v=c.can_reject,b=c.can_pass,h=c.can_add_approver,_=c.can_revoke,m=c.approval_status,g=c.operating_time,x=c.operator,w=c.approval_note,y=(0,n.default)(c,["file_list","approval_flow","approval_id","can_reject","can_pass","can_add_approver","can_revoke","approval_status","operating_time","operator","approval_note"]),e.detailInfo=y,e.fileList=p.map((function(e){return(0,i.default)((0,i.default)({},e),{},{file_url:"".concat(e.file_domain).concat(e.file_url.startsWith("/")?e.file_url:"/"+e.file_url)})})),e.approvalFlow=u,e.btnAuth={can_reject:v,can_pass:b,can_add_approver:h,can_revoke:_},e.approvalId=d,e.back={approval_status:m,approval_note:w,operating_time:g,operator:x}):e.$message.error(f),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.log(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))()},rejectConfrim:function(e){this.approveDialog.rejectShow=!1;var t={approval_id:this.approvalId||"",remarks:e},a=this.curDialogStatus;"3"===a?this.approveRevoke(t):"1"!==a&&"2"!==a||(t.status="1"===a?2:1,this.updateApproveInfo(t))},rejectClose:function(){this.approveDialog.rejectShow=!1},updateApproveInfo:function(e){var t=this;return(0,l.default)(regeneratorRuntime.mark((function a(){var r,i,n,l;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,!t.hasReq){a.next=3;break}return a.abrupt("return");case 3:return t.hasReq=!0,a.next=6,s.default.approvalDirectSign(e);case 6:r=a.sent,i=r.data,n=i.code,l=i.msg,t.hasReq=!1,0===n?(t.$message.success("操作成功"),t.getDetailInfo()):t.$message.error(l),a.next=18;break;case 14:a.prev=14,a.t0=a.catch(0),t.hasReq=!1,console.log(a.t0);case 18:case"end":return a.stop()}}),a,null,[[0,14]])})))()},approveRevoke:function(e){var t=this;return(0,l.default)(regeneratorRuntime.mark((function a(){var r,i,n,l;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,!t.hasReq){a.next=3;break}return a.abrupt("return");case 3:return t.hasReq=!0,a.next=6,s.default.revokeApproval(e);case 6:r=a.sent,i=r.data,n=i.code,l=i.msg,t.hasReq=!1,0===n?(t.$message.success("操作成功"),t.getDetailInfo()):t.$message.error(l),a.next=18;break;case 14:a.prev=14,a.t0=a.catch(0),t.hasReq=!1,console.log(a.t0);case 18:case"end":return a.stop()}}),a,null,[[0,14]])})))()},handleChangeApprover:function(e){var t=this;return(0,l.default)(regeneratorRuntime.mark((function a(){var r,i,n,l,o;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,!t.hasReq){a.next=3;break}return a.abrupt("return");case 3:return t.hasReq=!0,r={employee_id:e.user,approval_id:t.approvalId},a.next=7,s.default.addFirstLevelApprover(r);case 7:i=a.sent,n=i.data,l=n.code,o=n.msg,t.hasReq=!1,0===l?(t.$message.success("操作成功"),t.getDetailInfo(),t.dialogVisible=!1):t.$message.error(o),a.next=19;break;case 15:a.prev=15,a.t0=a.catch(0),t.hasReq=!1,console.log(a.t0);case 19:case"end":return a.stop()}}),a,null,[[0,15]])})))()}}};t.default=u},eab0:function(e,t,a){var r=a("fde5");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,a("499e").default)("74983262",r,!0,{sourceMap:!1,shadowMode:!1})},f4ef:function(e,t,a){"use strict";a.r(t);var r=a("6d6d"),i=a("646f");for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);var l=a("2877"),s=Object(l.a)(i.default,r.a,r.b,!1,null,null,null);t.default=s.exports},f9de:function(e,t,a){var r=a("cbd2");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,a("499e").default)("10d02e9e",r,!0,{sourceMap:!1,shadowMode:!1})},fde5:function(e,t,a){(t=a("24fb")(!1)).push([e.i,".color-error[data-v-5120f874]{color:#f56c6c}.file-show-box .file-list .preview-file[data-v-5120f874]{color:#00f;text-decoration:underline;margin:0 10px}.file-show-box .img-list[data-v-5120f874]{margin-top:16px}.file-show-box .img-list li[data-v-5120f874]{position:relative;float:left;width:100px;height:100px;text-align:center;margin-right:12px}.file-show-box .img-list li .img-item-box[data-v-5120f874]{width:100%;height:100px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border:1px solid #eee}.file-show-box .img-list li .img-item-box img[data-v-5120f874]{max-width:100%;max-height:100%}.file-show-box .ico-close[data-v-5120f874]{position:absolute;display:block;font-size:18px;top:-9px;right:-10px;color:#f56c6c;cursor:pointer}",""]),e.exports=t}}]);