(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-6b0671b8"],{"315a":function(e,t,a){"use strict";a.r(t);var i=a("3a29"),r=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t.default=r.a},"356a":function(e,t,a){"use strict";a.r(t);var i=a("e2b6"),r=a("315a");for(var n in r)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(n);a("601a");var s=a("2877"),o=Object(s.a)(r.default,i.a,i.b,!1,null,"d427d5ac",null);t.default=o.exports},"3a29":function(e,t,a){"use strict";var i=a("4ea4");a("d81d"),a("b0c0"),a("a9e3"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("96cf");var r=i(a("1da1")),n=a("2af9"),s=i(a("7f2f")),o=i(a("8fa0")),d={components:{SearchSelectRadio:n.SearchSelectRadio},data:function(){return{id:this.$route.query.id,title:"addQualityInfo"===this.$route.name?"新增":"编辑",isEdit:"editQualityInfo"===this.$route.name,loading:!1,form:{cityId:"",pageId:"",fieldId:"",sourceRelation:[],accuracy:void 0,baseLine:void 0,fieldScale:void 0,fieldBaseLine:void 0},rules:{cityId:[{required:!0,message:"城市不能为空",trigger:"change"}],pageId:[{required:!0,message:"字段所属页面不能为空",trigger:"change"}],fieldId:[{required:!0,message:"字段名称不能为空",trigger:"change"}],sourceRelation:[{required:!0,message:"高质量信息源不能为空",trigger:"blur"}],accuracy:[{required:!0,message:"竞对准确率阀值不能为空",trigger:"change"}]},cityApi:{api:o.default.getBusinessCity,params:{q:""}},pageList:[],fieldList:[],attribute:"",sourceApi:{api:s.default.getQualityList,params:{q:""}},bigData:{},isSubmit:!1,chosenCity:{},chosenSource:[]}},computed:{params:function(){return{page_id:this.form.pageId,city_id:this.form.cityId}}},watch:{params:{handler:function(e,t){this.getFieldList()},deep:!0}},mounted:function(){this.getConfig(),this.getFieldList(),this.id&&this.initData()},methods:{getConfig:function(){var e=this;return(0,r.default)(regeneratorRuntime.mark((function t(){var a,i,r,n,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={type:[48]},t.prev=1,t.next=4,o.default.getProjectConfigData(a);case 4:i=t.sent,r=i.data,n=r.code,s=r.data,0===n&&(e.pageList=s.page_list?s.page_list:[]),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[1,11]])})))()},getFieldList:function(){var e=this;return(0,r.default)(regeneratorRuntime.mark((function t(){var a,i,r,n,o,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.isEdit||(e.form.fieldId="",e.attribute=""),e.form.pageId&&e.form.cityId){t.next=3;break}return t.abrupt("return");case 3:return a={page_id:e.form.pageId,city_id:e.form.cityId},e.isEdit&&(a.field_config_id=e.id),t.prev=5,t.next=8,s.default.getWordName(a);case 8:i=t.sent,r=i.data,n=r.code,o=r.msg,d=r.data,0===n?e.fieldList=d.list||[]:(e.fieldList=[],e.$message.error(o)),t.next=20;break;case 16:t.prev=16,t.t0=t.catch(5),console.log(t.t0),e.fieldList=[];case 20:case"end":return t.stop()}}),t,null,[[5,16]])})))()},changefield:function(e){this.attribute=e.attribute_type},initData:function(){var e=this;return(0,r.default)(regeneratorRuntime.mark((function t(){var a,i,r,n,o,d,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,t.next=4,s.default.initSourceConfig({field_config_id:e.id});case 4:a=t.sent,i=a.data,r=i.code,n=i.msg,o=i.data,0===r?(d=o.field_data,l=d.source_config_id.map((function(e){return e.value})),e.form={cityId:d.city_id,pageId:d.page_id,fieldId:d.field_id,sourceRelation:l,accuracy:d.accuracy_threshold,baseLine:Number(d.baseline_value)?Number(d.baseline_value):void 0,fieldScale:Number(d.field_scale)?Number(d.field_scale):void 0,fieldBaseLine:Number(d.field_baseline_value)?Number(d.field_baseline_value):void 0},e.attribute=d.attribute_type,e.chosenCity=d.city_arr,e.chosenSource=d.source_config_id,e.bigData=o.big_data,e.loading=!1):(e.loading=!1,e.$message.error(n)),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),e.loading=!1;case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))()},save:function(){var e=this;this.$refs.form.validate(function(){var t=(0,r.default)(regeneratorRuntime.mark((function t(a){var i,r,n,o,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=19;break}if(!e.isSubmit){t.next=3;break}return t.abrupt("return",!1);case 3:return e.isSubmit=!0,t.prev=4,i={city_id:e.form.cityId,page_id:e.form.pageId,field_id:e.form.fieldId,source_config_id:e.form.sourceRelation,accuracy_threshold:e.form.accuracy,baseline_value:e.form.baseLine,field_scale:e.form.fieldScale,field_baseline_value:e.form.fieldBaseLine},e.id&&(i.field_config_id=e.id),t.next=9,s.default.saveSourceConfig(i);case 9:r=t.sent,n=r.data,o=n.code,d=n.msg,0===o?(e.$message({message:"高质量源配置"+e.title+"成功",type:"success"}),e.$router.push({path:"/building/QualityList"}),e.isSubmit=!1):(e.$message.error(d),e.isSubmit=!1),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(4),e.isSubmit=!1;case 19:case"end":return t.stop()}}),t,null,[[4,16]])})));return function(e){return t.apply(this,arguments)}}())}}};t.default=d},"601a":function(e,t,a){"use strict";a("eb77")},"7f2f":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a("23f7"),r={getWordName:function(e){return i.axios.post("/backend-api/project/field-config/get-field-by-page-city",e)},getQualityList:function(e){return i.axios.get("/backend-api/common/get-source-list",{params:e})},getQualityTbList:function(e){return i.axios.get("/backend-api/project/field-config/get-source-field-config-list",{params:e})},initSourceConfig:function(e){return i.axios.get("/backend-api/project/field-config/edit-init",{params:e})},saveSourceConfig:function(e){return i.axios.post("/backend-api/project/field-config/edit",e)},updateStatus:function(e){return i.axios.post("/backend-api/project/field-config/update-status",e)},importSource:function(e){return i.axios.post("/backend-api/project/field-config/import-source-field-config",e)},exportAutoData:function(e){return i.axios.get("/backend-api/project/field-config/export-maintain-data",{params:e})}};t.default=r},"8e67":function(e,t,a){(t=a("24fb")(!1)).push([e.i,".edit-box[data-v-d427d5ac]{padding:0 30px}.form-box[data-v-d427d5ac]{background:#fff;padding:20px;margin-bottom:20px;border-radius:7px;-webkit-box-sizing:border-box;box-sizing:border-box}.form-box .input-width[data-v-d427d5ac]{width:350px}.main-title[data-v-d427d5ac]{font-size:16px;font-weight:700;border-bottom:1px solid #eee;padding-bottom:10px;margin-bottom:20px}.unit[data-v-d427d5ac]{width:40px;padding-left:10px;-webkit-box-sizing:border-box;box-sizing:border-box}.big-data[data-v-d427d5ac],.unit[data-v-d427d5ac]{display:inline-block}.big-data[data-v-d427d5ac]{padding-left:20px;color:red}.big-data.left-padding[data-v-d427d5ac]{padding-left:60px}.big-data .info[data-v-d427d5ac]{display:inline-block;min-width:500px}.big-data .info span[data-v-d427d5ac]{padding-right:30px}.big-data .time[data-v-d427d5ac]{display:inline}.router-link[data-v-d427d5ac]{display:inline-block;margin-right:30px}",""]),e.exports=t},e2b6:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"edit-box"},[a("el-breadcrumb",{staticClass:"bread-crumb-box",attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[a("a",{attrs:{href:"/"}},[e._v("首页")])]),a("el-breadcrumb-item",{attrs:{to:{path:"/building/QualityList"}}},[e._v("高质量信息源配置")]),a("el-breadcrumb-item",[e._v(e._s(e.title))])],1),a("div",{staticClass:"form-box"},[a("div",{staticClass:"main-title"},[e._v(e._s(e.title)+"高质量信息源配置")]),a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"200px"}},[a("el-form-item",{attrs:{label:"城市",prop:"cityId"}},[a("search-select-radio",{staticClass:"input-width",attrs:{isDisabled:e.isEdit,placeholder:"请选择",chosenObj:e.chosenCity,apiInfo:e.cityApi},model:{value:e.form.cityId,callback:function(t){e.$set(e.form,"cityId",t)},expression:"form.cityId"}})],1),a("el-form-item",{attrs:{label:"字段所属页面",prop:"pageId"}},[a("el-select",{staticClass:"input-width",attrs:{placeholder:"请选择",disabled:e.isEdit},model:{value:e.form.pageId,callback:function(t){e.$set(e.form,"pageId",t)},expression:"form.pageId"}},e._l(e.pageList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1),e.form.cityId&&e.form.pageId?a("el-form-item",{attrs:{label:"字段名称",prop:"fieldId"}},[a("el-select",{staticClass:"input-width",attrs:{placeholder:"请选择",filterable:"",disabled:e.isEdit},model:{value:e.form.fieldId,callback:function(t){e.$set(e.form,"fieldId",t)},expression:"form.fieldId"}},e._l(e.fieldList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.name,value:t.value},nativeOn:{click:function(a){return e.changefield(t)}}})})),1)],1):e._e(),e.form.pageId&&e.form.fieldId?a("el-form-item",{attrs:{label:"字段属性"}},[e._v(" "+e._s(e.attribute)+" ")]):e._e(),a("el-form-item",{attrs:{label:"高质量信息源",prop:"sourceRelation"}},[a("search-select-radio",{staticClass:"input-width no-shake-select",attrs:{placeholder:"请选择",multiple:"",chosenObj:e.chosenSource,apiInfo:e.sourceApi},model:{value:e.form.sourceRelation,callback:function(t){e.$set(e.form,"sourceRelation",t)},expression:"form.sourceRelation"}})],1),a("el-form-item",{attrs:{label:"竞对准确率阀值",prop:"accuracy"}},[a("el-input-number",{attrs:{min:1,max:100,precision:0},model:{value:e.form.accuracy,callback:function(t){e.$set(e.form,"accuracy",t)},expression:"form.accuracy"}}),a("span",{staticClass:"unit"},[e._v("%")]),e.isEdit&&e.bigData.accuracy_threshold?a("div",{staticClass:"big-data"},[a("div",{staticClass:"info"},e._l(e.bigData.accuracy_threshold.info,(function(t,i){return a("span",{key:i},[e._v(e._s(t))])})),0),a("div",{staticClass:"time"},[e._v(e._s(e.bigData.accuracy_threshold.big_datetime))])]):e._e()],1),a("el-form-item",{attrs:{label:"居理高质量源字段底线值",prop:"baseLine"}},[a("el-input-number",{attrs:{min:1,max:99999999,precision:0},model:{value:e.form.baseLine,callback:function(t){e.$set(e.form,"baseLine",t)},expression:"form.baseLine"}}),e.isEdit&&e.bigData.baseline_value?a("div",{staticClass:"big-data left-padding"},[a("div",{staticClass:"info"},e._l(e.bigData.baseline_value.info,(function(t,i){return a("span",{key:i},[e._v(e._s(t))])})),0),a("div",{staticClass:"time"},[e._v(e._s(e.bigData.baseline_value.big_datetime))])]):e._e()],1),a("el-form-item",{attrs:{label:"居理高质量源字段占比",prop:"fieldScale"}},[a("el-input-number",{attrs:{min:1,max:100,precision:0},model:{value:e.form.fieldScale,callback:function(t){e.$set(e.form,"fieldScale",t)},expression:"form.fieldScale"}}),a("span",{staticClass:"unit"},[e._v("%")]),e.isEdit&&e.bigData.field_scale?a("div",{staticClass:"big-data"},[a("div",{staticClass:"info"},e._l(e.bigData.field_scale.info,(function(t,i){return a("span",{key:i},[e._v(e._s(t))])})),0),a("div",{staticClass:"time"},[e._v(e._s(e.bigData.field_scale.big_datetime))])]):e._e()],1),a("el-form-item",{attrs:{label:"高质量源匹配竞对字段底线值",prop:"fieldBaseLine"}},[a("el-input-number",{attrs:{min:1,max:99999999,precision:0},model:{value:e.form.fieldBaseLine,callback:function(t){e.$set(e.form,"fieldBaseLine",t)},expression:"form.fieldBaseLine"}}),e.isEdit&&e.bigData.field_baseline_value?a("div",{staticClass:"big-data left-padding"},[a("div",{staticClass:"info"},e._l(e.bigData.field_baseline_value.info,(function(t,i){return a("span",{key:i},[e._v(e._s(t))])})),0),a("div",{staticClass:"time"},[e._v(e._s(e.bigData.field_baseline_value.big_datetime))])]):e._e()],1),a("el-form-item",[a("router-link",{staticClass:"router-link",attrs:{to:{path:"/building/QualityList"}}},[a("el-button",[e._v("取消")])],1),a("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")])],1)],1)],1)],1)},r=[]},eb77:function(e,t,a){var i=a("8e67");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,a("499e").default)("5f7ffe6b",i,!0,{sourceMap:!1,shadowMode:!1})}}]);