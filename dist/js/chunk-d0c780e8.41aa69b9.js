(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-d0c780e8"],{"480f":function(e,t,a){"use strict";a("d3b7"),a("25f0"),Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigSearch=void 0;var i=a("23f7"),o={getConfig:function(e,t){var a="";function o(){var e;e="29"===t.toString()||"30"===t.toString()||"31"===t.toString()||"1"===t.toString()||"27"===t.toString()||"28"===t.toString()?[{name:"标签日期",formEle:"time",id:"create_datetime",placeholder:"请输入时间",model:""},{name:"咨询师",formEle:"selectTo",id:"employee_id",placeholder:"",model:""},{name:"咨询师主管",formEle:"selectTo",id:"employee_leader_id",placeholder:"",model:""},{name:"标签ID",formEle:"input",id:"tag_id",placeholder:"请输入标签ID",model:""},{name:"标签状态",formEle:"select",id:"is_cancel",options:[{id:"0",text:"正常"},{id:"1",text:"取消"}],placeholder:"请选择",model:""},{name:"城市",formEle:"select",id:"city_id",options:[],placeholder:"请选择",model:""},{name:"取消类型",formEle:"select",id:"cancel_type",options:[],placeholder:"请选择",model:""}]:[{name:"分配时间",formEle:"time",id:"distribute_datetime",placeholder:"请输入时间",model:""},{name:"标签日期",formEle:"time",id:"create_datetime",placeholder:"请输入时间",model:""},{name:"订单ID",formEle:"input",id:"order_id",placeholder:"请输入订单ID",model:""},{name:"咨询师",formEle:"selectTo",id:"employee_id",placeholder:"",model:""},{name:"咨询师主管",formEle:"selectTo",id:"employee_leader_id",placeholder:"",model:""},{name:"标签ID",formEle:"input",id:"tag_id",placeholder:"请输入标签ID",model:""},{name:"标签状态",formEle:"select",id:"is_cancel",options:[{id:"0",text:"正常"},{id:"1",text:"取消"}],placeholder:"请选择",model:""},{name:"城市",formEle:"select",id:"city_id",options:[],placeholder:"请选择",model:""},{name:"取消类型",formEle:"select",id:"cancel_type",options:[],placeholder:"请选择",model:""}];return i.axios.get("/backend-api/select2/select2/get-city-list-select2",{params:{city_type:"1"}}).then((function(t){if(0===t.data.code)for(var a=0;a<e.length;a++)"city_id"===e[a].id&&(e[a].options=t.data.data)})).catch((function(e){console.log(e)})),i.axios.get("/backend-api/bk-api-tag-manage/get-cancel-type").then((function(t){if(0===t.data.code)for(var a=0;a<e.length;a++)"cancel_type"===e[a].id&&(e[a].options=t.data.data)})).catch((function(e){console.log(e)})),e}function l(e){var a,l="";switch(e){case"header_manager":a="29"===t.toString()||"30"===t.toString()||"31"===t.toString()||"1"===t.toString()||"27"===t.toString()||"28"===t.toString()?[{name:"标签日期",formEle:"time",id:"create_datetime",placeholder:"请输入时间",model:""},{name:"咨询师",formEle:"selectTo",id:"employee_id",placeholder:"",model:""},{name:"标签ID",formEle:"input",id:"tag_id",placeholder:"请输入标签ID",model:""},{name:"标签状态",formEle:"select",id:"is_cancel",options:[{id:"0",text:"正常"},{id:"1",text:"取消"}],placeholder:"请选择",model:""},{name:"取消类型",formEle:"select",id:"cancel_type",options:[],placeholder:"请选择",model:""}]:[{name:"分配时间",formEle:"time",id:"distribute_datetime",placeholder:"请输入时间",model:""},{name:"标签日期",formEle:"time",id:"create_datetime",placeholder:"请输入时间",model:""},{name:"订单ID",formEle:"input",id:"order_id",placeholder:"请输入订单ID",model:""},{name:"咨询师",formEle:"selectTo",id:"employee_id",placeholder:"",model:""},{name:"标签ID",formEle:"input",id:"tag_id",placeholder:"请输入标签ID",model:""},{name:"标签状态",formEle:"select",id:"is_cancel",options:[{id:"0",text:"正常"},{id:"1",text:"取消"}],placeholder:"请选择",model:""},{name:"取消类型",formEle:"select",id:"cancel_type",options:[],placeholder:"请选择",model:""}],i.axios.get("/backend-api/bk-api-tag-manage/get-cancel-type").then((function(e){if(0===e.data.code)for(var t=0;t<a.length;t++)"cancel_type"===a[t].id&&(a[t].options=e.data.data)})).catch((function(e){console.log(e)})),l=a;break;case"admin":l=function(){var e;return e="29"===t.toString()||"30"===t.toString()||"31"===t.toString()||"1"===t.toString()||"27"===t.toString()||"28"===t.toString()?[{name:"标签日期",formEle:"time",id:"create_datetime",placeholder:"请输入时间",model:""},{name:"咨询师",formEle:"selectTo",id:"employee_id",placeholder:"",model:""},{name:"咨询师主管",formEle:"selectTo",id:"employee_leader_id",placeholder:"",model:""},{name:"标签ID",formEle:"input",id:"tag_id",placeholder:"请输入标签ID",model:""},{name:"标签状态",formEle:"select",id:"is_cancel",options:[{id:"0",text:"正常"},{id:"1",text:"取消"}],placeholder:"请选择",model:""},{name:"取消类型",formEle:"select",id:"cancel_type",options:[],placeholder:"请选择",model:""}]:[{name:"分配时间",formEle:"time",id:"distribute_datetime",placeholder:"请输入时间",model:""},{name:"标签日期",formEle:"time",id:"create_datetime",placeholder:"请输入时间",model:""},{name:"订单ID",formEle:"input",id:"order_id",placeholder:"请输入订单ID",model:""},{name:"咨询师",formEle:"selectTo",id:"employee_id",placeholder:"",model:""},{name:"咨询师主管",formEle:"selectTo",id:"employee_leader_id",placeholder:"",model:""},{name:"标签ID",formEle:"input",id:"tag_id",placeholder:"请输入标签ID",model:""},{name:"标签状态",formEle:"select",id:"is_cancel",options:[{id:"0",text:"正常"},{id:"1",text:"取消"}],placeholder:"请选择",model:""},{name:"取消类型",formEle:"select",id:"cancel_type",options:[],placeholder:"请选择",model:""}],i.axios.get("/backend-api/bk-api-tag-manage/get-cancel-type").then((function(t){if(0===t.data.code)for(var a=0;a<e.length;a++)"cancel_type"===e[a].id&&(e[a].options=t.data.data)})).catch((function(e){console.log(e)})),e}();break;case"city_config":case"admin_sop":l=o();break;default:l=o()}return l}switch(t.toString()){case"7":case"13":case"35":case"6":case"12":case"25":case"16":case"15":case"36":case"34":case"26":case"5":case"4":case"10":case"24":case"9":case"18":case"17":case"20":case"19":case"29":case"30":case"31":case"1":case"21":case"27":case"28":case"3":a=l(e);break;default:a=[]}return a}};t.ConfigSearch=o},"4e25":function(e,t,a){"use strict";a.r(t);var i=a("54e3"),o=a.n(i);for(var l in i)["default"].indexOf(l)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(l);t.default=o.a},"54e3":function(e,t,a){"use strict";var i=a("4ea4");a("4160"),a("c975"),a("a15b"),a("a434"),a("d3b7"),a("ac1f"),a("25f0"),a("5319"),a("159b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(a("5530")),l=a("0475"),s=a("2af9"),c=a("480f"),r=a("2f62"),d={name:"label-list",data:function(){return{fixedCol:!0,input1:"",formList:[],zxsList:[],zxsLeadList:[],tableList:[],configPara:{},tablePara:{},tag_config_id:this.$route.query.tag_config_id,tag_name:this.$route.query.tag_name,pageLimit:20,dataSum:0,isPage:!0,tableLabel:[],tableData:[],isBatch:!1,searchType:"1",batchDis:!0,isOperate:!0,checkInit:!1,isCancelFlag:!1,labelList:[],hasCheckBox:!1,isTag:!1,cancelIds:[],repeatCacel:!0,batchCacel:!0,tipText:"您是想一键通过这00个标签（或订单）的申诉吗？系统会记录您的审核日志，请谨慎操作。",batchForm:{selectId:"",batchLabelName:"",tagList:""},passDialog:!1,batchFormRules:{},batchPassNum:{waitNum:0,allNum:0},status:[],page:1,curRole:"",pickerOptions:{}}},components:{SelectTo:s.SelectTo,TableBox:l.TableBox,TableBoxFixed:l.TableBoxFixed},created:function(){this.employeeName.role&&(this.curRole=this.employeeName.role,"admin"===this.employeeName.role&&"全国"===this.employeeName.jobs?this.formList=c.ConfigSearch.getConfig("city_config",this.$route.query.tag_config_id):this.formList=c.ConfigSearch.getConfig(this.employeeName.role,this.$route.query.tag_config_id),"admin-sop"===this.employeeName.role||"service_product"===this.employeeName.role?this.isCancelFlag=!0:this.isCancelFlag=!1)},mounted:function(){var e=this;this.$nextTick((function(){e.doSearch(e.page),e.curRole=e.employeeName.role,e.getLabel()}))},computed:(0,o.default)({},(0,r.mapState)({employeeName:function(e){return e.employeeName},uid:function(e){return e.uid}})),methods:{timeFocus:function(e){e.model=[]},checkRole:function(e){return"employee_id"===e?1:2},pageUpdate:function(e){this.page=e,this.doSearch(e)},labelChange:function(e){this.isTag="tag"===e},resetSearch:function(){for(var e=0;e<this.formList.length;e++)this.formList[e].model="";this.doSearch(1)},showBatchBox:function(){this.isBatch=!this.isBatch,this.isBatch||(this.searchType="1",this.isPage=!0,this.batchDis=!0,this.batchForm.selectId="",this.batchForm.batchLabelName="",this.batchForm.tagList="",this.hasCheckBox=!1,this.doSearch(1))},checkedList:function(e){var t=this;this.cancelIds=[],"1"!==this.searchType&&(this.batchPassNum.waitNum=0,this.batchPassNum.allNum=e.length,e.forEach((function(e){"0"===e.operation.toString()&&(t.batchPassNum.waitNum++,-1===t.cancelIds.indexOf(e.tag_id)&&t.cancelIds.push(e.tag_id))})))},passBtn:function(){var e=this;if(this.cancelIds.length>0){if(this.batchCacel){this.batchCacel=!1;var t={tag_id:this.cancelIds.length>0?this.cancelIds.join(","):"",tag_config_id:this.$route.query.tag_config_id};this.axios.post("/backend-api/bk-api-tag-manage/list-cancel-tag",t).then((function(t){0===t.data.code&&(e.passDialog=!1,e.doSearch(1),alert("操作成功"),e.batchCacel=!0)})).catch((function(t){e.batchCacel=!0,console.log(t)}))}}else this.passDialog=!1},batchResult:function(){var e=this;this.searchType="2",this.page=1,this.$refs.batchForm.validate((function(t){if(!t)return!1;e.isPage=!1,e.batchDis=!1,e.doSearch(1)}))},cancelLabel:function(e){var t=this;if(this.repeatCacel){this.repeatCacel=!1;var a={tag_config_id:this.$route.query.tag_config_id,tag_id:e};this.axios.post("/backend-api/bk-api-tag-manage/list-cancel-tag",a).then((function(e){0===e.data.code&&(t.doSearch(t.page),t.repeatCacel=!0)})).catch((function(e){t.repeatCacel=!0,console.log(e)}))}},batchPass:function(){this.batchPassNum.waitNum===this.batchPassNum.allNum?this.tipText="您选择"+this.batchPassNum.allNum+"个标签，其中"+this.batchPassNum.allNum+"个均为正常标记的标签。您确定是取消这"+this.batchPassNum.allNum+"个标签吗？PS：执行取消后，不可重新标记；请谨慎。":this.batchPassNum.waitNum<this.batchPassNum.allNum&&0===this.batchPassNum.waitNum?this.tipText="您选择"+this.batchPassNum.allNum+"个标签，其中"+this.batchPassNum.waitNum+"个为正常标签，"+(this.batchPassNum.allNum-this.batchPassNum.waitNum)+"个为取消标签。PS：执行取消后，不可重新标记；请谨慎。":this.batchPassNum.waitNum<this.batchPassNum.allNum&&this.batchPassNum.waitNum>0&&(this.tipText="您选择"+this.batchPassNum.allNum+"个标签，其中"+this.batchPassNum.waitNum+"个为正常标签，"+(this.batchPassNum.allNum-this.batchPassNum.waitNum)+"个为取消标签。您确定是取消这"+this.batchPassNum.waitNum+"个标签吗？PS：执行取消后，不可重新标记；请谨慎。"),this.passDialog=!0},getLabel:function(){var e=this;this.axios.post("/backend-api/bk-api-tag-manage/tags-down-list",this.tablePara).then((function(t){0===t.data.code&&(e.labelList=t.data.data)})).catch((function(e){console.log(e)}))},passAlone:function(e){var t=this,a={appeal_id:e,auditor:this.uid};this.axios.post("/backend-api/bk-api-tag-manage/exam-passed",a).then((function(e){0===e.data.code&&t.doSearch(t.page)})).catch((function(e){console.log(e)}))},tableFilter:function(e){this.status=e.join(","),this.doSearch(this.page)},doSearch:function(e){var t=this;if("1"===this.searchType){this.tablePara={order_id:"",tag_id:"",employee_id:"",employee_leader_id:"",is_cancel:"",city_id:"",create_datetime_min:"",create_datetime_max:"",distribute_datetime_min:"",distribute_datetime_max:"",tag_config_id:this.tag_config_id,cancel_type:"",page:parseInt(e)};for(var a=0;a<this.formList.length;a++)"time"===this.formList[a].formEle?(this.tablePara[this.formList[a].id+"_min"]=this.formList[a].model?this.formList[a].model[0]:"",this.tablePara[this.formList[a].id+"_max"]=this.formList[a].model?this.formList[a].model[1]:""):this.tablePara[this.formList[a].id]=this.formList[a].model}else this.tablePara={order_id:"",tag_id:this.batchForm.tagList.replace(/，/gi,","),employee_id:"",employee_leader_id:"",is_cancel:"",city_id:"",create_datetime_min:"",create_datetime_max:"",distribute_datetime_min:"",distribute_datetime_max:"",tag_config_id:this.tag_config_id,cancel_type:""};this.checkInit=!1,this.axios.get("/backend-api/bk-api-tag-manage/list",{params:this.tablePara}).then((function(e){if(0===e.data.code){if("1"===t.searchType)t.dataSum=parseInt(e.data.data.total),t.tableLabel=e.data.data.fields;else{t.checkInit=!0;var a=e.data.data.fields;a.splice(a.length-1,1),t.tableLabel=a,t.hasCheckBox=!0}t.tableList=e.data.data.list}})).catch((function(e){console.log(e)}))}},watch:{employeeName:{deep:!0,handler:function(e){this.curRole=this.employeeName.role,"admin"===this.employeeName.role&&"全国"===this.employeeName.jobs?this.formList=c.ConfigSearch.getConfig("admin_product",this.$route.query.tag_config_id):this.formList=c.ConfigSearch.getConfig(this.employeeName.role,this.$route.query.tag_config_id),"admin-sop"===this.employeeName.role||"service_product"===this.employeeName.role?this.isCancelFlag=!0:this.isCancelFlag=!1}}}};t.default=d},"7e5b":function(e,t,a){(t=a("24fb")(!1)).push([e.i,".content-main[data-v-3f9e4b98]{padding:0 15px}.form-table-box[data-v-3f9e4b98]{background-color:#fff}.form-table-box .filter-link-more[data-v-3f9e4b98]{float:right;padding:9px 20px;margin-top:6px}.order-search[data-v-3f9e4b98]{overflow:hidden}.order-search[data-v-3f9e4b98] .el-date-editor,.order-search[data-v-3f9e4b98] .el-select{width:100%;height:40px;-webkit-box-sizing:border-box;box-sizing:border-box}.order-search[data-v-3f9e4b98] .el-select>>>.el-input{height:40px}.order-search[data-v-3f9e4b98] .el-range-input{background-color:#fff;font-size:12px;line-height:32px}.order-search[data-v-3f9e4b98] .el-date-editor .el-range-separator{font-size:12px}.order-search .fixHeight[data-v-3f9e4b98]{height:40px}.order-search[data-v-3f9e4b98] .el-date-editor .date-tip-logo{display:none}.order-search>.s-query>li .td[data-v-3f9e4b98]{height:40px}.s-query>li.long-column[data-v-3f9e4b98]{width:360px}.s-query>li.margin-next[data-v-3f9e4b98]{margin-left:20px}.form-tip-box[data-v-3f9e4b98]{color:#999}.form-table-box .batch-btn-area[data-v-3f9e4b98]{text-align:right}.batch-form-box[data-v-3f9e4b98] .el-form-item{margin-bottom:0}",""]),e.exports=t},a605:function(e,t,a){var i=a("7e5b");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,a("499e").default)("e0bc1db0",i,!0,{sourceMap:!1,shadowMode:!1})},a6d3:function(e,t,a){"use strict";a("a605")},ec73:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return o}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"el-row"},[a("el-col",{staticClass:"content-main",attrs:{span:24}},[a("el-breadcrumb",{staticClass:"bread-crumb-box",attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[a("a",{attrs:{href:"/"}},[e._v("首页")])]),a("el-breadcrumb-item",{attrs:{to:{path:"/labelHome"}}},[e._v("标签管理首页")]),a("el-breadcrumb-item",[e._v("【"+e._s(e.tag_name)+"】标签管理列表页")])],1),a("div",{staticClass:"v-box form-table-box"},[a("div",{staticClass:"hd"},[a("h2",[e._v("【"+e._s(e.tag_name)+"】标签管理页面")]),e.isCancelFlag?a("el-button",{staticClass:"filter-link-more",attrs:{type:"info"},on:{click:e.showBatchBox}},[e._v("批量取消")]):e._e()],1),a("div",{staticClass:"bd"},[a("div",{staticClass:"order-search"},[e.isBatch?a("div",{staticClass:"batch-form-box"},[a("el-form",{ref:"batchForm",staticClass:"demo-ruleForm",attrs:{model:e.batchForm,rules:e.batchFormRules}},[a("ul",{staticClass:"s-query"},[a("li",{staticClass:"auto-column"},[a("div",{staticClass:"th required"},[e._v("请选择（标签ID）：")]),a("div",{staticClass:"td"},[a("el-form-item",{attrs:{label:"",prop:"selectId",required:""}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.labelChange},model:{value:e.batchForm.selectId,callback:function(t){e.$set(e.batchForm,"selectId",t)},expression:"batchForm.selectId"}},[a("el-option",{attrs:{label:"标签ID",value:"tag"}})],1)],1)],1)]),a("li",{staticClass:"auto auto-column"},[a("div",{staticClass:"th required"},[e._v("请输入（标签ID）：")]),a("div",{staticClass:"td"},[a("el-form-item",{attrs:{label:"",prop:"tagList",required:""}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:4},placeholder:"请输入内容"},model:{value:e.batchForm.tagList,callback:function(t){e.$set(e.batchForm,"tagList",t)},expression:"batchForm.tagList"}}),a("div",{staticClass:"form-tip-box"},[e._v("支持输入多个，2个签ID之间，支持用逗号隔开。")])],1)],1)])])])],1):a("ul",{staticClass:"s-query"},e._l(e.formList,(function(t,i){return a("li",{key:i},[a("div",{staticClass:"th"},[e._v(e._s(t.name)+"：")]),a("div",{class:{"td fixHeight":"time"===t.formEle.toString(),td:"time"!==t.formEle.toString()}},["input"===t.formEle.toString()?a("el-input",{attrs:{placeholder:t.placeholder},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"formItem.model"}}):"select"===t.formEle.toString()?a("el-select",{attrs:{placeholder:t.placeholder},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"formItem.model"}},e._l(t.options,(function(e){return a("el-option",{key:e.id,attrs:{label:e.text,value:e.id}})})),1):"time"===t.formEle.toString()?a("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd","range-separator":"至","prefix-icon":"date-tip-logo","picker-options":e.pickerOptions,"start-placeholder":t.placeholder,"end-placeholder":t.placeholder},on:{focus:function(a){return e.timeFocus(t)}},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"formItem.model"}}):"selectTo"===t.formEle.toString()?a("select-to",{attrs:{role:e.checkRole(t.id),uid:e.uid,curRole:e.curRole},model:{value:t.model,callback:function(a){e.$set(t,"model",a)},expression:"formItem.model"}}):e._e()],1)])})),0)]),e.isBatch?a("div",{staticClass:"btn-area batch-btn-area"},[a("el-button",{attrs:{type:"primary"},on:{click:e.batchResult}},[e._v("查看结果")]),a("el-button",{attrs:{type:"primary",disabled:e.batchDis},on:{click:e.batchPass}},[e._v("批量取消")])],1):a("div",{staticClass:"btn-area"},[a("el-button",{on:{click:e.resetSearch}},[e._v("重置")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.doSearch(1)}}},[e._v("搜索")])],1)])]),a("div",{staticClass:"v-box form-table-box"},[a("div",{staticClass:"bd"},[a("div",{staticClass:"search-result"},[a("table-box-fixed",{attrs:{tableData:e.tableList,paging:e.isPage,limit:e.pageLimit,totalCount:e.dataSum,tableLabel:e.tableLabel,fixedCol:e.fixedCol,hasCheckBox:e.hasCheckBox,tableFilter:!1,role:e.employeeName,uid:e.uid,checkInit:e.checkInit,isList:!0},on:{pageUpdate:e.pageUpdate,tableFilterList:e.tableFilter,checkedList:e.checkedList,cancelLabel:e.cancelLabel}})],1)])])],1),a("el-dialog",{attrs:{title:"提示",visible:e.passDialog,width:"30%"},on:{"update:visible":function(t){e.passDialog=t}}},[a("div",[e._v(e._s(e.tipText))]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.passDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.passBtn}},[e._v("确 定")])],1)])],1)},o=[]},fa22:function(e,t,a){"use strict";a.r(t);var i=a("ec73"),o=a("4e25");for(var l in o)["default"].indexOf(l)<0&&function(e){a.d(t,e,(function(){return o[e]}))}(l);a("a6d3");var s=a("2877"),c=Object(s.a)(o.default,i.a,i.b,!1,null,"3f9e4b98",null);t.default=c.exports}}]);