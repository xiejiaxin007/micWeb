(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-19ad1108"],{"0233":function(e,t,i){"use strict";var a=i("4ea4");i("99af"),i("c975"),i("d81d"),i("b0c0"),i("ac1f"),i("5319"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("96cf");var r=a(i("1da1")),o=a(i("f946")),n=a(i("ab3a")),s=i("2af9"),l=a(i("c240")),u=a(i("5360")),c=a(i("9061")),d=["1","2","3","4","5"],f={components:{SearchSelectRadio:s.SearchSelectRadio,AudioPlay:s.AudioPlay,FollowList:l.default,BtnOpts:u.default,UploadMaterial:c.default,ConfirmDialog:s.ConfirmDialog,AlertDialog:s.AlertDialog},data:function(){var e=this;return{id:this.$route.query.id,form:{complainType:"",orderId:"",city:"",name:"",phone:"",complainTime:"",source:"",reason:[],isOrderQuestion:"",feedback:"",consultor:"",dutySuper:"",contactTime:"",deliver:"",imgList:[],audioList:[],businessId:"",suggest:""},rules:{complainType:[{required:!0,message:"投诉类型不能为空",trigger:"change"}],orderId:[{validator:function(t,i,a){e.checkComplainType&&""===i?a(new Error):a()},message:"订单ID不能为空",trigger:"blur"}],city:[{required:!0,message:"城市不能为空",trigger:"change"}],name:[{required:!0,message:"客户姓名不能为空",trigger:"blur"},{pattern:/^[A-Za-z\u4e00-\u9fa5]+$/g,message:"客户姓名只允许输入入汉字，大小写字母",trigger:"change"}],phone:[{required:!0,message:"客户电话不能为空",trigger:"blur"},{pattern:/^1\d{10}$/,message:"请输入正确客户电话",trigger:"change"}],complainTime:[{required:!0,message:"客户投诉时间不能为空",trigger:"change"}],source:[{required:!0,message:"投诉来源不能为空",trigger:"change"}],isOrderQuestion:[{required:!0,message:"是否万单问题不能为空",trigger:"change"}],feedback:[{required:!0,message:"客户反馈内容不能为空",trigger:"blur"}],consultor:[{required:!0,message:"咨询师不能为空",trigger:"change"}],dutySuper:[{required:!0,message:"绩效责任上级不能为空",trigger:"change"}],contactTime:[{required:!0,message:"要求联系时间不能为空",trigger:"change"},{validator:function(e,t,i){t+1e3<=Date.now()?i(new Error):i()},message:"要求联系时间必须大于当前时间！",trigger:"change"}],deliver:[{required:!0,message:"转交人员不能为空",trigger:"change"}],material:[{validator:function(t,i,a){0===e.form.imgList.length&&0===e.form.audioList.length?a(new Error):a()},message:"客诉材料不能为空，最少上传附件或录音其中一种"}],suggest:[{required:!0,message:"服管处理建议不能为空",trigger:"blur"}]},complainTypeArr:[],cityApi:{api:o.default.getDetailCityListData,params:{q:"",type:2,param:"withAll,noAll"}},userApi:{api:o.default.getStaffList,params:{q:"",role:"all",status:-1}},chosenCity:{},chosenConsultor:{},chosenDutySuper:{},pickerOptionsBefore:{disabledDate:function(e){return e.getTime()>Date.now()}},pickerOptionsAfter:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},sourceOptions:[],reasonOptions:[],questionOptions:[],deliverOptions:[],loading:!1,isSubmit:!1,isQuality:!1,updateTime:"",formOptions:{},dialog:{visible:!1,content:"",alertList:[],index:0},initButtons:[],alertVisible:!1}},mounted:function(){this.getOptions(),this.id&&this.initData()},computed:{checkComplainType:function(){return this.form.complainType&&-1!==d.indexOf(this.form.complainType)}},methods:{getOptions:function(){var e=this;return(0,r.default)(regeneratorRuntime.mark((function t(){var i,a,r,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.default.commonOptions();case 3:i=t.sent,a=i.data,r=a.code,o=a.msg,s=a.data,0===r?(e.complainTypeArr=s.complaint_type,e.sourceOptions=s.complaint_source,e.reasonOptions=s.complaint_cause,e.questionOptions=s.is_wandan,e.isQuality=s.is_quality,e.formOptions={performance:s.performance_impact,readLine:s.red_yellow_line}):e.$message.error(o),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))()},changeComplainType:function(){this.$refs.form.validateField("orderId"),this.checkComplainType?this.form.orderId&&this.getDeliver():(this.form.consultor="",this.form.dutySuper="",this.form.contactTime="",this.form.isOrderQuestion="",this.getDeliver())},fixOrderId:function(e){e.target.value=e.target.value.replace(/[^\d]/g,""),this.form.orderId=e.target.value},getConsultor:function(){this.form.complainType&&this.form.orderId&&this.getDeliver()},changeCity:function(){(this.checkComplainType&&this.form.orderId||this.form.complainType&&!this.checkComplainType)&&this.getDeliver()},getDeliver:function(e){var t=this;return(0,r.default)(regeneratorRuntime.mark((function i(){var a,r,o,s,l,u;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,a={complaint_type:t.form.complainType,city_id:t.form.city||"-1",order_id:t.form.orderId},i.next=4,n.default.getTransferInfo(a);case 4:r=i.sent,o=r.data,s=o.code,l=o.msg,u=o.data,0===s?(e||(t.chosenConsultor=u.employee||{},t.form.consultor=u.employee?u.employee.value:"",t.chosenDutySuper=u.employee_adjust_leader||{},t.form.dutySuper=u.employee_adjust_leader?u.employee_adjust_leader.value:""),t.form.city&&(t.deliverOptions=u.transferor?[].concat(u.transferor):[],t.form.deliver=u.transferor?u.transferor.value:"",t.form.businessId=u.transferor?u.transferor.business_id:"",u.transferor||t.$message.error("此订单找不到转交人，无法进行创建，请先完善对应的客诉问题跟进人配置！"))):t.$message.error(l),i.next=15;break;case 12:i.prev=12,i.t0=i.catch(0),console.log(i.t0);case 15:case"end":return i.stop()}}),i,null,[[0,12]])})))()},changeConsultor:function(){var e=this;return(0,r.default)(regeneratorRuntime.mark((function t(){var i,a,r,o,s,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,i={employee_id:e.form.consultor},t.next=4,n.default.getAdjustLeaderInfo(i);case 4:a=t.sent,r=a.data,o=r.code,s=r.msg,l=r.data,0===o?(e.form.dutySuper=l.value||"",e.chosenDutySuper=l||{}):e.$message.error(s),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.log(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))()},getMaterial:function(e){this.form.imgList=e.imgList,this.form.audioList=e.audioList,this.$refs.form.validateField("material")},getReasonArr:function(e){var t=[];return e.complaint_category&&t.push(e.complaint_category),e.one_cause&&t.push(e.one_cause),e.two_cause&&t.push(e.two_cause),e.three_cause&&t.push(e.three_cause),t},initData:function(){var e=this;return(0,r.default)(regeneratorRuntime.mark((function t(){var i,a,r,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.loading=!0,t.next=4,n.default.getComplaintDetail({id:e.id,type:2});case 4:i=t.sent,a=i.data,r=a.code,o=a.msg,s=a.data,0===r?(e.initButtons=s.buttons,e.form={complainType:s.complaint_type,orderId:s.order_id,city:s.city_id,name:s.user_realname,phone:s.user_mobile,complainTime:new Date(s.complaint_time).getTime(),source:s.complaint_source,reason:e.getReasonArr(s),isOrderQuestion:s.is_many_order,feedback:s.complaint_desc,consultor:s.employee_id,dutySuper:s.adjust_leader_id,contactTime:new Date(s.request_contact_time).getTime(),deliver:s.transferor,imgList:s.file.pic,audioList:s.file.audio,businessId:s.business_id,suggest:s.service_handle_desc},e.updateTime=s.update_datetime,e.chosenCity={value:s.city_id,name:s.city_id_text},e.chosenConsultor={value:s.employee_id,name:s.employee_id_text},e.chosenDutySuper={value:s.adjust_leader_id,name:s.adjust_leader_id_text},s.transferor?e.deliverOptions=[{value:s.transferor,name:s.transferor_text}]:e.getDeliver(1),e.loading=!1):(e.loading=!1,e.$message.error(o)),t.next=14;break;case 12:t.prev=12,t.t0=t.catch(0);case 14:case"end":return t.stop()}}),t,null,[[0,12]])})))()},getMaterialParams:function(){return{img_arr:this.form.imgList.map((function(e){return e.file_path})),voice_arr:this.form.audioList.map((function(e){return e.file_path}))}},getParams:function(e){var t={complaint_type:this.form.complainType,city_id:this.form.city,user_realname:this.form.name,user_mobile:this.form.phone,complaint_time:this.form.complainTime/1e3,complaint_source:this.form.source,complaint_desc:this.form.feedback,order_id:this.form.orderId,is_many_order:this.form.isOrderQuestion,employee_id:this.form.consultor,adjust_leader_id:this.form.dutySuper,request_contact_time:this.form.contactTime/1e3,complaint_category:this.form.reason[0]||"",one_cause:this.form.reason[1]||"",two_cause:this.form.reason[2]||"",three_cause:this.form.reason[3]||"",business_id:this.form.businessId,transferor:this.form.deliver,complaint_file:this.getMaterialParams(),service_handle_desc:this.form.suggest,force:e};return"editComplaint"===this.$route.name&&(t.id=this.id,t.update_datetime=this.updateTime),t},save:function(e){var t=this;this.$refs.form.validate(function(){var i=(0,r.default)(regeneratorRuntime.mark((function i(a){var r,o,s,l,u,c;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!a){i.next=23;break}if(!t.isSubmit){i.next=3;break}return i.abrupt("return",!1);case 3:if(t.isSubmit=!0,r=t.getParams(e),i.prev=5,"editComplaint"!==t.$route.name){i.next=12;break}return i.next=9,n.default.editComplaint(r);case 9:o=i.sent,i.next=15;break;case 12:return i.next=14,n.default.addComplaint(r);case 14:o=i.sent;case 15:s=o.data,l=s.code,u=s.msg,c=s.data,0===l?t.saveSuccess(c.id):-1===l?(t.dialog.alertList=c.msg_list,t.saveConfirm()):-2===l?t.$refs.btnOpts.handleTaskUpdate():-3===l?t.alertVisible=!0:t.$message.error(u),t.isSubmit=!1,i.next=23;break;case 20:i.prev=20,i.t0=i.catch(5),t.isSubmit=!1;case 23:case"end":return i.stop()}}),i,null,[[5,20]])})));return function(e){return i.apply(this,arguments)}}())},saveConfirm:function(){this.dialog.visible=!0,this.dialog.content=this.dialog.alertList[this.dialog.index].msg,this.dialog.index++},confirmAlert:function(){this.dialog.index<this.dialog.alertList.length?(this.dialog.visible=!1,this.saveConfirm()):this.save("1")},cancelAlert:function(){this.dialog={visible:!1,content:"",alertList:[],index:0}},saveSuccess:function(e){this.$message({message:"保存成功",type:"success"}),this.$router.push({path:"/complaint/followComplaint",query:{id:e||this.id}})},reload:function(){this.id&&this.initData()}}};t.default=f},"0401":function(e,t,i){"use strict";i.r(t);var a=i("f283"),r=i("0e1e");for(var o in r)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return r[e]}))}(o);var n=i("2877"),s=Object(n.a)(r.default,a.a,a.b,!1,null,null,null);t.default=s.exports},"058c":function(e,t,i){var a=i("6c48");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("499e").default)("151eed7f",a,!0,{sourceMap:!1,shadowMode:!1})},"0928":function(e,t,i){"use strict";i.r(t);var a=i("e77b"),r=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(o);t.default=r.a},"0aab":function(e,t,i){"use strict";i.r(t);var a=i("e0d2"),r=i("68a9");for(var o in r)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return r[e]}))}(o);var n=i("2877"),s=Object(n.a)(r.default,a.a,a.b,!1,null,null,null);t.default=s.exports},"0d00":function(e,t,i){"use strict";i.r(t);var a=i("cd1c"),r=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(o);t.default=r.a},"0e04":function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return r}));var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"150px"}},[i("el-form-item",{attrs:{label:"反馈是否准确",prop:"isRight"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.isRight,callback:function(t){e.$set(e.form,"isRight",t)},expression:"form.isRight"}},e._l(e.options,(function(e){return i("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"是否处理完成",prop:"isFinished"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.isFinished,callback:function(t){e.$set(e.form,"isFinished",t)},expression:"form.isFinished"}},e._l(e.options,(function(e){return i("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"处理结果",prop:"result"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入处理结果，最多300字，超出无法输入",maxlength:"300",rows:"3"},model:{value:e.form.result,callback:function(t){e.$set(e.form,"result",t)},expression:"form.result"}})],1)],1)},r=[]},"0e1e":function(e,t,i){"use strict";i.r(t);var a=i("fa86"),r=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(o);t.default=r.a},2317:function(e,t,i){"use strict";var a=i("4ea4");i("4de4"),i("c975"),i("d81d"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("96cf");var r=a(i("1da1")),o=a(i("0aab")),n=a(i("bd4d")),s=a(i("0401")),l=a(i("5775")),u=i("2af9"),c=a(i("ab3a")),d={name:"BtnOpts",components:{ComplaintForm:o.default,FeedBackForm:n.default,PerformanceForm:s.default,AppealForm:l.default,ConfirmDialog:u.ConfirmDialog,RejectDialog:u.RejectDialog,AlertDialog:u.AlertDialog},props:{btns:{type:Array,default:function(){return[]}},isEdit:{type:Boolean,default:!1},options:{type:Object,default:function(){return{}}},formInfo:{type:Object,default:function(){return{}}},updateTime:{type:String,default:""}},computed:{followBtns:function(){var e=["5","6","7","8"];return this.btns.filter((function(t){return-1!==e.indexOf(t.value)}))},optBtns:function(){var e=["5","6","7","8","9"];return this.btns.filter((function(t){return-1===e.indexOf(t.value)}))},activeBtns:function(){return this.btns.map((function(e){return e.value}))},editForm:function(){return{complaint_category:this.formInfo.reason[0]||"",one_cause:this.formInfo.reason[1]||"",two_cause:this.formInfo.reason[2]||"",three_cause:this.formInfo.reason[3]||"",is_many_order:this.formInfo.isOrderQuestion}}},data:function(){return{isAppeal:!1,id:this.$route.query.id,dialog:{visible:!1,title:"",content:"",confirmBtn:"",type:""},rejectVisible:!1,rejectType:"",updateMsgVisible:!1}},methods:{save:function(){this.$emit("save",!0)},showForm:function(e){return-1!==this.activeBtns.indexOf(e)},checkBtnColor:function(e){return-1!==["1","2","3","4","13"].indexOf(e)?"danger":"primary"},handleClick:function(e){switch(e){case"1":case"2":case"3":case"13":this.rejectVisible=!0,this.rejectType=e;break;case"4":this.dialog={visible:!0,title:"关闭任务",content:"您确认要关闭此任务吗？任务关闭后，无法重新开启，只能重新新建客诉任务！",confirmBtn:"关闭",type:e};break;case"10":this.dialog={visible:!0,title:"提示",content:"确认无误后，无法再针对品控绩效处理结果发起申诉，请谨慎操作",confirmBtn:"继续确认",type:e};break;case"11":case"14":this.handleFollow(e);break;case"5":this.$refs.complaintForm.validateForm(this.id,e);break;case"6":this.$refs.feedBackForm.validateForm(this.id,e);break;case"7":this.$emit("saveSuggest",!0);break;case"8":this.$refs.performanceForm.validateForm(this.id,e);break;case"9":this.$refs.appealForm.validateForm(this.id,e)}},confirmCloseTask:function(){this.handleFollow(this.dialog.type)},confirmReject:function(e){var t=this;return(0,r.default)(regeneratorRuntime.mark((function i(){var a,r,o,n,s,l;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,a={complaints_id:t.id,follow_type:t.rejectType,update_datetime:t.updateTime,reason:e,yw_complaints:t.editForm},i.next=4,c.default.rejectTask(a);case 4:r=i.sent,o=r.data,n=o.code,s=o.msg,l=o.data,t.rejectVisible=!1,t.saveBack({code:n,msg:s,data:l},t.rejectType,"该任务已驳回成功，请悉知"),i.next=16;break;case 13:i.prev=13,i.t0=i.catch(0),console.log(i.t0);case 16:case"end":return i.stop()}}),i,null,[[0,13]])})))()},handleFollow:function(e){var t=this;return(0,r.default)(regeneratorRuntime.mark((function i(){var a,r,o,n,s,l,u;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,a={complaints_id:t.id,follow_type:e,update_datetime:t.updateTime},i.next=4,c.default.commonFollow(a);case 4:r=i.sent,o=r.data,n=o.code,s=o.msg,l=o.data,u="4"===e?"任务关闭成功":"","4"!==e&&"10"!==e||(t.dialog.visible=!1),t.saveBack({code:n,msg:s,data:l},e,u),i.next=17;break;case 14:i.prev=14,i.t0=i.catch(0),console.log(i.t0);case 17:case"end":return i.stop()}}),i,null,[[0,14]])})))()},saveBack:function(e,t,i){var a=e.code,r=e.msg;e.data;0===a?(this.$message({message:i||r,type:"success"}),this.isEdit?this.$router.push({path:"/complaint/followComplaint",query:{id:this.id}}):this.$emit("reload",!0)):-2===a?this.handleTaskUpdate():this.$message.error(r)},handleTaskUpdate:function(){this.updateMsgVisible=!0},reload:function(){this.updateMsgVisible=!1,this.$emit("reload",!0)}}};t.default=d},2380:function(e,t,i){"use strict";i.r(t);var a=i("0233"),r=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(o);t.default=r.a},"238d":function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return r}));var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"container-box"},[i("el-breadcrumb",{staticClass:"bread-crumb-box",attrs:{"separator-class":"el-icon-arrow-right"}},[i("el-breadcrumb-item",[i("a",{attrs:{href:"/"}},[e._v("首页")])]),i("el-breadcrumb-item",{attrs:{to:{path:"/complaint/complaintList"}}},[e._v("客诉问题管理")]),i("el-breadcrumb-item",[e._v(e._s("editComplaint"===e.$route.name?"编辑":"新增")+"客诉问题")])],1),i("div",{staticClass:"v-box form-box"},[i("div",{staticClass:"main-title"},[e._v(e._s("editComplaint"===e.$route.name?"编辑":"新增")+"客诉问题")]),i("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"150px"}},[i("el-form-item",{attrs:{label:"投诉类型",prop:"complainType"}},[i("el-select",{attrs:{placeholder:"请选择投诉类型",disabled:"editComplaint"===e.$route.name},on:{change:e.changeComplainType},model:{value:e.form.complainType,callback:function(t){e.$set(e.form,"complainType",t)},expression:"form.complainType"}},e._l(e.complainTypeArr,(function(e){return i("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1),i("el-form-item",{ref:"orderId",class:e.checkComplainType?"is-required":"",attrs:{label:"订单ID",prop:"orderId"}},[i("el-input",{staticClass:"input-width",attrs:{placeholder:"请输入订单ID"},on:{change:e.getConsultor},nativeOn:{input:function(t){return e.fixOrderId(t)}},model:{value:e.form.orderId,callback:function(t){e.$set(e.form,"orderId",t)},expression:"form.orderId"}})],1),i("el-form-item",{attrs:{label:"城市",prop:"city"}},[i("search-select-radio",{staticClass:"input-width",attrs:{placeholder:"请选择城市",apiInfo:e.cityApi,chosenObj:e.chosenCity},on:{getOption:e.changeCity},model:{value:e.form.city,callback:function(t){e.$set(e.form,"city",t)},expression:"form.city"}})],1),i("el-form-item",{attrs:{label:"客户姓名",prop:"name"}},[i("el-input",{staticClass:"input-width",attrs:{placeholder:"请输入客户姓名",maxlength:"60"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),i("el-form-item",{attrs:{label:"客户电话",prop:"phone"}},[i("el-input",{staticClass:"input-width",attrs:{placeholder:"请输入客户电话",maxlength:"11"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),i("el-form-item",{attrs:{label:"客户投诉时间",prop:"complainTime"}},[i("el-date-picker",{attrs:{type:"date",placeholder:"选择客户投诉时间","value-format":"timestamp","picker-options":e.pickerOptionsBefore},model:{value:e.form.complainTime,callback:function(t){e.$set(e.form,"complainTime",t)},expression:"form.complainTime"}})],1),i("el-form-item",{attrs:{label:"客诉来源",prop:"source"}},[i("el-select",{attrs:{placeholder:"请选择客诉来源"},model:{value:e.form.source,callback:function(t){e.$set(e.form,"source",t)},expression:"form.source"}},e._l(e.sourceOptions,(function(e){return i("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"投诉对象及原因",prop:"reason"}},[i("el-cascader",{staticClass:"reason-width",attrs:{placeholder:"请选择投诉对象及原因",options:e.reasonOptions,separator:" > ",props:{checkStrictly:!0,label:"name"},clearable:""},model:{value:e.form.reason,callback:function(t){e.$set(e.form,"reason",t)},expression:"form.reason"}})],1),e.checkComplainType?i("el-form-item",{attrs:{label:"是否万单问题",prop:"isOrderQuestion"}},[i("el-select",{attrs:{placeholder:"请选择是否万单问题"},model:{value:e.form.isOrderQuestion,callback:function(t){e.$set(e.form,"isOrderQuestion",t)},expression:"form.isOrderQuestion"}},e._l(e.questionOptions,(function(e){return i("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1):e._e(),i("el-form-item",{attrs:{label:"客户反馈内容",prop:"feedback"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入客户反馈内容，最多300字，超出无法输入",maxlength:"300",rows:"3"},model:{value:e.form.feedback,callback:function(t){e.$set(e.form,"feedback",t)},expression:"form.feedback"}})],1),e.checkComplainType?i("el-form-item",{attrs:{label:"咨询师",prop:"consultor"}},[i("search-select-radio",{staticClass:"input-width",attrs:{placeholder:"请选择咨询师",apiInfo:e.userApi,chosenObj:e.chosenConsultor},on:{getOption:e.changeConsultor},model:{value:e.form.consultor,callback:function(t){e.$set(e.form,"consultor",t)},expression:"form.consultor"}})],1):e._e(),e.checkComplainType?i("el-form-item",{attrs:{label:"绩效责任上级",prop:"dutySuper"}},[i("search-select-radio",{staticClass:"input-width",attrs:{placeholder:"请选择绩效责任上级",apiInfo:e.userApi,chosenObj:e.chosenDutySuper},model:{value:e.form.dutySuper,callback:function(t){e.$set(e.form,"dutySuper",t)},expression:"form.dutySuper"}})],1):e._e(),e.checkComplainType?i("el-form-item",{attrs:{label:"要求联系时间",prop:"contactTime"}},[i("el-date-picker",{attrs:{type:"datetime",placeholder:"选择要求联系时间","value-format":"timestamp",format:"yyyy-MM-dd HH:mm:ss","picker-options":e.pickerOptionsAfter},model:{value:e.form.contactTime,callback:function(t){e.$set(e.form,"contactTime",t)},expression:"form.contactTime"}})],1):e._e(),i("el-form-item",{attrs:{label:"转交人员",prop:"deliver"}},[i("el-select",{attrs:{disabled:""},model:{value:e.form.deliver,callback:function(t){e.$set(e.form,"deliver",t)},expression:"form.deliver"}},e._l(e.deliverOptions,(function(e){return i("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1),e.isQuality?i("el-form-item",{staticClass:"form-item-margin",attrs:{label:"服管处理建议",prop:"suggest"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入服管处理建议，最多300字，超出无法输入",maxlength:"300",rows:"3"},model:{value:e.form.suggest,callback:function(t){e.$set(e.form,"suggest",t)},expression:"form.suggest"}})],1):e._e(),i("el-form-item",{ref:"material",staticClass:"is-required",attrs:{label:"客诉材料",prop:"material"}},[i("upload-material",{attrs:{imgList:e.form.imgList,audioList:e.form.audioList},on:{getMaterial:e.getMaterial}})],1)],1)],1),e.id?i("follow-list",{attrs:{followId:e.id}}):e._e(),i("btn-opts",{ref:"btnOpts",attrs:{btns:e.initButtons,isEdit:!0,options:e.formOptions},on:{save:function(t){return e.save("0")},reload:e.reload}}),i("confirm-dialog",{attrs:{content:e.dialog.content,confirmBtn:"继续",visible:e.dialog.visible},on:{cancel:e.cancelAlert,confirm:e.confirmAlert}}),i("alert-dialog",{attrs:{visible:e.alertVisible,confirmBtn:"我知道了"},on:{"update:visible":function(t){e.alertVisible=t},confirm:function(t){return e.getDeliver(1)}}},[i("div",[e._v("当前选择的转交人已暂停任务分配，无法正常创建任务，系统将重新为您获取转交人！")])])],1)},r=[]},"2aa9":function(e,t,i){(t=i("24fb")(!1)).push([e.i,".img-list[data-v-3a9b1e4d]{height:auto;overflow:hidden}.img-list li[data-v-3a9b1e4d]{position:relative;float:left;width:100px;height:100px;text-align:center;margin-right:12px;margin-bottom:10px;border:1px solid #eee}.img-list li .img-item-box[data-v-3a9b1e4d]{width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.img-list li .img-item-box img[data-v-3a9b1e4d]{max-width:100%;max-height:100%}.audio-list li[data-v-3a9b1e4d]{height:auto;overflow:hidden;padding-bottom:8px}.audio-list li .audio-item-box[data-v-3a9b1e4d]{float:left}",""]),e.exports=t},"2cbf":function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return r}));var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.list&&e.list.length>0?i("div",{staticClass:"v-box"},[i("div",{staticClass:"main-title"},[e._v("客诉跟进")]),i("div",{staticClass:"follow-list"},[i("el-timeline",e._l(e.list,(function(t,a){return i("el-timeline-item",{key:a,attrs:{timestamp:t.group,placement:"top"}},[i("ul",{staticClass:"follow-content"},e._l(t.data,(function(t,a){return i("li",{key:a},[i("div",{staticClass:"list-title"},[e._v(e._s(t.name)+"：")]),"1"===t.type?i("div",{staticClass:"list-content"},[e._v(e._s(t.value))]):e._e(),"2"===t.type?i("div",{staticClass:"list-content"},[i("show-material",{attrs:{imgList:t.value.pic,audioList:t.value.audio}})],1):e._e()])})),0)])})),1)],1)]):e._e()},r=[]},"34b8d":function(e,t,i){(t=i("24fb")(!1)).push([e.i,".v-box[data-v-3d34bc3d]{padding-top:20px}.v-box .input-width[data-v-3d34bc3d]{width:350px}.v-box .reason-width[data-v-3d34bc3d]{width:100%}",""]),e.exports=t},4490:function(e,t,i){"use strict";i("6cf7")},"44f6":function(e,t,i){"use strict";i.r(t);var a=i("2317"),r=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(o);t.default=r.a},"45fc":function(e,t,i){"use strict";var a=i("23e7"),r=i("b727").some,o=i("a640"),n=i("ae40"),s=o("some"),l=n("some");a({target:"Array",proto:!0,forced:!s||!l},{some:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},"514f":function(e,t,i){var a=i("de62");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("499e").default)("5a892b03",a,!0,{sourceMap:!1,shadowMode:!1})},"534d":function(e,t,i){"use strict";var a=i("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("96cf");var r=a(i("1da1")),o=a(i("ab3a")),n={name:"FeedBackForm",props:{formInfo:{type:Object,default:function(){return{}}},updateTime:{type:String,default:""}},data:function(){return{options:[{name:"是",value:"1"},{name:"否",value:"2"}],form:{isRight:"",isFinished:"",result:""},rules:{isRight:[{required:!0,message:"反馈是否准确不能为空",trigger:"change"}],isFinished:[{required:!0,message:"是否处理完毕不能为空",trigger:"change"}],result:[{required:!0,message:"处理结果不能为空",trigger:"blur"}]},isSubmit:!1}},methods:{validateForm:function(e,t){var i=this;this.$refs.form.validate(function(){var a=(0,r.default)(regeneratorRuntime.mark((function a(r){var n,s,l,u,c,d;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!r){a.next=21;break}if(!i.isSubmit){a.next=3;break}return a.abrupt("return",!1);case 3:return i.isSubmit=!0,a.prev=4,n={complaints_id:e,follow_type:t,update_datetime:i.updateTime,exact:i.form.isRight,complete:i.form.isFinished,detail:i.form.result,yw_complaints:i.formInfo},a.next=8,o.default.saveProjectFollow(n);case 8:s=a.sent,l=s.data,u=l.code,c=l.msg,d=l.data,i.$emit("save",{code:u,msg:c,data:d},t,"保存成功"),i.isSubmit=!1,a.next=21;break;case 17:a.prev=17,a.t0=a.catch(4),console.log(a.t0),i.isSubmit=!1;case 21:case"end":return a.stop()}}),a,null,[[4,17]])})));return function(e){return a.apply(this,arguments)}}())}}};t.default=n},5360:function(e,t,i){"use strict";i.r(t);var a=i("8955"),r=i("44f6");for(var o in r)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return r[e]}))}(o);i("e938");var n=i("2877"),s=Object(n.a)(r.default,a.a,a.b,!1,null,"8cb15004",null);t.default=s.exports},5775:function(e,t,i){"use strict";i.r(t);var a=i("8036"),r=i("0d00");for(var o in r)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return r[e]}))}(o);var n=i("2877"),s=Object(n.a)(r.default,a.a,a.b,!1,null,null,null);t.default=s.exports},"59c5":function(e,t,i){"use strict";i("058c")},6403:function(e,t,i){"use strict";i.r(t);var a=i("238d"),r=i("2380");for(var o in r)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return r[e]}))}(o);i("91c0");var n=i("2877"),s=Object(n.a)(r.default,a.a,a.b,!1,null,"3d34bc3d",null);t.default=s.exports},"68a9":function(e,t,i){"use strict";i.r(t);var a=i("e1ff"),r=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(o);t.default=r.a},"6c48":function(e,t,i){(t=i("24fb")(!1)).push([e.i,".follow-content li[data-v-742459db]{height:auto;overflow:hidden}.follow-content li .list-title[data-v-742459db]{text-align:right;vertical-align:middle;float:left;color:#606266;line-height:40px;padding:0 12px 0 0;-webkit-box-sizing:border-box;box-sizing:border-box;width:125px}.follow-content li .list-content[data-v-742459db]{margin-left:125px;line-height:40px}",""]),e.exports=t},"6cf7":function(e,t,i){var a=i("c809");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("499e").default)("35eccc50",a,!0,{sourceMap:!1,shadowMode:!1})},8036:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return r}));var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"150px"}},[i("el-form-item",{attrs:{label:"申诉原因",prop:"reason"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入申诉原因，最多300字，超出无法输入",maxlength:"300",rows:"3"},model:{value:e.form.reason,callback:function(t){e.$set(e.form,"reason",t)},expression:"form.reason"}})],1),i("el-form-item",{ref:"material",staticClass:"is-required",attrs:{label:"申诉材料",prop:"material"}},[i("upload-material",{on:{getMaterial:e.getMaterial}})],1),i("el-form-item",{attrs:{label:"申诉期望",prop:"expect"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入申诉期望，最多300字，超出无法输入",maxlength:"300",rows:"3"},model:{value:e.form.expect,callback:function(t){e.$set(e.form,"expect",t)},expression:"form.expect"}})],1)],1)},r=[]},8955:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return r}));var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"follow-opt-box"},[e.showForm("5")?i("complaint-form",{ref:"complaintForm",attrs:{formInfo:e.editForm,updateTime:e.updateTime},on:{save:e.saveBack}}):e._e(),e.showForm("6")?i("feed-back-form",{ref:"feedBackForm",attrs:{formInfo:e.editForm,updateTime:e.updateTime},on:{save:e.saveBack}}):e._e(),e.showForm("8")?i("performance-form",{ref:"performanceForm",attrs:{performanceOptions:e.options.performance,lineOptions:e.options.readLine,formInfo:e.editForm,updateTime:e.updateTime},on:{save:e.saveBack}}):e._e(),e.showForm("9")&&e.isAppeal?i("appeal-form",{ref:"appealForm",attrs:{formInfo:e.editForm,updateTime:e.updateTime},on:{save:e.saveBack}}):e._e(),i("div",{staticClass:"fix-buttons"},[e.isEdit?i("router-link",{attrs:{to:{path:"/complaint/complaintList"}}},[i("el-button",[e._v("取消")])],1):e._e(),e.isEdit?i("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")]):e._e(),e.followBtns&&e.followBtns.length>0?e._l(e.followBtns,(function(t){return i("span",{key:t.value},[i("router-link",{attrs:{to:{path:"/complaint/complaintList"}}},[i("el-button",[e._v("取消")])],1),i("el-button",{attrs:{type:"primary"},on:{click:function(i){return e.handleClick(t.value)}}},[e._v("保存")])],1)})):e._e(),e.showForm("9")?[e.isAppeal?i("span",[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleClick("9")}}},[e._v("保存")])],1):i("el-button",{attrs:{type:"danger"},on:{click:function(t){e.isAppeal=!0}}},[e._v("申诉")])]:e._e(),e.optBtns&&e.optBtns.length>0?e._l(e.optBtns,(function(t){return i("el-button",{key:t.value,attrs:{type:e.checkBtnColor(t.value)},on:{click:function(i){return e.handleClick(t.value)}}},[e._v(e._s(t.name))])})):e._e()],2),i("confirm-dialog",{attrs:{title:e.dialog.title,content:e.dialog.content,confirmBtn:e.dialog.confirmBtn,visible:e.dialog.visible},on:{cancel:function(t){e.dialog.visible=!1},confirm:e.confirmCloseTask}}),i("reject-dialog",{attrs:{title:"驳回客诉问题",visible:e.rejectVisible},on:{close:function(t){e.rejectVisible=!1},confirm:e.confirmReject}}),i("alert-dialog",{attrs:{visible:e.updateMsgVisible,confirmBtn:"我知道了"},on:{"update:visible":function(t){e.updateMsgVisible=t},confirm:e.reload}},[i("div",[e._v("任务已发生变更，关闭弹窗后会刷新任务，请确认任务后再次跟进，刷新后当前已跟进的信息无法保存！")])])],1)},r=[]},"89c2":function(e,t,i){"use strict";i.r(t);var a=i("9f85"),r=i("0928");for(var o in r)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return r[e]}))}(o);i("fc58");var n=i("2877"),s=Object(n.a)(r.default,a.a,a.b,!1,null,"3a9b1e4d",null);t.default=s.exports},9061:function(e,t,i){"use strict";i.r(t);var a=i("e0f8"),r=i("c0c1");for(var o in r)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return r[e]}))}(o);i("4490");var n=i("2877"),s=Object(n.a)(r.default,a.a,a.b,!1,null,"327af744",null);t.default=s.exports},"91c0":function(e,t,i){"use strict";i("df17e")},"9f85":function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return r}));var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.imgList&&e.imgList.length>0?i("ul",{staticClass:"img-list"},e._l(e.imgList,(function(t,a){return i("li",{key:a},[i("div",{staticClass:"img-item-box"},[i("img",{attrs:{src:e.imgUrl?t[e.imgUrl]:t,alt:"图片凭证"},on:{click:function(i){return e.showPreview(e.imgUrl?t[e.imgUrl]:t)}}})])])})),0):e._e(),e.audioList&&e.audioList.length>0?i("ul",{staticClass:"audio-list"},e._l(e.audioList,(function(t,a){return i("li",{key:a},[i("audio-play",{staticClass:"audio-item-box",attrs:{url:e.audioUrl?t[e.audioUrl]:t}})],1)})),0):e._e(),e.photoIsShow?i("jl-image-preview",{attrs:{showViewer:e.photoIsShow,urlList:e.previewUrl},on:{closeViewer:e.closeViewer}}):e._e()],1)},r=[]},a4ea:function(e,t,i){"use strict";var a=i("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("96cf");var r=a(i("1da1")),o=a(i("89c2")),n=a(i("ab3a")),s={name:"FollowList",props:{followId:{type:String,default:""}},components:{ShowMaterial:o.default},data:function(){return{list:[]}},mounted:function(){this.followId&&this.getFollowList()},methods:{getFollowList:function(){var e=this;return(0,r.default)(regeneratorRuntime.mark((function t(){var i,a,r,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.default.getFollowDetail({id:e.followId});case 3:i=t.sent,a=i.data,r=a.code,o=a.msg,s=a.data,0===r?e.list=s:e.$message.error(o),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))()}}};t.default=s},ab3a:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i("23f7"),r={commonOptions:function(){return a.axios.post("/backend-api/complaint/common-options")},getTransferInfo:function(e){return a.axios.post("/backend-api/employee_order/yw-complaints/get-transfer-info",e)},getAdjustLeaderInfo:function(e){return a.axios.post("/backend-api/employee_order/yw-complaints/get-adjust-leader-info",e)},getComplaintDetail:function(e){return a.axios.post("/backend-api/employee_order/yw-complaints/detail",e)},getFollowDetail:function(e){return a.axios.post("/backend-api/employee_order/yw-complaints/follow-detail",e)},addComplaint:function(e){return a.axios.post("/backend-api/employee_order/yw-complaints/create-complaint",e)},editComplaint:function(e){return a.axios.post("/backend-api/employee_order/yw-complaints/update-complaint",e)},saveHeadFollow:function(e){return a.axios.post("/backend-api/employee_order/yw-complaints/head-follow",e)},saveProjectFollow:function(e){return a.axios.post("/backend-api/employee_order/yw-complaints/project-follow",e)},saveResultFollow:function(e){return a.axios.post("/backend-api/employee_order/yw-complaints/result-follow",e)},saveAppealFollow:function(e){return a.axios.post("/backend-api/employee_order/yw-complaints/complaint",e)},saveSuggestion:function(e){return a.axios.post("/backend-api/employee_order/yw-complaints/suggestion",e)},rejectTask:function(e){return a.axios.post("/backend-api/employee_order/yw-complaints/reject-task",e)},commonFollow:function(e){return a.axios.post("/backend-api/employee_order/yw-complaints/common-follow",e)},complaintEmployeeList:function(e){return a.axios.post("/backend-api/employee_order/yw-complaint-employee/list",e)},getComplaintEmployee:function(e){return a.axios.post("/backend-api/select2/select2/get-complaint-employee",e)},complaintEmployeeSave:function(e){return a.axios.post("/backend-api/employee_order/yw-complaint-employee/save",e)},complaintEmployeeDelete:function(e){return a.axios.post("/backend-api/employee_order/yw-complaint-employee/delete",e)},complaintEmployeeChangeAlloc:function(e){return a.axios.post("/backend-api/employee_order/yw-complaint-employee/change-alloc",e)},ywComplaintsList:function(e){return a.axios.get("/backend-api/employee_order/yw-complaints/list",{params:e})},changeEmployee:function(e){return a.axios.post("/backend-api/employee_order/yw-complaints/change-employee",e)},importReason:function(e){return a.axios.post("/backend-api/employee_order/yw-complaints/import-category",e)}};t.default=r},bd4d:function(e,t,i){"use strict";i.r(t);var a=i("0e04"),r=i("f5be");for(var o in r)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return r[e]}))}(o);var n=i("2877"),s=Object(n.a)(r.default,a.a,a.b,!1,null,null,null);t.default=s.exports},c0c1:function(e,t,i){"use strict";i.r(t);var a=i("dd8b"),r=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(o);t.default=r.a},c240:function(e,t,i){"use strict";i.r(t);var a=i("2cbf"),r=i("e9b6");for(var o in r)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return r[e]}))}(o);i("59c5");var n=i("2877"),s=Object(n.a)(r.default,a.a,a.b,!1,null,"742459db",null);t.default=s.exports},c809:function(e,t,i){(t=i("24fb")(!1)).push([e.i,".upload-btn-box[data-v-327af744]{padding-bottom:10px}.upload-btn-box .upload-btn[data-v-327af744]{display:inline-block;margin-right:20px}.upload-btn-box .upload-tips[data-v-327af744]{color:#888}.img-list[data-v-327af744]{height:auto;overflow:hidden}.img-list li[data-v-327af744]{position:relative;float:left;width:100px;height:100px;text-align:center;margin-right:12px;margin-bottom:10px;border:1px solid #eee}.img-list li .img-item-box[data-v-327af744]{width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.img-list li .img-item-box img[data-v-327af744]{max-width:100%;max-height:100%}.img-list li .img-name[data-v-327af744]{position:absolute;bottom:0;left:0;right:0;display:-webkit-box;text-overflow:ellipsis;-webkit-line-clamp:1;-webkit-box-orient:vertical;background:rgba(0,0,0,.7);overflow:hidden;color:#fff;padding:0 4px;line-height:26px;font-size:12px;word-break:break-all}.img-list li .img-del[data-v-327af744]{position:absolute;top:0;right:0;display:block;width:16px;height:16px;line-height:1;cursor:pointer}.audio-list li[data-v-327af744]{height:auto;overflow:hidden;padding-bottom:8px}.audio-list li .audio-item-box[data-v-327af744]{float:left}.audio-list li .audio-del[data-v-327af744]{float:left;color:#409eff;padding-left:20px;cursor:pointer}",""]),e.exports=t},cd1c:function(e,t,i){"use strict";var a=i("4ea4");i("d81d"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("96cf");var r=a(i("1da1")),o=a(i("ab3a")),n={name:"ComplaintForm",components:{UploadMaterial:a(i("9061")).default},props:{formInfo:{type:Object,default:function(){return{}}},updateTime:{type:String,default:""}},data:function(){var e=this;return{form:{reason:"",expect:"",imgList:[],audioList:[]},rules:{reason:[{required:!0,message:"申诉原因不能为空",trigger:"blur"}],material:[{validator:function(t,i,a){0===e.form.imgList.length&&0===e.form.audioList.length?a(new Error):a()},message:"申诉材料不能为空，最少上传附件或录音其中一种"}],expect:[{required:!0,message:"申诉期望不能为空",trigger:"blur"}]},isSubmit:!1}},methods:{getMaterial:function(e){this.form.imgList=e.imgList,this.form.audioList=e.audioList,this.$refs.form.validateField("material")},getFileInfo:function(){return{pic:this.form.imgList.map((function(e){return e.file_path})),audio:this.form.audioList.map((function(e){return e.file_path}))}},validateForm:function(e,t){var i=this;this.$refs.form.validate(function(){var a=(0,r.default)(regeneratorRuntime.mark((function a(r){var n,s,l,u,c,d;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!r){a.next=21;break}if(!i.isSubmit){a.next=3;break}return a.abrupt("return",!1);case 3:return i.isSubmit=!0,a.prev=4,n={complaints_id:e,follow_type:t,update_datetime:i.updateTime,reason:i.form.reason,file:i.getFileInfo(),expect:i.form.expect,yw_complaints:i.formInfo},a.next=8,o.default.saveAppealFollow(n);case 8:s=a.sent,l=s.data,u=l.code,c=l.msg,d=l.data,i.$emit("save",{code:u,msg:c,data:d},t,"保存成功"),i.isSubmit=!1,a.next=21;break;case 17:a.prev=17,a.t0=a.catch(4),console.log(a.t0),i.isSubmit=!1;case 21:case"end":return a.stop()}}),a,null,[[4,17]])})));return function(e){return a.apply(this,arguments)}}())}}};t.default=n},dd8b:function(e,t,i){"use strict";var a=i("4ea4");i("45fc"),i("a434"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("96cf");var r=a(i("1da1")),o=a(i("f946")),n={name:"UploadMaterial",components:{AudioPlay:i("2af9").AudioPlay},props:{imgList:{type:Array,default:function(){return[]}},audioList:{type:Array,default:function(){return[]}}},data:function(){return{imgLimit:10,audioLimit:10,form:{imgList:[],audioList:[]},ossData:{},photoIsShow:!1,previewUrl:[],uploadLoading:""}},watch:{imgList:{handler:function(e){this.form.imgList=this.imgList,this.imgLimit=10-this.imgList.length}},audioList:{handler:function(e){this.form.audioList=this.audioList,this.audioLimit=10-this.audioList.length}}},mounted:function(){this.getSignCode()},methods:{getSignCode:function(){var e=this;return(0,r.default)(regeneratorRuntime.mark((function t(){var i,a,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i={cate:"complaint"},t.prev=1,t.next=4,o.default.getSign(i);case 4:a=t.sent,0===(r=a.data).code&&(e.ossData=r.data),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})))()},beforeUpdate:function(){this.uploadLoading=this.$loading({lock:!0,text:"请求中，请稍后",spinner:"el-icon-loading",customClass:"loading-default-box",background:"rgba(255, 255, 255, 0.8)"})},getFileURL:function(e,t){if(this.uploadLoading.close(),0!==e.length){for(var i=0;i<e.length;i++){var a={fileName:e[i].originName,file_path:e[i].upURL,file_path_full:e[i].fileURL};"img"===t?this.form.imgList.some((function(t){return t.fileName===e[i].originName}))?this.$message("无法上传重复的凭证"):(this.form.imgList.push(a),this.imgLimit--):"audio"===t&&(this.form.audioList.some((function(t){return t.fileName===e[i].originName}))?this.$message("无法上传重复的凭证"):(this.form.audioList.push(a),this.audioLimit--))}this.$emit("getMaterial",this.form)}else this.$message("上传失败,请重新上传")},delFile:function(e,t){"img"===e?(this.imgLimit++,this.form.imgList.splice(t,1)):"audio"===e&&(this.audioLimit++,this.form.audioList.splice(t,1)),this.$emit("getMaterial",this.form)},showPreview:function(e){this.photoIsShow=!0,this.previewUrl=[e]},closeViewer:function(){this.photoIsShow=!1,this.previewUrl=[]}}};t.default=n},dde2:function(e,t,i){var a=i("2aa9");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("499e").default)("ecbbdc0e",a,!0,{sourceMap:!1,shadowMode:!1})},de62:function(e,t,i){(t=i("24fb")(!1)).push([e.i,".follow-opt-box[data-v-8cb15004]{background:#fff;margin-top:-20px;margin-bottom:20px}.follow-opt-box .fix-buttons[data-v-8cb15004]{text-align:center;background:#fff;padding:10px}.follow-opt-box .fix-buttons .el-button[data-v-8cb15004]{margin:0 20px}",""]),e.exports=t},df17e:function(e,t,i){var a=i("34b8d");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,i("499e").default)("04f25610",a,!0,{sourceMap:!1,shadowMode:!1})},e0d2:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return r}));var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"150px"}},[i("el-form-item",{attrs:{label:"客诉处理详情",prop:"result"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入客诉处理详情，最多300字，超出无法输入",maxlength:"300",rows:"3"},model:{value:e.form.result,callback:function(t){e.$set(e.form,"result",t)},expression:"form.result"}})],1),i("el-form-item",{ref:"material",staticClass:"is-required",attrs:{label:"客诉材料",prop:"material"}},[i("upload-material",{on:{getMaterial:e.getMaterial}})],1)],1)},r=[]},e0f8:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return r}));var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.imgLimit?i("div",{staticClass:"upload-btn-box"},[i("jl-file-upload",{ref:"fileUpload",staticClass:"upload-btn",attrs:{fileType:"jpg,png,jpeg",fileMaxSize:"10mb",upID:"imgUpload",isMulti:!0,limit:e.imgLimit,ossData:e.ossData},on:{beforeUpdate:e.beforeUpdate,getFileURL:function(t){return e.getFileURL(t,"img")}}},[i("el-button",{attrs:{type:"primary"}},[e._v("上传附件")])],1),i("span",{staticClass:"upload-tips"},[e._v("选择附件后进行上传，仅限jpg，png和jpeg格式，10M以内，最多10张")])],1):e._e(),e.form.imgList.length>0?i("ul",{staticClass:"img-list"},e._l(e.form.imgList,(function(t,a){return i("li",{key:a},[i("div",{staticClass:"img-item-box"},[i("img",{attrs:{src:t.file_path_full,alt:"图片凭证"},on:{click:function(i){return e.showPreview(t.file_path_full)}}})]),t.fileName?i("div",{staticClass:"img-name"},[e._v(e._s(t.fileName))]):e._e(),i("i",{staticClass:"img-del iconfont iconicon-delete",attrs:{"aria-hidden":"true"},on:{click:function(t){return e.delFile("img",a)}}})])})),0):e._e(),e.audioLimit?i("div",{staticClass:"upload-btn-box"},[i("jl-file-upload",{ref:"fileUpload",staticClass:"upload-btn",attrs:{fileType:"mp3,amr,m4a",fileMaxSize:"30mb",upID:"audioUpload",isMulti:!0,limit:e.audioLimit,ossData:e.ossData},on:{beforeUpdate:e.beforeUpdate,getFileURL:function(t){return e.getFileURL(t,"audio")}}},[i("el-button",{attrs:{type:"primary"}},[e._v("上传录音")])],1),i("span",{staticClass:"upload-tips"},[e._v("选择附件后进行上传，仅限mp3、amr和m4a格式，30M以内，最多10条")])],1):e._e(),e.form.audioList.length>0?i("ul",{staticClass:"audio-list"},e._l(e.form.audioList,(function(t,a){return i("li",{key:a},[i("audio-play",{staticClass:"audio-item-box",attrs:{url:t.file_path_full}}),i("div",{staticClass:"audio-del",on:{click:function(t){return e.delFile("audio",a)}}},[e._v("删除")])],1)})),0):e._e(),e.photoIsShow?i("jl-image-preview",{attrs:{showViewer:e.photoIsShow,urlList:e.previewUrl},on:{closeViewer:e.closeViewer}}):e._e()],1)},r=[]},e1ff:function(e,t,i){"use strict";var a=i("4ea4");i("d81d"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("96cf");var r=a(i("1da1")),o=a(i("ab3a")),n={name:"ComplaintForm",components:{UploadMaterial:a(i("9061")).default},props:{formInfo:{type:Object,default:function(){return{}}},updateTime:{type:String,default:""}},data:function(){var e=this;return{form:{result:"",imgList:[],audioList:[]},rules:{result:[{required:!0,message:"处理结果不能为空",trigger:"blur"}],material:[{validator:function(t,i,a){0===e.form.imgList.length&&0===e.form.audioList.length?a(new Error):a()},message:"客诉材料不能为空，最少上传附件或录音其中一种"}]},isSubmit:!1}},methods:{getMaterial:function(e){this.form.imgList=e.imgList,this.form.audioList=e.audioList,this.$refs.form.validateField("material")},getFileInfo:function(){return{pic:this.form.imgList.map((function(e){return e.file_path})),audio:this.form.audioList.map((function(e){return e.file_path}))}},validateForm:function(e,t){var i=this;this.$refs.form.validate(function(){var a=(0,r.default)(regeneratorRuntime.mark((function a(r){var n,s,l,u,c,d;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!r){a.next=21;break}if(!i.isSubmit){a.next=3;break}return a.abrupt("return",!1);case 3:return i.isSubmit=!0,a.prev=4,n={complaints_id:e,follow_type:t,update_datetime:i.updateTime,detail:i.form.result,file:i.getFileInfo(),yw_complaints:i.formInfo},a.next=8,o.default.saveHeadFollow(n);case 8:s=a.sent,l=s.data,u=l.code,c=l.msg,d=l.data,i.$emit("save",{code:u,msg:c,data:d},t,"保存成功"),i.isSubmit=!1,a.next=21;break;case 17:a.prev=17,a.t0=a.catch(4),console.log(a.t0),i.isSubmit=!1;case 21:case"end":return a.stop()}}),a,null,[[4,17]])})));return function(e){return a.apply(this,arguments)}}())}}};t.default=n},e77b:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i("2af9"),r={name:"ShowMaterial",props:{imgList:{type:Array,default:function(){return[]}},imgUrl:{type:String,default:""},audioList:{type:Array,default:function(){return[]}},audioUrl:{type:String,default:""}},components:{AudioPlay:a.AudioPlay},data:function(){return{photoIsShow:!1,previewUrl:[]}},methods:{showPreview:function(e){this.photoIsShow=!0,this.previewUrl=[e]},closeViewer:function(){this.photoIsShow=!1,this.previewUrl=[]}}};t.default=r},e938:function(e,t,i){"use strict";i("514f")},e9b6:function(e,t,i){"use strict";i.r(t);var a=i("a4ea"),r=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(o);t.default=r.a},f283:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return r}));var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"150px"}},[i("el-form-item",{attrs:{label:"绩效影响",prop:"performance"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.performance,callback:function(t){e.$set(e.form,"performance",t)},expression:"form.performance"}},e._l(e.performanceOptions,(function(e){return i("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"红黄线影响",prop:"line"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.line,callback:function(t){e.$set(e.form,"line",t)},expression:"form.line"}},e._l(e.lineOptions,(function(e){return i("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1),i("el-form-item",{attrs:{label:"处理结果",prop:"result"}},[i("el-input",{attrs:{type:"textarea",placeholder:"请输入处理结果，最多300字，超出无法输入",maxlength:"300",rows:"3"},model:{value:e.form.result,callback:function(t){e.$set(e.form,"result",t)},expression:"form.result"}})],1)],1)},r=[]},f5be:function(e,t,i){"use strict";i.r(t);var a=i("534d"),r=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(o);t.default=r.a},fa86:function(e,t,i){"use strict";var a=i("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("96cf");var r=a(i("1da1")),o=a(i("ab3a")),n={name:"PerformanceForm",props:{performanceOptions:{type:Array,default:function(){return[]}},lineOptions:{type:Array,default:function(){return[]}},formInfo:{type:Object,default:function(){return{}}},updateTime:{type:String,default:""}},data:function(){return{form:{performance:"",line:"",result:""},rules:{performance:[{required:!0,message:"绩效影响不能为空",trigger:"change"}],line:[{required:!0,message:"红黄线影响不能为空",trigger:"change"}],result:[{required:!0,message:"处理结果不能为空",trigger:"blur"}]},isSubmit:!1}},methods:{validateForm:function(e,t){var i=this;this.$refs.form.validate(function(){var a=(0,r.default)(regeneratorRuntime.mark((function a(r){var n,s,l,u,c,d;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!r){a.next=21;break}if(!i.isSubmit){a.next=3;break}return a.abrupt("return",!1);case 3:return i.isSubmit=!0,a.prev=4,n={complaints_id:e,follow_type:t,update_datetime:i.updateTime,adjust:i.form.performance,warning:i.form.line,detail:i.form.result,yw_complaints:i.formInfo},a.next=8,o.default.saveResultFollow(n);case 8:s=a.sent,l=s.data,u=l.code,c=l.msg,d=l.data,i.$emit("save",{code:u,msg:c,data:d},t,"保存成功"),i.isSubmit=!1,a.next=21;break;case 17:a.prev=17,a.t0=a.catch(4),console.log(a.t0),i.isSubmit=!1;case 21:case"end":return a.stop()}}),a,null,[[4,17]])})));return function(e){return a.apply(this,arguments)}}())}}};t.default=n},fc58:function(e,t,i){"use strict";i("dde2")}}]);