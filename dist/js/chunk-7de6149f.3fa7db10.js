(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7de6149f"],{"0628":function(t,e,a){"use strict";a.r(e);var i=a("b73c"),n=a("c152");for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(o);a("f9cc");var r=a("2877"),l=Object(r.a)(n.default,i.a,i.b,!1,null,"1e535318",null);e.default=l.exports},"10c1":function(t,e,a){"use strict";var i=a("4ea4");a("7db0"),a("4160"),a("a434"),a("b0c0"),a("a9e3"),a("ac1f"),a("5319"),a("159b"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("96cf");var n=i(a("1da1")),o=i(a("fc7f")),r=a("f946"),l=a("7223"),s=a("edfb"),c={name:"PerformanceRiskList",data:function(){var t=this,e=function(e,a,i){var n=["phone","email","qq","wechat"];if(""!==a)t.hasLink||(t.hasLink=!0,n.forEach((function(a){e.field!=a&&t.$refs.complainForm.validateField(a)}))),i();else{if(t.hasLink=!1,n.forEach((function(e){""!==t.complainData[e]&&(t.hasLink=!0)})),!t.hasLink)return i(new Error(""));i()}};return{complainData:{channel:"",title:"",cityId:"",employeeName:"",joiner:"",insider:"",dateTime:"",content:"",investigationProposal:"",name:"",phone:"",email:"",qq:"",wechat:"",orderId:"",handleResult:"",imgUrls:[],soundUrls:[]},hasLink:!1,rules:{channel:[{required:!0,message:"请选择举报途径"}],title:[{required:!0,message:"请输入投诉标题"},{min:1,max:20,message:"标题长度不能大于20个字"}],cityId:[{required:!0,message:"请选择投诉发生的城市"}],employeeName:[{required:!0,message:"请输入被举报员工"},{min:1,max:20,message:"员工姓名不能大于20个字"}],joiner:[{min:0,max:20,message:"不能大于20个字"}],insider:[{min:0,max:20,message:"不能大于20个字"}],dateTime:[{required:!0,message:"请选择问题发生时间"}],content:[{required:!0,message:"请输入问题的详情描述"},{min:1,max:3e3,message:"不能大约3000字"}],investigationProposal:[{required:!0,message:"请输入调查建议"},{min:1,max:300,message:"不能大约300字"}],name:[{min:0,max:20,message:"举报人姓名不能大于20个字"}],phone:[{validator:e,message:"联系方式至少要填写一项",trigger:"change"},{validator:function(t,e,a){if(!l.commonFun.verifyTelNum(e)&&""!==e)return a(new Error(""));a()},message:"请输入正确格式的手机号"}],email:[{validator:e,message:"联系方式至少要填写一项",trigger:"change"},{validator:function(t,e,a){if(!l.commonFun.verifyEmail(e)&&""!==e)return a(new Error(""));a()},message:"请输入正确格式的email地址"}],qq:[{validator:e,message:"联系方式至少要填写一项",trigger:"change"}],wechat:[{validator:e,message:"联系方式至少要填写一项",trigger:"change"}],handleResult:"",imgUrls:[{validator:function(t,e,a){if(e.length>9)return a(new Error(""));a()},message:"不能超过9张图"}],soundUrls:[{validator:function(t,e,a){if(e.length>10)return a(new Error(""));a()},message:"不能超过10个音频"}],orderId:[{validator:function(t,e,a){if("NaN"===String(Number(e)))return a(new Error(""));a()},message:"需要输入为数字"},{min:1,max:20,message:"订单号不能大于20个数字"}]},contentLoading:!1,cityList:[],progress:s.COMPLAIN_PROGRESS,complainChannels:s.COMPLAIN_CHANNELS,dialogData:{show:!1,title:"保存失败",cnt:"保存失败，请重试！"},showViewer:!1,viewerStartsIndex:0,body:"",ossData:{}}},computed:{sortUrlList:function(){var t=[],e=this.complainData.imgUrls.length,a=Number(this.viewerStartsIndex);return this.complainData.imgUrls.forEach((function(i,n){t[n-a<0?e+n-a:n-a]=i.fileURL})),t}},created:function(){try{this.getCityList(),this.getSignCode()}catch(t){console.log(t)}},mounted:function(){var t=this;this.$nextTick((function(){t.body=document.getElementsByTagName("body")[0]||doucumnet.body}))},methods:{getFileURL:function(t,e){var a=this;this.contentLoading=!1,0!==t.length?"img"===e?t.forEach((function(t){a.complainData.imgUrls.find((function(e){return e.originName===t.originName}))?a.$message("已过滤掉重复图片"):a.complainData.imgUrls.push(t)})):"audio"===e&&t.forEach((function(t){a.complainData.soundUrls.find((function(e){return e.originName===t.originName}))?a.$message("已过滤掉重复图片"):a.complainData.soundUrls.push(t)})):this.$message("上传失败,请重新上传")},getSignCode:function(){var t=this;return(0,n.default)(regeneratorRuntime.mark((function e(){var a,i,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={cate:t.uploadUrl},e.prev=1,e.next=4,(0,r.getSign)(a);case 4:i=e.sent,0===(n=i.data).code&&(t.ossData=n.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))()},getCityList:function(){var t=this;return(0,n.default)(regeneratorRuntime.mark((function e(){var a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.getCity)(1);case 2:a=e.sent,0===(i=a.data).code&&(i.data.splice(0,1),t.cityList=i.data);case 5:case"end":return e.stop()}}),e)})))()},validSub:function(){var t=this;this.$refs.complainForm.validate((function(e){if(!e)return!1;t.subComplaint()}))},subComplaint:function(){var t=this;return(0,n.default)(regeneratorRuntime.mark((function e(){var a,i,n,r,l,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.complainData,i=[],a.imgUrls.forEach((function(t){i.push(t.upURL)})),n=[],a.soundUrls.forEach((function(t){n.push(t.upURL)})),r={complaint_channel:a.channel,title:a.title,city_id:a.cityId,employee_name:a.employeeName,participant:a.joiner,insider:a.insider,complaint_time:a.dateTime,content:a.content,investigation_proposal:a.investigationProposal,voucher_arr:{img:i,audio:n},customer_name:a.name,customer_mobile:a.phone,customer_email:a.email,customer_qq:a.qq,customer_wechat:a.wechat,order_id:a.orderId,handle_result:a.handleResult},e.next=8,o.default.addComplaint(r);case 8:l=e.sent,0==(s=l.data).code?t.goback():(t.dialogData.show=!0,t.dialogData.cnt=s.msg);case 11:case"end":return e.stop()}}),e)})))()},goback:function(){this.$router.replace({path:"/performance/complainList"})},delUpelm:function(t,e){"img"==t?this.complainData.imgUrls.splice(e,1):this.complainData.soundUrls.splice(e,1)},closeDialog:function(){this.dialogData.show=!1,this.dialogData.cnt=""},closeViewer:function(t){this.showViewer=t,this.body.style.overflow="auto"},showViewerFn:function(t){this.viewerStartsIndex=t,this.showViewer=!0,this.body.style.overflow="hidden"}}};e.default=c},1989:function(t,e,a){var i=a("f6d1");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,a("499e").default)("bfa256c6",i,!0,{sourceMap:!1,shadowMode:!1})},b73c:function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return n}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.contentLoading,expression:"contentLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"el-row"},[a("el-col",{staticClass:"content-main",attrs:{span:24}},[a("el-breadcrumb",{staticClass:"bread-crumb-box",attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[a("a",{attrs:{href:"/"}},[t._v("首页")])]),a("el-breadcrumb-item",{attrs:{to:{path:"/performance/complainList"}}},[t._v("投诉管理")]),a("el-breadcrumb-item",[t._v("新建投诉")])],1),a("div",{staticClass:"v-box form-table-box box-relative"},[a("div",{staticClass:"bd"},[a("div",{staticClass:"complain-form-wrap"},[a("p",{staticClass:"form-tit"},[t._v("举报内容：")]),a("el-form",{ref:"complainForm",attrs:{model:t.complainData,rules:t.rules,"label-width":"130px"}},[a("el-form-item",{attrs:{label:"举报途径：",prop:"channel"}},[a("el-select",{staticClass:"box-width-100",attrs:{placeholder:"请选择举报途径",filterable:""},model:{value:t.complainData.channel,callback:function(e){t.$set(t.complainData,"channel",e)},expression:"complainData.channel"}},t._l(t.complainChannels,(function(t){return a("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})})),1)],1),a("el-form-item",{attrs:{label:"标题：",prop:"title"}},[a("el-input",{attrs:{placeholder:"请输入投诉标题"},model:{value:t.complainData.title,callback:function(e){t.$set(t.complainData,"title","string"==typeof e?e.trim():e)},expression:"complainData.title"}})],1),a("el-form-item",{attrs:{label:"问题发生城市：",prop:"cityId"}},[a("el-select",{staticClass:"box-width-100",attrs:{filterable:"",placeholder:"请输入城市"},model:{value:t.complainData.cityId,callback:function(e){t.$set(t.complainData,"cityId",e)},expression:"complainData.cityId"}},t._l(t.cityList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})})),1)],1),a("el-form-item",{attrs:{label:"被举报员工：",prop:"employeeName"}},[a("el-input",{attrs:{placeholder:"请输入被举报员工"},model:{value:t.complainData.employeeName,callback:function(e){t.$set(t.complainData,"employeeName","string"==typeof e?e.trim():e)},expression:"complainData.employeeName"}})],1),a("el-form-item",{attrs:{label:"参与人：",prop:"joiner"}},[a("el-input",{attrs:{placeholder:"请输入参与人"},model:{value:t.complainData.joiner,callback:function(e){t.$set(t.complainData,"joiner","string"==typeof e?e.trim():e)},expression:"complainData.joiner"}})],1),a("el-form-item",{attrs:{label:"知情人：",prop:"insider"}},[a("el-input",{attrs:{placeholder:"请输入知情人"},model:{value:t.complainData.insider,callback:function(e){t.$set(t.complainData,"insider","string"==typeof e?e.trim():e)},expression:"complainData.insider"}})],1),a("el-form-item",{attrs:{label:"问题发生时间：",prop:"dateTime"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",format:"yyyy-MM-dd",placeholder:"请选择日期"},model:{value:t.complainData.dateTime,callback:function(e){t.$set(t.complainData,"dateTime",e)},expression:"complainData.dateTime"}})],1),a("el-form-item",{attrs:{label:"问题详情描述：",prop:"content"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入问题的具体情况",maxlength:"3000",autosize:{minRows:2,maxRows:10},"show-word-limit":""},model:{value:t.complainData.content,callback:function(e){t.$set(t.complainData,"content",e)},expression:"complainData.content"}})],1),a("el-form-item",{attrs:{label:"调查建议：",prop:"investigationProposal"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入调查建议",maxlength:"300",autosize:{minRows:2,maxRows:10},"show-word-limit":""},model:{value:t.complainData.investigationProposal,callback:function(e){t.$set(t.complainData,"investigationProposal","string"==typeof e?e.trim():e)},expression:"complainData.investigationProposal"}})],1),a("el-form-item",{attrs:{label:"上传图片凭证：",prop:"imgUrls"}},[t.complainData.imgUrls.length<9?a("jl-file-upload",{ref:"imgUpload",attrs:{upID:"imgUpload",fileType:"bmp,jpg,jpeg,gif,png",fileMaxSize:"5mb",ossData:t.ossData,isMulti:!0,limit:9-t.complainData.imgUrls.length},on:{beforeUpdate:function(e){t.contentLoading=!0},getFileURL:function(e){return t.getFileURL(e,"img")}}},[a("div",{staticClass:"img"},[a("i",{staticClass:"el-icon-plus add_img",attrs:{"aria-hidden":"true"}})])]):t._e()],1),a("div",{staticClass:"uploadlist-wrap"},t._l(t.complainData.imgUrls,(function(e,i){return a("div",{key:"img"+i,staticClass:"updata-wrap"},[a("el-image",{attrs:{src:e.fileURL},on:{click:function(e){return t.showViewerFn(i)}}}),a("div",{staticClass:"close",on:{click:function(e){return t.delUpelm("img",i)}}},[t._v(" X ")])],1)})),0),a("el-form-item",{attrs:{label:"上传音频凭证：",prop:"soundUrls"}},[t.complainData.soundUrls.length<10?a("jl-file-upload",{ref:"audioUpload",attrs:{upID:"audioUpload",fileType:"amr,mp3,wav,mp4,m4a",fileMaxSize:"100mb",ossData:t.ossData,isMulti:!0,limit:10-t.complainData.soundUrls.length},on:{beforeUpdate:function(e){t.contentLoading=!0},getFileURL:function(e){return t.getFileURL(e,"audio")}}},[a("div",{staticClass:"sound"},[a("i",{staticClass:"el-icon-plus add_img",attrs:{"aria-hidden":"true"}})])]):t._e()],1),a("div",{staticClass:"uploadlist-wrap"},t._l(t.complainData.soundUrls,(function(e,i){return a("div",{key:"sound"+i,staticClass:"updata-wrap sound-wrap"},[a("audio",{attrs:{src:e.fileURL,controls:"controls"}}),a("div",{staticClass:"close",on:{click:function(e){return t.delUpelm("audio",i)}}},[t._v(" X ")])])})),0),a("p",{staticClass:"form-tit"},[t._v("举报人信息：")]),a("el-form-item",{attrs:{label:"举报人姓名：",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入举报人姓名"},model:{value:t.complainData.name,callback:function(e){t.$set(t.complainData,"name","string"==typeof e?e.trim():e)},expression:"complainData.name"}})],1),a("el-form-item",{attrs:{label:"举报人手机：",prop:"phone"}},[a("el-input",{attrs:{placeholder:"联系方式至少选填一项"},model:{value:t.complainData.phone,callback:function(e){t.$set(t.complainData,"phone","string"==typeof e?e.trim():e)},expression:"complainData.phone"}})],1),a("el-form-item",{attrs:{label:"举报人邮箱：",prop:"email"}},[a("el-input",{attrs:{placeholder:"联系方式至少选填一项"},model:{value:t.complainData.email,callback:function(e){t.$set(t.complainData,"email","string"==typeof e?e.trim():e)},expression:"complainData.email"}})],1),a("el-form-item",{attrs:{label:"举报人qq：",prop:"qq"}},[a("el-input",{attrs:{placeholder:"联系方式至少选填一项"},model:{value:t.complainData.qq,callback:function(e){t.$set(t.complainData,"qq","string"==typeof e?e.trim():e)},expression:"complainData.qq"}})],1),a("el-form-item",{attrs:{label:"举报人微信：",prop:"wechat"}},[a("el-input",{attrs:{placeholder:"联系方式至少选填一项"},model:{value:t.complainData.wechat,callback:function(e){t.$set(t.complainData,"wechat","string"==typeof e?e.trim():e)},expression:"complainData.wechat"}})],1),a("el-form-item",{attrs:{label:"订单ID：",prop:"orderId"}},[a("el-input",{attrs:{placeholder:"请输入订单ID"},model:{value:t.complainData.orderId,callback:function(e){t.$set(t.complainData,"orderId","string"==typeof e?e.trim():e)},expression:"complainData.orderId"}})],1),a("p",{staticClass:"form-tit"},[t._v("处理结果：")]),a("el-form-item",{attrs:{label:"请填写处理结果：",prop:"handleResult"}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入处理结果"},model:{value:t.complainData.handleResult,callback:function(e){t.$set(t.complainData,"handleResult","string"==typeof e?e.trim():e)},expression:"complainData.handleResult"}})],1)],1)],1),a("div",{staticClass:"form-btn-wrap"},[a("el-button",{attrs:{type:"primary"},on:{click:t.validSub}},[t._v("提交")])],1)])])],1),a("el-dialog",{attrs:{visible:t.dialogData.show,title:t.dialogData.title,width:"30%",center:!0},on:{"update:visible":function(e){return t.$set(t.dialogData,"show",e)}}},[a("div",{staticClass:"dialog-content"},[a("p",{staticClass:"content-tex save-warn-tex"},[t._v(t._s(t.dialogData.cnt))])]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.closeDialog}},[t._v("确定")])],1)]),t.showViewer?a("jl-image-preview",{attrs:{showViewer:t.showViewer,urlList:t.sortUrlList},on:{closeViewer:t.closeViewer}}):t._e()],1)},n=[]},c152:function(t,e,a){"use strict";a.r(e);var i=a("10c1"),n=a.n(i);for(var o in i)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(o);e.default=n.a},edfb:function(t,e,a){"use strict";a("4160"),a("159b"),Object.defineProperty(e,"__esModule",{value:!0}),e.DataConfig=e.COMPLAIN_CHANNELS_INCLUD_ONLINE=e.COMPLAIN_CHANNELS=e.COMPLAIN_PROGRESS=void 0;var i=[{id:1,text:"未处理"},{id:2,text:"已处理"}];e.COMPLAIN_PROGRESS=i;var n=[{id:1,text:"邮箱举报"},{id:2,text:"电话举报"},{id:3,text:"信涵举报"}];e.COMPLAIN_CHANNELS=n;var o=[{id:1,text:"邮箱举报"},{id:2,text:"电话举报"},{id:3,text:"信涵举报"},{id:4,text:"线上举报"}];e.COMPLAIN_CHANNELS_INCLUD_ONLINE=o;var r={COMPLAIN_PROGRESS:i,COMPLAIN_CHANNELS:n,COMPLAIN_CHANNELS_INCLUD_ONLINE:o,getConfig:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a={};return e.forEach((function(e){a[e.toUpperCase()]=t[e.toUpperCase()]?t[e.toUpperCase()]:[]})),a}};e.DataConfig=r},f6d1:function(t,e,a){(e=a("24fb")(!1)).push([t.i,".content-main[data-v-1e535318]{padding:0 15px}.form-table-box[data-v-1e535318]{background-color:#fff}.form-table-box .filter-link-more[data-v-1e535318]{float:right;padding:9px 20px;margin-top:6px}.form-tip-box[data-v-1e535318]{color:#999}.form-table-box .batch-btn-area[data-v-1e535318]{text-align:right;position:absolute;right:20px;top:10px}.box-relative[data-v-1e535318]{position:relative}.box-absolute[data-v-1e535318]{position:absolute}.form-tit[data-v-1e535318]{font-size:16px;font-weight:700}.form-btn-wrap[data-v-1e535318]{text-align:center}.complain-form-wrap[data-v-1e535318]{width:50%}.box-width-100[data-v-1e535318]{width:100%}.uploadlist-wrap[data-v-1e535318]{min-width:800px;padding-left:80px;-webkit-box-sizing:border-box;box-sizing:border-box}.updata-wrap[data-v-1e535318]{position:relative;width:100px;height:100px;display:inline-block;margin-right:10px}.updata-wrap.sound-wrap[data-v-1e535318]{width:auto}.updata-wrap .close[data-v-1e535318]{position:absolute;cursor:pointer;right:2px;top:2px;background-color:#f56c6c;color:#fff;width:25px;height:25px;line-height:25px;text-align:center;border-radius:50%;font-weight:700;opacity:0;-webkit-transition:all .3s;transition:all .3s}.updata-wrap:hover .close[data-v-1e535318]{opacity:1}",""]),t.exports=e},f9cc:function(t,e,a){"use strict";a("1989")},fc7f:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a("23f7"),n={getPerformanceManageList:function(t){return i.axios.get("/backend-api/bk-api-adjust-risk/list",{params:t})},getRiskInitialize:function(){return i.axios.post("/backend-api/bk-api-adjust-risk/initialize")},getRiskInitDetail:function(t){return i.axios.post("/backend-api/bk-api-adjust-risk/detail",t)},getRiskAudit:function(t){return i.axios.post("/backend-api/bk-api-adjust-risk/audit",t)},getComplaintList:function(t){return i.axios.get("/backend-api/complaint/list",{params:t})},addComplaint:function(t){return i.axios.post("/backend-api/complaint/add-complaint",t)},getComplaintDetail:function(t){return i.axios.post("/backend-api/complaint/complaint-handling",t)},updateComplaint:function(t){return i.axios.post("/backend-api/complaint/update-complaint-handling",t)}};e.default=n}}]);