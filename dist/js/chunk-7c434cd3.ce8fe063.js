(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7c434cd3"],{"24e3":function(t,a,e){var i=e("57e6");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,e("499e").default)("10247050",i,!0,{sourceMap:!1,shadowMode:!1})},"395c":function(t,a,e){"use strict";var i=e("4ea4");e("4160"),e("a15b"),e("d81d"),e("a9e3"),e("b64b"),e("498a"),e("159b"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,e("96cf");var o=i(e("1da1")),n=i(e("fc7f")),s=e("f946"),r=e("7223"),l=e("edfb"),c={name:"ComplainList",data:function(){return{tableList:[],page:1,dataSum:0,limit:20,tableLabel:[],contentLoading:!0,cityList:[],progress:l.COMPLAIN_PROGRESS,complainChannels:l.COMPLAIN_CHANNELS_INCLUD_ONLINE,searchData:{cityId:"",title:"",employeeName:"",orderId:"",customerName:"",customerMobile:"",complaintTime:[],complaintChannel:[],handleStatus:""},showDialog:!1,dialogType:"",dialogData:{tit:"",complaintTime:"",employeeName:"",cnt:"",handleResult:""},complainResult:"",richTxt:{rtxt:{voucher_data:{type:"media",imgType:"mediaImg",haveCallback:!0},operation:{type:"html",haveCallback:!0,renderFn:function(t,a){return t.audit_auth?'<p \n                                            class="options-row-btn"\n                                            data-cell-dom-type="audit_auth"\n                                        >审核</p>':t.update_auth?"<p\n                                            class=\"options-row-btn\"\n                                            data-cell-dom-type='update_auth'\n                                        >修改</p>":void 0}},customer_contact:{type:"html",renderFn:function(t){var a="";return t.forEach((function(t){""!=t.customer_mobile&&null!=t.customer_mobile?a+="<p>电话：".concat(t.customer_mobile,"</p>"):""!=t.customer_email&&null!=t.customer_email?a+="<p>邮箱：".concat(t.customer_email,"</p>"):""!=t.customer_qq&&null!=t.customer_qq?a+="<p>qq：".concat(t.customer_qq,"</p>"):""!=t.customer_wechat&&null!=t.customer_wechat&&(a+="<p>wechat：".concat(t.customer_wechat,"</p>"))})),a}}}},showCreate:!1,showExport:!1,dialogTips:"",showViewer:!1,viewerUrlList:[],viewerStartsIndex:0,body:""}},computed:{sortUrlList:function(){var t=[],a=this.viewerUrlList.length,e=Number(this.viewerStartsIndex);return this.viewerUrlList.forEach((function(i,o){t[o-e<0?a+o-e:o-e]=i})),t}},created:function(){try{this.getCityList()}catch(t){console.log(t)}},mounted:function(){var t=this;this.$nextTick((function(){t.body=document.getElementsByTagName("body")[0]||doucumnet.body,t.tableSearch(t.page).then((function(){t.contentLoading=!1})).catch((function(a){t.contentLoading=!1,console.log(a)}))}))},methods:{pageUpdate:function(t){this.page=t,this.tableSearch(this.page)},getSearchData:function(){var t={page:this.page,city_id:-1==this.searchData.cityId?"":this.searchData.cityId,title:this.searchData.title,employee_name:this.searchData.employeeName,order_id:this.searchData.orderId,customer_name:this.searchData.customerName,customer_mobile:this.searchData.customerMobile,complaint_time_start:this.searchData.complaintTime[0]?this.searchData.complaintTime[0]:"",complaint_time_end:this.searchData.complaintTime[1]?this.searchData.complaintTime[1]:"",handle_status:this.searchData.handleStatus,complaint_channel:""};return this.searchData.complaintChannel&&0!=this.searchData.complaintChannel.length&&(t.complaint_channel=this.searchData.complaintChannel.join(",")),t},tableSearch:function(t){var a=this;return(0,o.default)(regeneratorRuntime.mark((function t(){var e,i,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=a.getSearchData(),t.prev=1,t.next=4,n.default.getComplaintList(e);case 4:i=t.sent,0===(o=i.data).code&&(a.tableList=o.data?o.data.list:[],a.tableLabel=o.data?o.data.fields:[],a.dataSum=r.commonFun.matchFigure(o.data?o.data.total:0)?parseInt(o.data.total):0,a.showCreate=!!(o.data&&o.data.auth&&o.data.auth.create)&&o.data.auth.create,a.showExport=!!(o.data&&o.data.auth&&o.data.auth.export)&&o.data.auth.export),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})))()},resetSearch:function(){this.searchData={cityId:"",title:"",employeeName:"",orderId:"",customerName:"",customerMobile:"",complaintTime:"",complaintChannel:[],handleStatus:""},this.page=1,this.tableSearch(this.page)},getCityList:function(){var t=this;return(0,o.default)(regeneratorRuntime.mark((function a(){var e,i;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,(0,s.getCity)(1);case 2:e=a.sent,0===(i=e.data).code&&(t.cityList=i.data);case 5:case"end":return a.stop()}}),a)})))()},exportContent:function(){if(this.dataSum>3e3)return this.$message.error("超出导出数据的最大限制，不能导出哦！"),!1;if(0==this.dataSum)return this.$message.error("没有数据，不能导出！"),!1;try{var t=this.getSearchData();t.is_export=1;var a="/backend-api/complaint/list?";Object.keys(t).map((function(e,i){""!=t[e]&&null!=t[e]&&null!=t[e]&&(a+=0!==i?"&"+e+"="+t[e]:e+"="+t[e])})),window.location.href=a}catch(t){console.log(t)}},createComplain:function(){this.$router.push({path:"/performance/complain"})},changeComplain:function(t,a){var e=this;return(0,o.default)(regeneratorRuntime.mark((function i(){var o,s,r;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if("audit_auth"!==a.type&&"update_auth"!==a.type){i.next=8;break}return i.next=3,n.default.getComplaintDetail({id:t.id});case 3:o=i.sent,0==(s=o.data).code&&(e.showDialog=!0,e.dialogType=a.type,r=s.data,e.dialogData={tit:r.title,complaintTime:r.complaint_time,employeeName:r.employee_name,cnt:r.content,handleResult:r.handle_result,id:r.id},e.complainResult=r.handle_result),i.next=9;break;case 8:"mediaImg"===a.type&&(e.viewerUrlList=t,e.viewerStartsIndex=a.index,e.showViewer=!0,e.body.style.overflow="hidden");case 9:case"end":return i.stop()}}),i)})))()},updateComplaint:function(){var t=this;return(0,o.default)(regeneratorRuntime.mark((function a(){var e,i,o;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r.commonFun.trim(t.complainResult)&&""!==r.commonFun.trim(t.complainResult)){a.next=5;break}return t.dialogTips="处理结果不能为空！",a.abrupt("return",!1);case 5:if(!(r.commonFun.trim(t.complainResult).length>300)){a.next=8;break}return t.dialogTips="处理结果最多输入300个字！",a.abrupt("return",!1);case 8:return e={id:t.dialogData.id,handle_result:r.commonFun.trim(t.complainResult)},a.next=11,n.default.updateComplaint(e);case 11:i=a.sent,0==i.data.code&&(t.showDialog=!1,t.clearComplaintDialogData(),t.tableSearch(),o="审核成功","update_auth"===t.dialogType&&(o="修改成功"),t.$message(o),t.dialogType="");case 14:case"end":return a.stop()}}),a)})))()},clearComplaintDialogData:function(){this.showDialog=!1,this.dialogData={tit:"",complaintTime:"",employeeName:"",cnt:"",handleResult:"",id:""},this.complainResult=""},closeViewer:function(t){this.showViewer=t,this.body.style.overflow="auto"}},watch:{complainResult:function(t,a){this.dialogTips=""}}};a.default=c},"46ef":function(t,a,e){"use strict";e.r(a);var i=e("395c"),o=e.n(i);for(var n in i)["default"].indexOf(n)<0&&function(t){e.d(a,t,(function(){return i[t]}))}(n);a.default=o.a},"57e6":function(t,a,e){(a=e("24fb")(!1)).push([t.i,".content-main[data-v-7d39b9aa]{padding:0 15px}.form-table-box[data-v-7d39b9aa]{background-color:#fff}.form-table-box .filter-link-more[data-v-7d39b9aa]{float:right;padding:9px 20px;margin-top:6px}.form-table-box .order-search>.s-query>li .td[data-v-7d39b9aa]{min-height:40px}.order-search[data-v-7d39b9aa]{overflow:hidden}.order-search[data-v-7d39b9aa] .el-date-editor,.order-search[data-v-7d39b9aa] .el-select{width:100%;height:40px;-webkit-box-sizing:border-box;box-sizing:border-box}.order-search[data-v-7d39b9aa] .el-select .el-input{height:40px}.order-search[data-v-7d39b9aa] .el-select .el-input__inner{height:40px!important}.order-search[data-v-7d39b9aa] .el-range-input{background-color:#fff;font-size:12px;line-height:32px}.order-search[data-v-7d39b9aa] .el-date-editor .el-range-separator{font-size:12px}.order-search .fixHeight[data-v-7d39b9aa]{height:40px}.order-search[data-v-7d39b9aa] .el-date-editor .date-tip-logo{display:none}.order-search[data-v-7d39b9aa] .el-checkbox{font-weight:400}.order-search .s-query>li.margin-scale[data-v-7d39b9aa]{margin-bottom:0}.s-query>li.long-column[data-v-7d39b9aa]{width:360px}.s-query>li.margin-next[data-v-7d39b9aa]{margin-left:20px}.form-tip-box[data-v-7d39b9aa]{color:#999}.form-table-box .batch-btn-area[data-v-7d39b9aa]{text-align:right;position:absolute;right:0;top:0;z-index:10}.search-result[data-v-7d39b9aa]{position:relative}.batch-form-box[data-v-7d39b9aa] .el-form-item{margin-bottom:0}.box-relative[data-v-7d39b9aa]{position:relative}.box-absolute[data-v-7d39b9aa]{position:absolute}.el-row[data-v-7d39b9aa] .complain-dialog-wrap{font-size:14px}.el-row[data-v-7d39b9aa] .complain-dialog-wrap .complain-dialog-cnt p{font-size:14px;margin-bottom:8px}.el-row[data-v-7d39b9aa] .complain-dialog-wrap .complain-dialog-cnt .form-box{display:-webkit-box;display:-ms-flexbox;display:flex}.el-row[data-v-7d39b9aa] .complain-dialog-wrap .complain-dialog-cnt .form-box .box-left{-webkit-box-flex:0;-ms-flex:0 1 100px;flex:0 1 100px}.dialog-tips[data-v-7d39b9aa]{margin-top:10px;font-size:12px;color:#f56c6c}.has-padding[data-v-7d39b9aa]{padding-top:24px}.bd[data-v-7d39b9aa] .options-row-btn{text-decoration:none;color:#2e9ae1;cursor:pointer;width:100%}",""]),t.exports=a},"78c6":function(t,a,e){"use strict";e.r(a);var i=e("901a"),o=e("46ef");for(var n in o)["default"].indexOf(n)<0&&function(t){e.d(a,t,(function(){return o[t]}))}(n);e("a60b");var s=e("2877"),r=Object(s.a)(o.default,i.a,i.b,!1,null,"7d39b9aa",null);a.default=r.exports},"901a":function(t,a,e){"use strict";e.d(a,"a",(function(){return i})),e.d(a,"b",(function(){return o}));var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.contentLoading,expression:"contentLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"el-row"},[e("el-col",{staticClass:"content-main",attrs:{span:24}},[e("el-breadcrumb",{staticClass:"bread-crumb-box",attrs:{"separator-class":"el-icon-arrow-right"}},[e("el-breadcrumb-item",[e("a",{attrs:{href:"/"}},[t._v("首页")])]),e("el-breadcrumb-item",[t._v("投诉管理")])],1),e("div",{staticClass:"v-box form-table-box"},[e("div",{staticClass:"hd"},[e("h2",[t._v("投诉管理")])]),e("div",{staticClass:"bd"},[e("div",{staticClass:"order-search"},[e("ul",{staticClass:"s-query"},[e("li",[e("div",{staticClass:"th"},[t._v("城市：")]),e("div",{staticClass:"td"},[e("el-select",{attrs:{filterable:""},model:{value:t.searchData.cityId,callback:function(a){t.$set(t.searchData,"cityId",a)},expression:"searchData.cityId"}},t._l(t.cityList,(function(t){return e("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})})),1)],1)]),e("li",[e("div",{staticClass:"th"},[t._v("标题：")]),e("div",{staticClass:"td"},[e("el-input",{model:{value:t.searchData.title,callback:function(a){t.$set(t.searchData,"title",a)},expression:"searchData.title"}})],1)]),e("li",[e("div",{staticClass:"th"},[t._v("被举报员工：")]),e("div",{staticClass:"td"},[e("el-input",{model:{value:t.searchData.employeeName,callback:function(a){t.$set(t.searchData,"employeeName",a)},expression:"searchData.employeeName"}})],1)]),e("li",[e("div",{staticClass:"th"},[t._v("订单ID：")]),e("div",{staticClass:"td"},[e("el-input",{model:{value:t.searchData.orderId,callback:function(a){t.$set(t.searchData,"orderId",a)},expression:"searchData.orderId"}})],1)]),e("li",[e("div",{staticClass:"th"},[t._v("举报人姓名：")]),e("div",{staticClass:"td"},[e("el-input",{model:{value:t.searchData.customerName,callback:function(a){t.$set(t.searchData,"customerName",a)},expression:"searchData.customerName"}})],1)]),e("li",[e("div",{staticClass:"th"},[t._v("举报人联系方式：")]),e("div",{staticClass:"td"},[e("el-input",{model:{value:t.searchData.customerMobile,callback:function(a){t.$set(t.searchData,"customerMobile",a)},expression:"searchData.customerMobile"}})],1)]),e("li",[e("div",{staticClass:"th"},[t._v("问题发生时间：")]),e("div",{staticClass:"td"},[e("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd","range-separator":"至","prefix-icon":"date-tip-logo"},model:{value:t.searchData.complaintTime,callback:function(a){t.$set(t.searchData,"complaintTime",a)},expression:"searchData.complaintTime"}})],1)]),e("li",[e("div",{staticClass:"th"},[t._v("处理进度：")]),e("div",{staticClass:"td"},[e("el-select",{attrs:{filterable:""},model:{value:t.searchData.handleStatus,callback:function(a){t.$set(t.searchData,"handleStatus",a)},expression:"searchData.handleStatus"}},t._l(t.progress,(function(t){return e("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})})),1)],1)]),t.complainChannels.length>0?e("li",{staticClass:"auto margin-scale"},[e("div",{staticClass:"th"},[t._v("举报途径：")]),e("div",{staticClass:"td"},[e("el-checkbox-group",{model:{value:t.searchData.complaintChannel,callback:function(a){t.$set(t.searchData,"complaintChannel",a)},expression:"searchData.complaintChannel"}},t._l(t.complainChannels,(function(a,i){return e("el-checkbox",{key:"channel-"+i,attrs:{label:a.id}},[t._v(t._s(a.text))])})),1)],1)]):t._e()])]),e("div",{staticClass:"btn-area"},[e("el-button",{on:{click:t.resetSearch}},[t._v("重置")]),e("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.tableSearch(1)}}},[t._v("搜索")])],1)])]),e("div",{staticClass:"v-box form-table-box"},[e("div",{staticClass:"bd"},[e("div",{staticClass:"search-result box-relative",class:{"has-padding":0===t.tableList.length}},[e("div",{staticClass:"batch-btn-area"},[t.showExport?e("el-button",{attrs:{type:"primary"},on:{click:t.exportContent}},[t._v("导出")]):t._e(),t.showCreate?e("el-button",{attrs:{type:"primary"},on:{click:t.createComplain}},[t._v("新建")]):t._e()],1),e("jl-fixed-ordinary-table",{attrs:{tableData:t.tableList,paging:!0,limit:t.limit,totalCount:t.dataSum,tableLabel:t.tableLabel,fixedCol:!0,canCenter:"center",richTxts:t.richTxt},on:{pageUpdate:t.pageUpdate,callBackEvent:t.changeComplain}})],1)])])],1),e("el-dialog",{attrs:{title:"客户投诉处理",visible:t.showDialog,"custom-class":"complain-dialog-wrap",center:"","show-close":!1},on:{"update:visible":function(a){t.showDialog=a}}},[e("div",{staticClass:"complain-dialog-cnt"},[e("div",{staticClass:"form-box"},[e("div",{staticClass:"box-left"},[e("p",[t._v("投诉标题：")])]),e("div",{staticClass:"box-right"},[e("p",[t._v(t._s(t.dialogData.tit))])])]),e("div",{staticClass:"form-box"},[e("div",{staticClass:"box-left"},[e("p",[t._v("举报内容：")])]),e("div",{staticClass:"box-right"},[e("p",[t._v(t._s(t.dialogData.cnt))])])]),e("div",{staticClass:"form-box"},[e("div",{staticClass:"box-left"},[e("p",[t._v("被举报员工：")])]),e("div",{staticClass:"box-right"},[e("p",[t._v(t._s(t.dialogData.employeeName))])])]),e("div",{staticClass:"form-box"},[e("div",{staticClass:"box-left"},[e("p",[t._v("问题发生时间：")])]),e("div",{staticClass:"box-right"},[e("p",[t._v(t._s(t.dialogData.complaintTime))])])]),e("p",[t._v("请填写处理结果：")]),e("el-input",{attrs:{type:"textarea",maxlength:"300","show-word-limit":""},model:{value:t.complainResult,callback:function(a){t.complainResult=a},expression:"complainResult"}}),e("p",{staticClass:"dialog-tips"},[t._v(t._s(t.dialogTips))])],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(a){t.showDialog=!1}}},[t._v("取消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.updateComplaint}},[t._v("提交")])],1)]),t.showViewer?e("jl-image-preview",{attrs:{showViewer:t.showViewer,urlList:t.sortUrlList},on:{closeViewer:t.closeViewer}}):t._e()],1)},o=[]},a15b:function(t,a,e){"use strict";var i=e("23e7"),o=e("44ad"),n=e("fc6a"),s=e("a640"),r=[].join,l=o!=Object,c=s("join",",");i({target:"Array",proto:!0,forced:l||!c},{join:function(t){return r.call(n(this),void 0===t?",":t)}})},a60b:function(t,a,e){"use strict";e("24e3")},edfb:function(t,a,e){"use strict";e("4160"),e("159b"),Object.defineProperty(a,"__esModule",{value:!0}),a.DataConfig=a.COMPLAIN_CHANNELS_INCLUD_ONLINE=a.COMPLAIN_CHANNELS=a.COMPLAIN_PROGRESS=void 0;var i=[{id:1,text:"未处理"},{id:2,text:"已处理"}];a.COMPLAIN_PROGRESS=i;var o=[{id:1,text:"邮箱举报"},{id:2,text:"电话举报"},{id:3,text:"信涵举报"}];a.COMPLAIN_CHANNELS=o;var n=[{id:1,text:"邮箱举报"},{id:2,text:"电话举报"},{id:3,text:"信涵举报"},{id:4,text:"线上举报"}];a.COMPLAIN_CHANNELS_INCLUD_ONLINE=n;var s={COMPLAIN_PROGRESS:i,COMPLAIN_CHANNELS:o,COMPLAIN_CHANNELS_INCLUD_ONLINE:n,getConfig:function(){var t=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e={};return a.forEach((function(a){e[a.toUpperCase()]=t[a.toUpperCase()]?t[a.toUpperCase()]:[]})),e}};a.DataConfig=s},fc7f:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=e("23f7"),o={getPerformanceManageList:function(t){return i.axios.get("/backend-api/bk-api-adjust-risk/list",{params:t})},getRiskInitialize:function(){return i.axios.post("/backend-api/bk-api-adjust-risk/initialize")},getRiskInitDetail:function(t){return i.axios.post("/backend-api/bk-api-adjust-risk/detail",t)},getRiskAudit:function(t){return i.axios.post("/backend-api/bk-api-adjust-risk/audit",t)},getComplaintList:function(t){return i.axios.get("/backend-api/complaint/list",{params:t})},addComplaint:function(t){return i.axios.post("/backend-api/complaint/add-complaint",t)},getComplaintDetail:function(t){return i.axios.post("/backend-api/complaint/complaint-handling",t)},updateComplaint:function(t){return i.axios.post("/backend-api/complaint/update-complaint-handling",t)}};a.default=o}}]);