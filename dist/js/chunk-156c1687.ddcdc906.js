(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-156c1687"],{"09f0":function(e,t,o){"use strict";o("a4d3"),o("e01a"),o("d28b"),o("d3b7"),o("3ca3"),o("ddb0"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var o=[],a=!0,i=!1,l=void 0;try{for(var n,c=e[Symbol.iterator]();!(a=(n=c.next()).done)&&(o.push(n.value),!t||o.length!==t);a=!0);}catch(e){i=!0,l=e}finally{try{a||null==c.return||c.return()}finally{if(i)throw l}}return o}},"0d21":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(Array.isArray(e))return e}},"335d":function(e,t,o){"use strict";o.r(t);var a=o("802d"),i=o("e726");for(var l in i)["default"].indexOf(l)<0&&function(e){o.d(t,e,(function(){return i[e]}))}(l);o("95ba");var n=o("2877"),c=Object(n.a)(i.default,a.a,a.b,!1,null,"23a575f7",null);t.default=c.exports},"33ff":function(e,t,o){var a=o("4c29");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,o("499e").default)("d19ab4e4",a,!0,{sourceMap:!1,shadowMode:!1})},3835:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,a.default)(e)||(0,i.default)(e,t)||(0,l.default)(e,t)||(0,n.default)()};var a=c(o("0d21")),i=c(o("09f0")),l=c(o("06c5")),n=c(o("3d8c"));function c(e){return e&&e.__esModule?e:{default:e}}},"3d8c":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},"4c29":function(e,t,o){(t=o("24fb")(!1)).push([e.i,".dialog-wrap[data-v-23a575f7]{-webkit-box-sizing:border-box;box-sizing:border-box}.dialog-wrap .dialog-form[data-v-23a575f7]{text-align:center}.dialog-wrap .dialog-form .dialog-form-label[data-v-23a575f7]{color:#333;line-height:36px}.dialog-wrap .dialog-form[data-v-23a575f7] .el-input__inner{width:386px;height:36px}.dialog-wrap .counselor-msg-offline[data-v-23a575f7]{padding-left:40px}.dialog-wrap .counselor-msg-offline .counselor-msg-item[data-v-23a575f7]{color:#333;line-height:28px}.dialog-wrap .counselor-msg-offline .counselor-msg-item .span[data-v-23a575f7]{color:#666}.dialog-wrap .qrcode[data-v-23a575f7]{text-align:center;margin:30px auto 10px;width:218px;height:218px;background-color:#d8d8d8}.dialog-wrap .login-success[data-v-23a575f7]{-webkit-box-sizing:border-box;box-sizing:border-box;width:480px;height:220px;background-color:#f4f6f9;margin:38px auto;padding:40px 20px}.dialog-wrap .login-success .login-msg[data-v-23a575f7]{text-align:center}.dialog-wrap .login-success .login-msg .iconcode_success[data-v-23a575f7]{font-size:50px;color:#66d2b4;vertical-align:middle}.dialog-wrap .login-success .login-msg .msg-desc[data-v-23a575f7]{font-size:26px;color:#333;vertical-align:middle}.dialog-wrap .login-success .counselor-msg[data-v-23a575f7]{margin-top:38px}.dialog-wrap .login-success .counselor-msg .p[data-v-23a575f7]{color:#333;line-height:28px}.dialog-wrap .login-success .counselor-msg .p .span[data-v-23a575f7]{color:#666}.dialog-wrap .msg[data-v-23a575f7]{text-align:center;margin-top:8px}[data-v-23a575f7] .el-dialog__header .el-dialog__close{font-size:18px;font-weight:700;color:#222}.el-dialog__footer .cancle-btn[data-v-23a575f7]{width:230px;height:50px;font-size:20px}",""]),e.exports=t},"6b56":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.collocationConfAccess=t.collocationStatus=void 0;t.collocationStatus=[{value:1,text:"托管中"},{value:2,text:"未托管"},{value:3,text:"离线中"}];t.collocationConfAccess=["admin-sop","super_admin"]},7638:function(e,t,o){"use strict";var a=o("4ea4");o("4160"),o("a9e3"),o("159b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o("7a63"),l=o("6b56"),n=a(o("d044")),c="请将要托管的微信扫描上方二维码并在手机上确认登录 <br/> 一个二维码只能托管一个微信，请确认登录成功后关闭弹窗",s={name:"LoginDialog",props:{employeeId:{type:[Number,String],default:""},wxId:{type:[Number,String],default:""},entryType:{type:String,default:"1"},isVisible:{type:Boolean,default:!1}},data:function(){return{qrMessage:c,qrDisable:!1,qrcodeLoading:!1,loading:!1,fullscreenLoading:!1,selectorActive:!1,haveLoginSucess:!1,currentVisible:this.isVisible,counselorForm:{name:""},employeeInfo:{employeeId:this.employeeId,wxId:"",employeeName:"",trusteeshipStatus:""},codeUrl:"",counselors:[],token:"",showRoloadQr:!1,timestamp:""}},computed:{compVisile:{get:function(){return this.isVisible},set:function(e){this.currentVisible=e}},qrCodeShow:function(){return!this.haveLoginSucess},textMsgShow:function(){return!("3"!==this.entryType&&!this.haveLoginSucess)||this.showRoloadQr}},created:function(){window.addEventListener("beforeunload",this.logoutQrcode)},destroyed:function(){window.removeEventListener("beforeunload",this.logoutQrcode)},methods:{logoutQrcode:function(){this.token&&!this.haveLoginSucess&&(0,i.logoutWechat)({token:this.token})},getTextByValue:function(e){var t="";return l.collocationStatus.forEach((function(o){o.value===e&&(t=o.text)})),t},openThisDialog:function(){var e=this;"1"!==this.entryType?("2"===this.entryType&&(this.selectorActive=!0,this.haveLoginSucess=!0),"3"===this.entryType&&(this.haveLoginSucess=!1),(0,i.employeeLoginInfo)(this.employeeId,this.wxId).then((function(t){var o=t.data;0===o.code&&(e.employeeInfo=o.data,"2"===e.entryType&&(e.counselorForm.value=o.data.employeeName))})).catch((function(e){console.log(e)}))):this.haveLoginSucess=!1},getCounselor:function(e){var t=this;this.loading=!0,(0,i.getNotColloCounselor)(e).then((function(e){var o=e.data;0===o.code&&(t.counselors=o.data,t.loading=!1)})).catch((function(e){t.loading=!1,console.log(e)}))},counselorChange:function(e){this.selectorActive=!0,this.qrcodeLoading=!0,this.employeeInfo.employeeId=e,this.getQrcodeById(e)},getQrcodeById:function(e){var t=this;this.qrcodeLoading=!0,this.timestamp=(new Date).getTime(),(0,i.getWechatQrcode)(e,this.timestamp).then((function(o){var a=o.data;if(t.qrDisable=!1,t.qrcodeLoading=!1,t.selectorActive=!0,0===a.code){t.clearQrcode();var i=a.data.url;t.token=a.data.token,Number(a.data.time)===t.timestamp&&(t.qrcode=new n.default("qrcode",{text:i,width:218,height:218})),("1"!==t.entryType||t.haveLoginSucess)&&(t.selectorActive=!1),t.queryErrCount=0,t.getLoginStatusContinuely(e)}else 1002===a.code?(("1"!==t.entryType||t.haveLoginSucess)&&(t.selectorActive=!1),t.showRoloadQr=!0,t.$message.error(a.msg),"没有可用token"===a.msg&&(t.qrMessage="亲，当前可用的托管账号已经用完了，如果有托管需求请即时联系产品运营同学～")):t.$message.error(a.msg)})).catch((function(e){t.qrDisable=!1,t.qrcodeLoading=!1,console.log(e)}))},refreshQrcode:function(){var e=this;if(this.qrDisable=!0,this.clearQrcode(),this.haveLoginSucess)this.fullscreenLoading=!0,(0,i.logoutWechat)({employee_id:this.employeeInfo.employeeId}).then((function(t){0===t.data.code?(e.haveLoginSucess=!1,e.$emit("updateTable"),setTimeout((function(){e.fullscreenLoading=!1,e.getQrcodeById(e.employeeInfo.employeeId)}),3e3)):e.fullscreenLoading=!1})).catch((function(t){e.fullscreenLoading=!1,console.log(t)}));else{if(""!==this.token)return this.fullscreenLoading=!0,void this.clearToken(this.employeeInfo.employeeId);this.getQrcodeById(this.employeeInfo.employeeId)}},clearToken:function(e){var t=this;(0,i.logoutWechat)({token:this.token}).then((function(o){0===o.data.code?(t.token="",setTimeout((function(){t.fullscreenLoading=!1,t.getQrcodeById(e)}),3e3)):t.fullscreenLoading=!1})).catch((function(e){t.fullscreenLoading=!1,console.log(e)}))},getLoginStatusContinuely:function(e){var t=this;this.token&&setTimeout((function(){t.queryErrCount<10?(0,i.getLoginStatus)(e).then((function(o){var a=o.data;if(0===a.code){var i=a.data;t.employeeInfo.employeeName=i.employeeName,t.employeeInfo.wxId=i.wxId,t.employeeInfo.employeeId=e,t.clearQrcode(),t.token="",t.haveLoginSucess=!0,t.$emit("updateTable")}else 1002===a.code&&t.getLoginStatusContinuely(e)})).catch((function(o){t.queryErrCount++,t.getLoginStatusContinuely(e),console.log(o)})):t.$message({message:"获取登录状态失败，请稍后再试",type:"error"})}),2e3)},closeThisDialog:function(){var e=this;if(this.$emit("wxDialogClose",!1),this.timestamp="",this.selectorActive=!1,this.counselorForm.value="",this.clearQrcode(),this.qrcodeLoading=!1,!this.haveLoginSucess){if(""===this.token)return;(0,i.logoutWechat)({token:this.token}).then((function(t){0===t.data.code&&(e.token="")}))}this.qrMessage=c},clearQrcode:function(){this.qrcode&&this.qrcode.clear(),this.$refs.qrcode&&(this.$refs.qrcode.innerHTML="")}}};t.default=s},"7a63":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logoutWechat=t.handoverWechatById=t.setCollocationCount=t.getCollocationList=t.getNotColloCounselor=t.employeeLoginInfo=t.getLoginStatus=t.getWechatQrcode=t.getCity=void 0;var a=o("23f7");t.getCity=function(e){return a.axios.get(cityUrl,{params:{city_type:e}})};t.getWechatQrcode=function(e,t){return a.axios.post("/backend-api/wechat-trusteeship/wechat-login",{employee_id:e,time:t})};t.getLoginStatus=function(e){return a.axios.post("/backend-api/wechat-trusteeship/login-polling",{employee_id:e})};t.employeeLoginInfo=function(e,t){return a.axios.post("/backend-api/wechat-trusteeship/login-again",{employee_id:e,wx_id:t})};t.getNotColloCounselor=function(e){return a.axios.get("/backend-api/select2/select2/get-employee-for-wechat",{params:{q:e}})};t.getCollocationList=function(e){return a.axios.post("/backend-api/wechat-trusteeship/list",e)};t.setCollocationCount=function(e){return a.axios.post("/backend-api/wechat-trusteeship/config-num",{num:e})};t.handoverWechatById=function(e,t){return a.axios.post("/backend-api/wechat-trusteeship/handover",{id:e,employee_id:t})};t.logoutWechat=function(e){return a.axios.post("/backend-api/wechat-trusteeship/logout",e)}},"802d":function(e,t,o){"use strict";o.d(t,"a",(function(){return a})),o.d(t,"b",(function(){return i}));var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-dialog",{attrs:{title:"微信托管",visible:e.compVisile,width:"600px",center:""},on:{"update:visible":function(t){e.compVisile=t},open:e.openThisDialog,close:e.closeThisDialog}},[o("div",{staticClass:"dialog-wrap"},["3"!==e.entryType?o("div",{staticClass:"dialog-form"},[o("label",{staticClass:"dialog-form-label"},[e._v("离职咨询师：")]),o("el-select",{attrs:{filterable:"",remote:"",disabled:e.selectorActive,"remote-method":e.getCounselor,loading:e.loading,placeholder:"请输入要托管的离职咨询师的姓名"},on:{change:e.counselorChange},model:{value:e.counselorForm.value,callback:function(t){e.$set(e.counselorForm,"value",t)},expression:"counselorForm.value"}},e._l(e.counselors,(function(e){return o("el-option",{key:e.id,attrs:{label:e.text,value:e.id}})})),1)],1):e._e(),"3"===e.entryType?o("ul",{staticClass:"counselor-msg-offline"},[o("li",{staticClass:"counselor-msg-item"},[e._v(" 离职咨询师： "),o("span",{staticClass:"span"},[e._v(e._s(e.employeeInfo.employeeName))])]),o("li",{staticClass:"counselor-msg-item"},[e._v(" 托管状态为： "),o("span",{staticClass:"span"},[e._v(e._s(e.getTextByValue(e.employeeInfo.trusteeshipStatus)))])]),o("li",{staticClass:"counselor-msg-item"},[e._v(" 微 信 号： "),o("span",{staticClass:"span"},[e._v(e._s(e.employeeInfo.wxId))])])]):e._e(),e.qrCodeShow?o("div",{directives:[{name:"loading",rawName:"v-loading",value:e.qrcodeLoading,expression:"qrcodeLoading"}],ref:"qrcode",staticClass:"qrcode",attrs:{id:"qrcode"}}):o("div",{staticClass:"login-success"},[o("div",{staticClass:"login-msg"},[o("span",{staticClass:"iconfont iconcode_success"}),o("span",{staticClass:"msg-desc"},[e._v("已经登录成功!")])]),o("div",{staticClass:"counselor-msg"},[o("p",{staticClass:"p"},[e._v(" 离职咨询师： "),o("span",{staticClass:"span"},[e._v(e._s(e.employeeInfo.employeeName))])]),o("p",{staticClass:"p"},[e._v(" 微信号： "),o("span",{staticClass:"span"},[e._v(e._s(e.employeeInfo.wxId))])])])]),o("div",{staticClass:"msg"},[e.textMsgShow?o("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{type:"text",disabled:e.qrDisable},on:{click:e.refreshQrcode}},[e._v("刷新二维码重新登录")]):o("div",{staticClass:"msg-des",domProps:{innerHTML:e._s(e.qrMessage)}})],1)]),o("el-button",{staticClass:"cancle-btn",attrs:{slot:"footer"},on:{click:e.closeThisDialog},slot:"footer"},[e._v("取消")])],1)},i=[]},"95ba":function(e,t,o){"use strict";o("33ff")},c388:function(e,t,o){(t=o("24fb")(!1)).push([e.i,".collocation-wrap[data-v-1e99b46c]{width:100%;padding:0 30px;margin:0 auto;-webkit-box-sizing:border-box;box-sizing:border-box}.collocation-wrap .bread-nav[data-v-1e99b46c]{padding:20px 0}.collocation-wrap .el-dialog__wrapper[data-v-1e99b46c]{background-color:inherit}.collocation-wrap .collocation-form-wrap[data-v-1e99b46c]{background-color:#fff;padding:20px 0}.collocation-wrap .collocation-form-wrap .divider[data-v-1e99b46c]{width:98%;height:0;margin:24px auto;border-bottom:1px solid #dcdfe6}.collocation-wrap .collocation-form-wrap[data-v-1e99b46c] .el-form-item{margin-right:28px}.collocation-wrap .collocation-form-wrap[data-v-1e99b46c] .el-form-item.form-item-center{text-align:center;width:100%;margin-bottom:0}.collocation-wrap .collocation-form-wrap[data-v-1e99b46c] .el-form-item .el-form-item__label{color:#333;padding:0 8px 0 0}.collocation-wrap .collocation-form-wrap[data-v-1e99b46c] .el-form-item .el-input,.collocation-wrap .collocation-form-wrap[data-v-1e99b46c] .el-form-item .el-range-editor{width:320px;height:40px}.collocation-wrap .collocation-form-wrap[data-v-1e99b46c] .el-form-item .el-range-input{background-color:#fff}.collocation-wrap .collocation-form-wrap[data-v-1e99b46c] .el-form-item .el-button{width:96px;height:40px}.collocation-wrap .collocation-list[data-v-1e99b46c]{margin-bottom:20px}.collocation-wrap .collocation-list .collocation-list-topbar[data-v-1e99b46c]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;padding:0 20px;margin-top:20px;margin-bottom:19px}.collocation-wrap .collocation-list .collocation-list-topbar.flex-end[data-v-1e99b46c]{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.collocation-wrap .collocation-list .collocation-list-topbar .table-describe[data-v-1e99b46c]{color:#666}.collocation-wrap .collocation-list .collocation-list-topbar .table-describe .btn-add[data-v-1e99b46c]{margin-left:19px}.collocation-wrap .collocation-list .collocation-list-topbar .el-button.btn-right[data-v-1e99b46c]{width:128px;height:36px;padding:8px 15px;font-size:14px}.collocation-wrap .collocation-list .collocation-list-table[data-v-1e99b46c]{background-color:#fff;padding:21px}.collocation-wrap .collocation-list .collocation-list-table .split-ico[data-v-1e99b46c]{color:#ddd}.collocation-wrap .collocation-list .collocation-list-table .pages[data-v-1e99b46c]{margin:20px auto 0;text-align:center}.collocation-wrap .collocation-list .collocation-list-table[data-v-1e99b46c] .el-table th.gutter{display:table-cell!important}.collocation-wrap .w-dialog .content-wrap[data-v-1e99b46c]{text-align:center}.collocation-wrap .w-dialog .content-wrap[data-v-1e99b46c] .el-input{width:386px;height:36px}.collocation-wrap .w-dialog .content-wrap[data-v-1e99b46c] .el-input .el-input__inner{line-height:36px;height:36px}.collocation-wrap .w-dialog .dialog-footer .el-button[data-v-1e99b46c]{width:230px;height:50px}",""]),e.exports=t},c4bc:function(e,t,o){"use strict";o.r(t);var a=o("edc6"),i=o.n(a);for(var l in a)["default"].indexOf(l)<0&&function(e){o.d(t,e,(function(){return a[e]}))}(l);t.default=i.a},c8e8:function(e,t,o){"use strict";o.r(t);var a=o("f4b6"),i=o("c4bc");for(var l in i)["default"].indexOf(l)<0&&function(e){o.d(t,e,(function(){return i[e]}))}(l);o("cda7");var n=o("2877"),c=Object(n.a)(i.default,a.a,a.b,!1,null,"1e99b46c",null);t.default=c.exports},cda7:function(e,t,o){"use strict";o("cfcb")},cfcb:function(e,t,o){var a=o("c388");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,o("499e").default)("4861283f",a,!0,{sourceMap:!1,shadowMode:!1})},e726:function(e,t,o){"use strict";o.r(t);var a=o("7638"),i=o.n(a);for(var l in a)["default"].indexOf(l)<0&&function(e){o.d(t,e,(function(){return a[e]}))}(l);t.default=i.a},edc6:function(e,t,o){"use strict";var a=o("4ea4");o("caad"),o("a9e3"),o("2532"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(o("3835")),l=a(o("5530")),n=a(o("335d")),c=o("6b56"),s=o("f946"),r=o("7a63"),d=o("2f62"),u={name:"WeChatCollocationList",components:{LoginDialog:n.default},data:function(){return{entryType:"1",employeeId:"",wxId:"",loading:!1,fullscreenLoading:!1,wxDialogVisible:!1,labelPosition:"right",collocationForm:{city_id:"",employee_id:"",wechat:"",status:"",times:""},cityData:[],counselorData:[],statusData:c.collocationStatus,collocationDescriptions:{curTotal:0,curEnableNum:0,enableTotal:0},collocationTableData:[],pages:{currentPage:0,pageSize:20,pageCount:1},dialogConf:{handoverWechatVis:!1,handover:"",adjustConfVis:!1,collocationNum:""},handoverCounselors:[]}},computed:(0,l.default)({},(0,d.mapState)({uid:function(e){return e.uid},role:function(e){return c.collocationConfAccess.includes(e.role)}})),created:function(){this.getCollocationListInfo()},methods:{getCollocationListInfo:function(){var e=this,t={time_min:"",time_max:"",page:this.pages.currentPage,pageSize:this.pages.pageSize},o=this.collocationForm.times;if(Array.isArray(o)){var a=(0,i.default)(o,2);t.time_min=a[0],t.time_max=a[1]}Object.assign(t,this.collocationForm),delete t.times,(0,r.getCollocationList)(t).then((function(t){var o=t.data;if(0===o.code){var a=o.data;e.collocationTableData=a.data,e.collocationDescriptions.curTotal=a.tg_count,e.collocationDescriptions.curEnableNum=a.tg_config-a.tg_used,e.collocationDescriptions.enableTotal=a.tg_config}})).catch((function(e){console.log(e)}))},curPageChange:function(e){this.pages.currentPage=e-1,this.getCollocationListInfo()},setCityInfo:function(e){if(e){var t=this.getStorage("citys");if(t)t=JSON.parse(t),(new Date).getTime()-t.now>864e5||this.uid!==Number(t.uid)?this.getCityInfo():this.cityData=t.oData;else this.getCityInfo()}},getCityInfo:function(){var e=this;(0,s.getCity)().then((function(t){0===t.data.code&&(e.cityData=t.data.data,e.dataStorage("citys",t.data.data))})).catch((function(e){console.log(e)}))},dataStorage:function(e,t){if(t&&e){var o={now:(new Date).getTime(),uid:this.uid,oData:t},a=JSON.stringify(o);localStorage.setItem(e,a)}},getStorage:function(e){if(e)return localStorage.getItem(e)},getWorkCounselor:function(e){var t=this;this.loading=!0;var o={q:e,role:"header",status:10};(0,s.getEmployee)(o).then((function(e){var o=e.data;0===o.code&&(t.handoverCounselors=o.data,t.loading=!1)})).catch((function(e){t.loading=!1,console.log(e)}))},getleaveCounselor:function(e){var t=this;if(e){(0,s.getEmployee)({role:"header",status:0}).then((function(e){var o=e.data;0===o.code&&(t.counselorData=o.data)})).catch((function(e){console.log(e)}))}},resetForm:function(e){this.$refs[e].resetFields(),this.getCollocationListInfo()},setCellStyle:function(e){var t=e.row;e.column,e.rowIndex;if(6===e.columnIndex)return{color:{"托管中":"#36AE46","未托管":"#FF4958","离线中":"#BBBBBB"}[t.status]}},addWxCollocation:function(){this.entryType="1",this.employeeId="",this.wxDialogVisible=!0},wxDialogClose:function(e){this.wxDialogVisible=e},handoverWechat:function(e){this.dialogConf.handoverWechatVis=!0,this.tabItemId=e.id},commitHandover:function(){var e=this;if(this.dialogConf.handover){var t=this.dialogConf.handover,o=this.tabItemId;this.fullscreenLoading=!0,(0,r.handoverWechatById)(o,t).then((function(t){var o=t.data;e.fullscreenLoading=!1,e.dialogConf.handoverWechatVis=!1,0===o.code&&(e.$message({message:o.msg,type:"success"}),e.getCollocationListInfo())})).catch((function(t){e.fullscreenLoading=!1,console.log(t)}))}else this.$message({message:"交接人不可为空",type:"warning"})},commitConf:function(){var e=this,t=this.dialogConf.collocationNum;(0,r.setCollocationCount)(t).then((function(t){var o=t.data;0===o.code&&(e.$message({message:o.msg,type:"success"}),e.getCollocationListInfo(),e.dialogConf.adjustConfVis=!1)})).catch((function(e){console.log(e)}))},editCollocation:function(e){this.employeeId=e.employee_id,this.wxId=e.wechat_id,this.entryType="2",this.wxDialogVisible=!0},reLogin:function(e){this.employeeId=e.employee_id,this.wxId=e.wechat_id,this.entryType="3",this.wxDialogVisible=!0}}};t.default=u},f4b6:function(e,t,o){"use strict";o.d(t,"a",(function(){return a})),o.d(t,"b",(function(){return i}));var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"collocation-wrap"},[o("el-breadcrumb",{staticClass:"bread-nav",attrs:{"separator-class":"el-icon-arrow-right"}},[o("el-breadcrumb-item",[o("a",{attrs:{href:"/"}},[e._v("首页")])]),o("el-breadcrumb-item",[e._v("微信托管")])],1),o("div",{staticClass:"collocation-form-wrap"},[o("el-form",{ref:"collocationForm",staticClass:"collocation-form",attrs:{inline:!0,model:e.collocationForm,"label-position":e.labelPosition,"label-width":"96px"}},[o("el-form-item",{attrs:{prop:"city_id",label:"城市："}},[o("el-select",{attrs:{filterable:"",placeholder:"请选择城市"},on:{"visible-change":e.setCityInfo},model:{value:e.collocationForm.city_id,callback:function(t){e.$set(e.collocationForm,"city_id",t)},expression:"collocationForm.city_id"}},e._l(e.cityData,(function(e){return o("el-option",{key:e.id,attrs:{label:e.text,value:e.id}})})),1)],1),o("el-form-item",{attrs:{prop:"employee_id",label:"离职咨询师："}},[o("el-select",{attrs:{filterable:"",placeholder:"请输入离职咨询师关键字"},on:{"visible-change":e.getleaveCounselor},model:{value:e.collocationForm.employee_id,callback:function(t){e.$set(e.collocationForm,"employee_id",t)},expression:"collocationForm.employee_id"}},e._l(e.counselorData,(function(e){return o("el-option",{key:e.id,attrs:{label:e.text,value:e.id}})})),1)],1),o("el-form-item",{attrs:{prop:"wechat",label:"托管微信名："}},[o("el-input",{attrs:{placeholder:"请输入微信名"},model:{value:e.collocationForm.wechat,callback:function(t){e.$set(e.collocationForm,"wechat",t)},expression:"collocationForm.wechat"}})],1),o("el-form-item",{attrs:{prop:"status",label:"托管状态："}},[o("el-select",{attrs:{placeholder:"请选择"},model:{value:e.collocationForm.status,callback:function(t){e.$set(e.collocationForm,"status",t)},expression:"collocationForm.status"}},e._l(e.statusData,(function(e){return o("el-option",{key:e.value,attrs:{label:e.text,value:e.value}})})),1)],1),o("el-form-item",{attrs:{prop:"times",label:"托管时间："}},[o("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"请选择开始日期","end-placeholder":"请选择结束日期"},model:{value:e.collocationForm.times,callback:function(t){e.$set(e.collocationForm,"times",t)},expression:"collocationForm.times"}})],1),o("div",{staticClass:"divider"}),o("el-form-item",{staticClass:"form-item-center"},[o("el-button",{on:{click:function(t){return e.resetForm("collocationForm")}}},[e._v("重置")]),o("el-button",{attrs:{type:"primary"},on:{click:e.getCollocationListInfo}},[e._v("搜索")])],1)],1)],1),o("div",{staticClass:"collocation-list"},[o("div",{class:["collocation-list-topbar",e.role?"":"flex-end"]},[e.role?o("div",{staticClass:"table-describe"},[e._v(" 当前共 "+e._s(e.collocationDescriptions.curTotal)+" 个托管微信， "),e._v(" 当前可托管微信"+e._s(e.collocationDescriptions.curEnableNum)+"个，共可托管"+e._s(e.collocationDescriptions.enableTotal)+"个 "),o("el-button",{staticClass:"btn-add",attrs:{type:"text"},on:{click:function(t){e.dialogConf.adjustConfVis=!0}}},[e._v("新增配置")])],1):e._e(),o("el-button",{staticClass:"btn-right",attrs:{type:"success"},on:{click:e.addWxCollocation}},[e._v("+ 新增微信托管")])],1),o("div",{staticClass:"collocation-list-table"},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.collocationTableData,border:"","cell-style":e.setCellStyle}},[o("el-table-column",{attrs:{prop:"city_name",label:"城市",align:"center","min-width":"80"}}),o("el-table-column",{attrs:{prop:"employee_name",label:"离职咨询师",align:"center","min-width":"140"}}),o("el-table-column",{attrs:{prop:"employee_mobile",label:"咨询师手机",align:"center","min-width":"140"}}),o("el-table-column",{attrs:{prop:"wechat",label:"托管微信",align:"center","min-width":"160"}}),o("el-table-column",{attrs:{prop:"friend_number",label:"好友个数",align:"center","min-width":"80"}}),o("el-table-column",{attrs:{prop:"consult_number",label:"咨询人数",align:"center","min-width":"80"}}),o("el-table-column",{attrs:{prop:"status",label:"托管状态",align:"center","min-width":"100"}}),o("el-table-column",{attrs:{prop:"datetime",label:"托管日期",align:"center","min-width":"160"}}),o("el-table-column",{attrs:{prop:"handover",label:"交接人",align:"center","min-width":"160"}}),o("el-table-column",{attrs:{fixed:"right",align:"left",label:"操作","min-width":"180"},scopedSlots:e._u([{key:"default",fn:function(t){return"未托管"!==t.row.status?[o("el-button",{attrs:{type:"text",size:"medium"},on:{click:function(o){return e.handoverWechat(t.row)}}},[e._v("交接")]),o("span",{staticClass:"split-ico"},[e._v("|")]),"托管中"===t.row.status?o("el-button",{attrs:{type:"text",size:"medium"},on:{click:function(o){return e.editCollocation(t.row)}}},[e._v("编辑")]):e._e(),"离线中"===t.row.status?o("el-button",{attrs:{type:"text",size:"medium"},on:{click:function(o){return e.reLogin(t.row)}}},[e._v("重新登录")]):e._e()]:void 0}}],null,!0)})],1),o("el-pagination",{staticClass:"pages",attrs:{background:"","hide-on-single-page":!0,layout:"prev, pager, next","page-size":e.pages.pageSize,"page-count":e.pages.pageCount}})],1)]),o("el-dialog",{staticClass:"w-dialog",attrs:{title:"提示",visible:e.dialogConf.handoverWechatVis,width:"600px",center:""},on:{"update:visible":function(t){return e.$set(e.dialogConf,"handoverWechatVis",t)}}},[o("div",{staticClass:"content-wrap"},[o("label",{staticClass:"dialog-form-label"},[e._v("选择咨询师：")]),o("el-select",{attrs:{remote:"",filterable:"","remote-method":e.getWorkCounselor,loading:e.loading,placeholder:"选择咨询师"},model:{value:e.dialogConf.handover,callback:function(t){e.$set(e.dialogConf,"handover",t)},expression:"dialogConf.handover"}},e._l(e.handoverCounselors,(function(e){return o("el-option",{key:e.id,attrs:{label:e.text,value:e.id}})})),1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialogConf.handoverWechatVis=!1}}},[e._v("取 消")]),o("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{type:"primary"},on:{click:e.commitHandover}},[e._v("提交")])],1)]),o("el-dialog",{staticClass:"w-dialog",attrs:{title:"提示",visible:e.dialogConf.adjustConfVis,width:"600px",center:""},on:{"update:visible":function(t){return e.$set(e.dialogConf,"adjustConfVis",t)}}},[o("div",{staticClass:"content-wrap"},[o("label",{staticClass:"dialog-form-label"},[e._v("输入微信可托管数量：")]),o("el-input",{attrs:{placeholder:"输入微信可托管数量"},model:{value:e.dialogConf.collocationNum,callback:function(t){e.$set(e.dialogConf,"collocationNum",e._n(t))},expression:"dialogConf.collocationNum"}})],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialogConf.adjustConfVis=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:e.commitConf}},[e._v("提交")])],1)]),o("LoginDialog",{attrs:{entryType:e.entryType,isVisible:e.wxDialogVisible,employeeId:e.employeeId,wxId:e.wxId},on:{wxDialogClose:e.wxDialogClose,updateTable:e.getCollocationListInfo}})],1)},i=[]}}]);