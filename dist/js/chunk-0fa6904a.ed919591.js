(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0fa6904a"],{"0312":function(e,t,a){(t=a("24fb")(!1)).push([e.i,'.dialog-box .line[data-v-6266e5de]{position:relative;padding-left:14px;margin-bottom:10px}.dialog-box .line[data-v-6266e5de]:before{position:absolute;left:0;top:0;content:"";width:6px;height:24px;background-color:#4682b4}.dialog-box .s-query[data-v-6266e5de]{overflow:hidden}.dialog-box .s-query>li.w-auto[data-v-6266e5de]{width:auto}.dialog-box[data-v-6266e5de] .top-box h2{padding-bottom:10px;border-bottom:1px solid #edeff0}.dialog-box[data-v-6266e5de] .top-box .line{margin-bottom:0}.dialog-box[data-v-6266e5de] .top-box .el-dialog__header{padding-bottom:0}.dialog-box[data-v-6266e5de] .top-box .el-dialog__body{padding:0 20px;min-height:200px;max-height:500px;overflow:auto}.dialog-box[data-v-6266e5de] .top-box .btn-area{text-align:center}.dialog-box[data-v-6266e5de] .top-box .btn-area .cancel{color:#333;border:1px solid #333;margin-right:10px;cursor:pointer}.dialog-box[data-v-6266e5de] .top-box .btn-area .confirm{background:#337ab7;color:#fff;border:1px solid #337ab7;margin-left:10px;cursor:pointer}.dialog-box .list .item[data-v-6266e5de]{position:relative;min-height:174px;border-bottom:1px solid #ccc;padding:10px 0}.dialog-box .list .sort[data-v-6266e5de]{float:left;width:100px;text-align:center;color:#333;line-height:174px}.dialog-box .list .remove[data-v-6266e5de]{float:right;font-size:16px;color:#1662b3;cursor:pointer}.dialog-box .list .content[data-v-6266e5de]{overflow:hidden}.dialog-box .list .content .w-auto[data-v-6266e5de]{margin-right:20px;margin-bottom:0;line-height:34px}.dialog-box .list .content .all-width[data-v-6266e5de]{width:100%;margin-bottom:0}.dialog-box .list .content .th[data-v-6266e5de]{width:auto;height:34px;line-height:2}.dialog-box .list .content .td[data-v-6266e5de]{line-height:2}.dialog-box .list .content[data-v-6266e5de] .el-input{width:auto;height:34px}.dialog-box .list .content[data-v-6266e5de] .el-input .el-input__inner{height:34px;line-height:34px}.dialog-box .error-tip[data-v-6266e5de]{color:#f56c6c}',""]),e.exports=t},"078c":function(e,t,a){"use strict";a("38f6")},"0ed4":function(e,t,a){(t=a("24fb")(!1)).push([e.i,"[data-v-e025a4fe] .file .el-dialog__body{padding:0 20px 10px}[data-v-e025a4fe] .file .el-dialog__header{padding-bottom:0}[data-v-e025a4fe] .file .el-dialog__header>h2{border-bottom:1px solid #edeff0;height:46px;line-height:46px}.file .s-query[data-v-e025a4fe]{max-height:450px;overflow:auto}.file li[data-v-e025a4fe]{margin-bottom:0}.file .sub-li[data-v-e025a4fe]{overflow:hidden}.file .down-load a[data-v-e025a4fe]{color:#1662b3;margin-left:10px;text-decoration:underline}.file .item[data-v-e025a4fe]{overflow:hidden}.file .item .sub-item[data-v-e025a4fe]{float:left;margin-left:10px}",""]),e.exports=t},"0ed9":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a("23f7"),s={updateRejectData:function(e){return i.axios.post("/backend-api/expand/ex-bank-flow/finance-reject",e)},updateReleaseRecallData:function(e,t){return i.axios.post("/backend-api/expand/ex-bank-flow/release-recall",{id:e,list:t})}};t.default=s},"16e7":function(e,t,a){"use strict";a.r(t);var i=a("59bc"),s=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t.default=s.a},"17dc":function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"reject-wrap",attrs:{width:"600px",visible:e.dialogVisib,"before-close":e.beforeClose},on:{"update:visible":function(t){e.dialogVisib=t},closed:e.closed}},[a("h2",{staticClass:"line",attrs:{slot:"title"},slot:"title"},[e._v("驳回原因：")]),a("div",{staticClass:"reject-body"},[a("p",[e._v(e._s(e.refuseTitle))]),a("ul",{staticClass:"s-query"},[a("li",[a("div",{staticClass:"th required"},[e._v("驳回理由：")]),a("div",{staticClass:"td"},[a("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.refuseReason,expression:"refuseReason",modifiers:{trim:!0}}],staticClass:"textarea",attrs:{maxlength:"300",placeholder:"最多300字，不能为空"},domProps:{value:e.refuseReason},on:{input:function(t){t.target.composing||(e.refuseReason=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})])])])]),a("div",{staticClass:"btn-area reject-btn",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"btn close-reject",attrs:{disabled:!e.canClose},on:{click:function(t){e.dialogVisib=!1}}},[e._v("取消")]),a("el-button",{staticClass:"btn submit-reject",attrs:{disabled:""===e.refuseReason},on:{click:e.handleConfirm}},[e._v("确定")])],1)])},s=[]},"1df7":function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s}));var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-dialog",{staticClass:"voucher",attrs:{visible:e.is_voucher_dialog,width:"650px"},on:{"update:visible":function(t){e.is_voucher_dialog=t},closed:function(t){e.canSubmit=!0}}},[i("h2",{staticClass:"line",attrs:{slot:"title"},slot:"title"},[e._v("财务审核")]),i("div",{staticClass:"add_voucher"},[i("p",[e._v("当开票主体与付款公司名称不一致的时候，需要财务审核。")]),i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"file_img"},[i("div",{staticClass:"reason-warp"},[i("div",{staticClass:"label"},[e._v("填写原因：")]),i("div",{staticClass:"td"},[i("el-input",{attrs:{type:"textarea",placeholder:"最多只能输入300个字",maxlength:"300","show-word-limit":"",autosize:{minRows:2,maxRows:5}},model:{value:e.postData.reason,callback:function(t){e.$set(e.postData,"reason",t)},expression:"postData.reason"}}),i("span",{directives:[{name:"show",rawName:"v-show",value:e.textOverflowMsg,expression:"textOverflowMsg"}],staticClass:"warning-msg"},[e._v("最多只能输入300个字")])],1)]),i("div",{staticClass:"text"},[e._v("请上传代付款凭证：")]),i("ul",{staticClass:"voucher_content"},[e._l(e.postData.attach_list,(function(t,s){return i("li",{key:s},[i("div",{staticClass:"img"},[i("img",{attrs:{src:t.fileURL,alt:"凭证"}})]),i("img",{staticClass:"delete",attrs:{src:a("5385"),alt:""},on:{click:function(t){return e.deleteImg(s)}}})])})),e.postData.attach_list.length<5?i("li",[i("jl-file-upload",{ref:"upload",attrs:{fileMaxSize:"2mb",upID:"Imgupload",isMulti:!0,limit:5-e.postData.attach_list.length,ossData:e.ossData},on:{getFileURL:e.getFileURL}},[i("div",{staticClass:"img"},[i("i",{staticClass:"el-icon-plus add_img",attrs:{"aria-hidden":"true"}})])])],1):e._e()],2)])]),i("div",{staticClass:"btn-area",attrs:{slot:"footer"},slot:"footer"},[i("button",{staticClass:"btn cancel",on:{click:function(t){e.is_voucher_dialog=!1}}},[e._v("取消")]),i("el-button",{staticClass:"btn confirm",on:{click:e.upload}},[e._v("确定")])],1)]),i("el-dialog",{staticClass:"reject",attrs:{width:"450px",visible:e.checkDialog,"show-close":!1},on:{"update:visible":function(t){e.checkDialog=t}}},[i("h2",{staticClass:"line",attrs:{slot:"title"},slot:"title"},[e._v("核销提示")]),i("div",{staticClass:"reject-body"},[e._v(e._s(e.checkMsg))]),i("div",{staticClass:"btn-area reject-btn",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{staticClass:"btn close-reject",on:{click:function(t){e.checkDialog=!1}}},[e._v("取消")]),i("el-button",{staticClass:"btn submit-reject",on:{click:e.goNewPage}},[e._v("前往更改流水信息")])],1)])],1)},s=[]},"256e":function(e,t,a){"use strict";a.r(t);var i=a("ac2a"),s=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t.default=s.a},"269b":function(e,t,a){"use strict";var i=a("4ea4");a("99af"),a("4160"),a("d3b7"),a("25f0"),a("159b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("96cf");var s=i(a("1da1")),n=i(a("6a7a")),o=i(a("0ed9")),l={name:"FinanceTable",components:{RejectDialog:n.default},data:function(){return{flowId:"",allPass:!1,allReject:!1,refuseDialog:!1,refuseTitle:"",refuseType:"",index:"",closeModal:!0,canAllPass:!0,callAllReject:!0}},model:{prop:"financeData",event:"input"},props:{financeData:{type:Object,default:function(){return{}}},batchIds:{type:String,default:""}},methods:{handlePass:function(e,t){var a=this,i=0,s=0;if(this.allPass=!0,this.allReject=!0,"1"===e){var n=[{business_type:t.business_type,id:t.business_id,deal_id:t.deal_id,verify_status:t.verify_status}],o={id:this.flowId,list:n};t.passDisable=!0,t.rejectDisable=!0,i++,this.axios.post("/backend-api/expand/ex-bank-flow/finance-pass",o).then((function(e){s++,i===s&&(a.allPass=!1,a.allReject=!1),t.passDisable=!1,t.rejectDisable=!1,0===e.data.code?(a.$set(t,"checkPass",!0),"1"===t.verify_status.toString()?(a.$set(t,"verify_status","2"),a.$set(t,"verify_status_text","审核通过")):"6"===t.verify_status.toString()&&(a.$set(t,"verify_status","5"),a.$set(t,"verify_status_text","释放通过")),a.$emit("check-success")):alert(e.data.msg)})).catch((function(e){console.log(e)}))}else if("2"===e)if(this.handleMultiOpt(),this.canAllPass){var l=[];this.financeData.data.forEach((function(e){if("1"===e.verify_status.toString()||"6"===e.verify_status.toString()){e.passDisable=!0,e.rejectDisable=!0;var t={business_type:e.business_type,id:e.business_id,deal_id:e.deal_id,verify_status:e.verify_status};l.push(t)}}));var r={id:this.flowId,list:l};this.axios.post("/backend-api/expand/ex-bank-flow/finance-pass",r).then((function(e){a.allPass=!1,a.allReject=!1,a.financeData.data.forEach((function(e){"1"!==e.verify_status.toString()&&"6"!==e.verify_status.toString()||(e.passDisable=!1,e.rejectDisable=!1)})),0===e.data.code?(a.financeData.data.forEach((function(e){"1"===e.verify_status.toString()?(a.$set(e,"checkPass",!0),a.$set(e,"verify_status","2"),a.$set(e,"verify_status_text","审核通过")):"6"===e.verify_status.toString()&&(a.$set(e,"checkPass",!0),a.$set(e,"verify_status","5"),a.$set(e,"verify_status_text","释放通过"))})),a.$emit("check-success")):alert(e.data.msg)})).catch((function(e){console.log(e)}))}else this.$message({message:"当前无待审核的核销记录",duration:2e3,type:"warning",onClose:function(){a.allPass=!1,a.allReject=!1}})},createdRejectTitle:function(e){return"2"===e.business_type.toString()?"您确定要对成交单ID：".concat(e.deal_id,"的\n                    核销记录（核销ID：").concat(e.show_number,"；实际回款金额：").concat(e.actual_money,"元） 操作释放金额吗？\n                    若释放金额，请您填写释放原因。"):""===e.num?"您确定要对成交单ID：".concat(e.deal_id,"的\n                        核销记录（核销ID：").concat(e.show_number,"；实际回款金额：").concat(e.actual_money,"元） 操作审核驳回吗？\n                        若想驳回申请，请您填写驳回理由。"):"您确定要对成交单ID：".concat(e.deal_id,"的第").concat(e.num,"笔\n                        合同预测的核销记录（核销ID：").concat(e.show_number,"；实际回款金额：").concat(e.actual_money,"元） 操作审核驳回吗？\n                        若想驳回申请，请您填写驳回理由。")},handleReject:function(e,t){var a=this;if(this.refuseType=e,this.index=t,"1"===e){this.refuseDialog=!0;var i=this.financeData.data[t];this.refuseTitle=this.createdRejectTitle(i)}else"2"===e&&(this.handleMultiOpt(),this.callAllReject?(this.refuseDialog=!0,this.refuseTitle="您确定要将当前页面页面审核状态为‘等待审核’、‘审核通过’、’释放审核’、’释放审核通过’的申请全部操作驳回吗？如果想驳回申请，请填写驳回理由！"):(this.refuseDialog=!1,this.allReject=!0,this.allPass=!0,this.$message({message:"当前无可驳回的核销记录",duration:2e3,type:"warning",onClose:function(){a.allReject=!1,a.allPass=!1}})))},seeProof:function(){var e=this.$router.resolve({path:"/payment/showVoucher",query:{flowId:this.flowId,batchId:this.batchIds}});window.open(e.href,"_blank")},seeFile:function(){this.$emit("see-file")},singleReject:function(e,t){var a=this;return(0,s.default)(regeneratorRuntime.mark((function i(){var s,n,l,r;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,o.default.updateRejectData(t);case 3:if(s=i.sent,n=s.data,l=n.code,r=n.msg,a.closeModal=!0,0!==l){i.next=17;break}return a.$set(e,"checkPass",!0),a.$set(e,"checkReject",!0),"1"===e.verify_status.toString()?(a.$set(e,"verify_status","4"),a.$set(e,"verify_status_text","审核驳回")):"6"===e.verify_status.toString()&&(a.$set(e,"verify_status","7"),a.$set(e,"verify_status_text","释放驳回")),a.refuseDialog=!1,a.$emit("check-success"),i.abrupt("return",Promise.resolve(!0));case 17:return a.$message(r),i.abrupt("return",Promise.reject(r));case 19:i.next=25;break;case 21:return i.prev=21,i.t0=i.catch(0),console.log(i.t0),i.abrupt("return",Promise.reject(i.t0));case 25:case"end":return i.stop()}}),i,null,[[0,21]])})))()},submitRefuse:function(e){var t=this;if(this.closeModal=!1,"1"===this.refuseType){var a=this.financeData.data[this.index],i=[{business_type:a.business_type,id:a.business_id,deal_id:a.deal_id,verify_status:a.verify_status}],s={id:this.flowId,list:i,reason:e};this.singleReject(a,s)}else if("2"===this.refuseType){var n=[];this.financeData.data.forEach((function(e){if("4"!==e.verify_status.toString()&&"7"!==e.verify_status.toString()){var t={business_type:e.business_type,id:e.business_id,deal_id:e.deal_id,verify_status:e.verify_status};n.push(t)}}));var o={id:this.flowId,list:n,reason:e};if(0===o.list.length)return;this.axios.post("/backend-api/expand/ex-bank-flow/finance-reject",o).then((function(e){t.closeModal=!0,0===e.data.code?(t.financeData.data.forEach((function(e){"1"===e.verify_status.toString()||"2"===e.verify_status.toString()?(t.$set(e,"checkPass",!0),t.$set(e,"checkReject",!0),t.$set(e,"verify_status","4"),t.$set(e,"verify_status_text","审核驳回")):"6"!==e.verify_status.toString()&&"5"!==e.verify_status.toString()||(t.$set(e,"checkPass",!0),t.$set(e,"checkReject",!0),t.$set(e,"verify_status","7"),t.$set(e,"verify_status_text","释放驳回"))})),t.refuseDialog=!1,t.$emit("check-success")):alert(e.data.msg)})).catch((function(e){console.log(e)}))}},handleMultiOpt:function(){var e=[],t=[],a=[],i=[];this.financeData.data.forEach((function(s){"1"===s.verify_status.toString()?e.push(s):"6"===s.verify_status.toString()?a.push(s):"2"===s.verify_status.toString()?t.push(s):"5"===s.verify_status.toString()&&i.push(s)})),0===e.length&&0===a.length?this.canAllPass=!1:this.canAllPass=!0,e.length||a.length||t.length||i.length?this.callAllReject=!0:this.callAllReject=!1}},created:function(){this.flowId=this.$route.query.flowId}};t.default=l},"31a8":function(e,t,a){"use strict";a.r(t);var i=a("517b"),s=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t.default=s.a},"38f6":function(e,t,a){var i=a("0312");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,a("499e").default)("2a994d29",i,!0,{sourceMap:!1,shadowMode:!1})},"3a2e":function(e,t,a){"use strict";a.r(t);var i=a("fdff"),s=a("f58f");for(var n in s)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return s[e]}))}(n);a("946c");var o=a("2877"),l=Object(o.a)(s.default,i.a,i.b,!1,null,"07283bf4",null);t.default=l.exports},"3efd":function(e,t,a){"use strict";a("46df")},"3f5f":function(e,t,a){var i=a("7ad0");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,a("499e").default)("1bab6b2c",i,!0,{sourceMap:!1,shadowMode:!1})},"400f":function(e,t,a){"use strict";a.r(t);var i=a("1df7"),s=a("f42e");for(var n in s)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return s[e]}))}(n);a("49f8");var o=a("2877"),l=Object(o.a)(s.default,i.a,i.b,!1,null,"798b06b7",null);t.default=l.exports},"46df":function(e,t,a){var i=a("0ed4");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,a("499e").default)("5141a788",i,!0,{sourceMap:!1,shadowMode:!1})},4809:function(e,t,a){"use strict";a("3f5f")},"48ba":function(e,t,a){"use strict";a.r(t);var i=a("85c4"),s=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t.default=s.a},"49f8":function(e,t,a){"use strict";a("890a")},"4b0f":function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wait-check"},[a("div",{staticClass:"v-box"},[e._m(0),a("div",{staticClass:"bd"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{resizable:!1,align:"center",width:"150px",prop:"bank_name",label:"银行名称"}}),a("el-table-column",{attrs:{resizable:!1,align:"center",width:"150px",prop:"bank_flow_number",label:"银行流水"}}),a("el-table-column",{attrs:{resizable:!1,align:"center",width:"150px",prop:"payment_account",label:"付款账户"}}),a("el-table-column",{attrs:{resizable:!1,align:"center",width:"150px",prop:"payment_company",label:"付款公司"}}),a("el-table-column",{attrs:{resizable:!1,align:"center",width:"150px",prop:"gathering_company_account",label:"公司账户"}}),a("el-table-column",{attrs:{resizable:!1,align:"center",width:"220px",prop:"gathering_company_name",label:"公司名称"}}),a("el-table-column",{attrs:{resizable:!1,align:"center",prop:"arrival_time",width:"200px",label:"到账时间"}}),a("el-table-column",{attrs:{resizable:!1,align:"center",width:"150px",label:"到账金额"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("currency")(t.row.arrival_money))+" ")]}}])}),a("el-table-column",{attrs:{resizable:!1,align:"center",width:"150px",label:"退款金额"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("currency")(t.row.refund_money))+" ")]}}])}),a("el-table-column",{attrs:{resizable:!1,align:"center",width:"150px",label:"已核销金额"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("currency")(t.row.verified_money))+" ")]}}])}),a("el-table-column",{attrs:{resizable:!1,align:"center",width:"150px",label:"待核销金额"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("currency")(t.row.unverified_money))+" ")]}}])}),a("el-table-column",{attrs:{resizable:!1,align:"center",width:"150px",label:"差额入库"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("currency")(t.row.margin_money))+" ")]}}])})],1)],1)])])},s=[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"hd"},[t("h2",{staticClass:"line"},[this._v("待核销的回款信息")])])}]},"517b":function(e,t,a){"use strict";var i=a("4ea4");a("99af"),a("7db0"),a("4160"),a("a15b"),a("a434"),a("b0c0"),a("d3b7"),a("25f0"),a("159b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i(a("2909"));a("96cf");var n=i(a("1da1")),o=i(a("0ed9")),l=i(a("6a7a")),r=i(a("983b")),c=i(a("894f")),d=i(a("400f")),u=i(a("3a2e")),h=i(a("e3f3")),f=a("f946"),p={name:"writeoff-payment",data:function(){return{rejectDialogShow:!1,rejectTitle:"",closeModal:!0,flowId:"",defaultCity:"",isCanChoose:!1,waitCheckData:[],isFinanceRole:!1,financeData:{data:[],showFile:!1},form:{city:"",dealId:"",name:"",building:"",netTime:"",draftTime:"",buyTime:"",rankTime:"",people:""},dataOption:{city:[],buildings:[],people:[]},listData:[],page:1,totalPage:0,isShowOption:!1,isShowHead:!0,topTable:[],isShowTip:!1,showTopDialog:!1,dialogData:[],titleMsg:"添加回款信息",editTag:"",checkDetailData:[],unCheckDetailData:[],checkHeader:[{prop:"city_name",width:"80",label:"城市"},{prop:"deal_id",label:"成交id"},{prop:"project_name",width:"150",label:"楼盘名称"},{prop:"username",label:"客户名称"},{prop:"partner_contract_name",width:"200",label:"合同主体"},{prop:"content",width:"200",label:"合同预测阶段"},{prop:"arrival_time",width:"160",label:"实际回款日期"},{prop:"actual_money",label:"实际回款金额"},{prop:"verify_status_text",label:"财务审核状态"}],isShowCheck:!1,isShowHistory:!1,historyHeader:[{prop:"show_number",label:"核销编号",width:"100"},{prop:"city_name",width:"80",label:"城市"},{prop:"deal_id",label:"成交id"},{prop:"project_name",width:"150",label:"楼盘名称"},{prop:"username",label:"客户名称"},{prop:"partner_contract_name",width:"200",label:"合同主体"},{prop:"pre_paid_content",width:"200",label:"合同预测阶段"},{prop:"actual_datetime",width:"160",label:"实际回款日期"},{prop:"actual_money",label:"实际回款金额"},{prop:"verify_status_text",label:"财务审核状态"}],historyUncheck:[],backUrl:"",historyCheck:[],isFreeAll:!1,isShowDiff:"",isRevertAll:!1,isShowFile:!1,isShowProof:!1,showReleaseRevoll:!1,flag:!0,rejectReason:!1,reasonStr:"",fileDialog:!1,releaseDialog:!1,release:{title:"",reason:"",files:[]},releaseType:"",releaseIndex:"",aliyunArr:[],showLoading:!1,fileList:[],host:"",checkDialog:!1,checkMsg:"",checkUrl:"",batchIds:"",ossData:{}}},methods:{getSignCode:function(){var e=this;return(0,n.default)(regeneratorRuntime.mark((function t(){var a,i,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={cate:"uploadVoucher"},t.prev=1,t.next=4,(0,f.getSign)(a);case 4:i=t.sent,0===(s=i.data).code&&(e.ossData=s.data),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})))()},recall:function(e,t){"2"!==t?"6"===e.verify_status?this.confirmRecall(e):"1"===e.verify_status&&this.revertSub("1",e):this.batchRecall()},confirmRecall:function(e){var t=this;this.$confirm("您确定要撤回核销编号：".concat(e.show_number," 的审核申请吗？"),"提示",{}).then((function(){var a=[{business_type:e.business_type,id:e.business_id,deal_id:e.deal_id,verify_status:e.verify_status}];t.releaseRecall(t.flowId,a)}))},batchRecall:function(){var e=this;this.$confirm("您确定要批量撤回审核申请吗？","提示",{}).then((function(){var t=[];e.historyCheck.forEach((function(e){var a={business_type:e.business_type,id:e.business_id,deal_id:e.deal_id,verify_status:e.verify_status};e.show_release_revoke&&t.push(a)})),e.releaseRecall(e.flowId,t)}))},releaseRecall:function(e,t){var a=this;return(0,n.default)(regeneratorRuntime.mark((function i(){var s,n,l,r;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,o.default.updateReleaseRecallData(e,t);case 3:s=i.sent,n=s.data,l=n.code,r=n.msg,0===l?(a.getWaitData(),a.getHistory()):a.$message(r),i.next=13;break;case 10:i.prev=10,i.t0=i.catch(0),console.log(i.t0);case 13:case"end":return i.stop()}}),i,null,[[0,10]])})))()},submitRefuse:function(e){var t=this;this.closeModal=!1;var a=this.historyUncheck[this.index],i=[{business_type:a.business_type,id:a.business_id,deal_id:a.deal_id,verify_status:a.verify_status}],s={id:this.flowId,list:i,reason:e};this.$refs.financeTable.singleReject(a,s).then((function(e){!0===e?(t.rejectDialogShow=!1,t.getHistory(),t.getWaitData()):t.$message(e)}))},handleReject:function(e){this.index=e;var t=this.historyUncheck[e];this.rejectTitle=this.$refs.financeTable.createdRejectTitle(t),this.rejectDialogShow=!0},getWaitData:function(e){var t=this,a={flow_id:this.flowId};this.axios.get("/backend-api/expand/ex-bank-flow/get-flow-info",{params:a}).then((function(a){0===a.data.code&&(t.waitCheckData=a.data.data.info,t.isFinanceRole=a.data.data.is_finance_role,e&&e(t.isFinanceRole))})).catch((function(e){console.log(e)}))},getHistory:function(){var e=this,t={flow_id:this.flowId};this.axios.get("/backend-api/expand/ex-bank-flow/get-history-payment",{params:t}).then((function(t){0===t.data.code&&(e.historyUncheck=t.data.data.not_audit_data,e.historyCheck=t.data.data.need_audit_data,e.backUrl=t.data.data.back_fee_url,e.isFreeAll=t.data.data.show_batch_free,e.isShowDiff=t.data.data.show_diff_money.toString(),e.isRevertAll=t.data.data.show_batch_revoke,e.isShowProof=t.data.data.show_see_vouch,e.isShowFile=t.data.data.show_see_attach,e.showReleaseRevoll=t.data.data.show_batch_release_revoke,e.batchIds=t.data.data.batch_id,e.historyUncheck.forEach((function(t){e.handleStatus(t)})),e.historyCheck.forEach((function(t){e.handleStatus(t)}))),e.isFinanceRole?e.historyUncheck.length>0?e.isShowHistory=!0:e.isShowHistory=!1:e.historyUncheck.length>0||e.historyCheck.length>0?e.isShowHistory=!0:e.isShowHistory=!1})).catch((function(e){console.log(e)}))},handleStatus:function(e){switch(e.verify_status.toString()){case"0":this.$set(e,"verify_status_text","等待提交");break;case"1":this.$set(e,"verify_status_text","等待审核");break;case"2":this.$set(e,"verify_status_text","审核通过");break;case"3":this.$set(e,"verify_status_text","无需审核");break;case"4":this.$set(e,"verify_status_text","审核驳回");break;case"5":this.$set(e,"verify_status_text","释放通过");break;case"6":this.$set(e,"verify_status_text","释放审批");break;case"7":this.$set(e,"verify_status_text","释放驳回");break;case"9":this.$set(e,"verify_status_text","已退款")}},getCity:function(){return this.axios.get("/backend-api/select2/bank/get-city-dropdown-list",{params:{type:"2"}})},getRemoteBuild:function(e){var t=this,a={city_id:this.form.city,q:e};this.axios.get("/backend-api/common/get-project-list",{params:a}).then((function(e){0===e.data.code&&(t.dataOption.buildings=e.data.data)})).catch((function(e){console.log(e)}))},getRemotePeople:function(e){var t=this,a={q:e};this.axios.get("/backend-api/employee/get-employee-dropdown-list",{params:a}).then((function(e){0===e.data.code&&(t.dataOption.people=e.data.data)})).catch((function(e){console.log(e)}))},searchData:function(){this.page=1,this.getListData()},resetSearch:function(){if("-2"===this.defaultCity)for(var e in this.form)this.form[e]="";else for(var t in this.form)"city"!==t&&(this.form[t]="");this.page=1,this.getListData()},getListData:function(e){var t=this;return(0,n.default)(regeneratorRuntime.mark((function a(){var i,n,o,l;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(i=[],"init"!==e){a.next=7;break}return a.next=4,t.getCity();case 4:n=a.sent,0===(o=n.data).code&&(i=o.data);case 7:l={page:t.page,flow_id:t.flowId,deal_id:t.form.dealId,username:t.form.name,project_id:t.form.building,sign_start_datetime:t.form.netTime?t.form.netTime[0]:"",sign_end_datetime:t.form.netTime?t.form.netTime[1]:"",grass_start_datetime:t.form.draftTime?t.form.draftTime[0]:"",grass_end_datetime:t.form.draftTime?t.form.draftTime[1]:"",subscribe_start_datetime:t.form.buyTime?t.form.buyTime[0]:"",subscribe_end_datetime:t.form.buyTime?t.form.buyTime[1]:"",paihao_start_datetime:t.form.rankTime?t.form.rankTime[0]:"",paihao_end_datetime:t.form.rankTime?t.form.rankTime[1]:"",payback_employee_id:t.form.people},t.isCanChoose&&(l.city_id=t.form.city),t.axios.post("/backend-api/expand/ex-bank-flow/get-payment-list",l).then((function(a){if(0===a.data.code){if(t.isShowOption=a.data.data.show_add_btn,t.totalPage=a.data.data.total_page-0,"init"===e)if(t.defaultCity=a.data.data.city_id.toString(),"-2"===t.defaultCity)t.isCanChoose=!0,t.form.city="",t.dataOption.city=i;else if(t.form.city=t.defaultCity,"-1"===t.defaultCity)t.isCanChoose=!0,t.dataOption.city=i;else{t.isCanChoose=!1;for(var n=0;n<i.length;n++)if(t.defaultCity===i[n].id){var o={id:i[n].id,text:i[n].text};t.dataOption.city.push(o);break}}var l=a.data.data.grid_data;if(0!==t.topTable.length||0!==t.checkDetailData.length||0!==t.unCheckDetailData.length)[].concat((0,s.default)(t.topTable),(0,s.default)(t.checkDetailData),(0,s.default)(t.unCheckDetailData)).forEach((function(e,t){l.forEach((function(t,a){e.deal_id===t.deal_id&&e.business_id===t.business_id&&l.splice(a,1)}))}));l.forEach((function(e,a){e.check=!1,e.payback_employee=e.payback_employee.join(","),t.handleType(e)})),t.listData=l}})).catch((function(e){console.log(e)}));case 10:case"end":return a.stop()}}),a)})))()},handleType:function(e){switch(e.commission_type.toString()){case"1":this.$set(e,"commission_type_text","前置电商");break;case"2":this.$set(e,"commission_type_text","后置返费");break;case"3":this.$set(e,"commission_type_text","成交奖");break;case"4":this.$set(e,"commission_type_text","合同外收入")}},handleTop:function(e,t,a){var i=this;"1"!==e||this.isShowTip?"2"===e&&(a.check=!1,this.topTable.splice(t,1)):this.topTable.length>5||5===this.topTable.length?(this.isShowTip=!0,this.$message({message:"最多只能固定5条数据哦，请先点击‘操作’，填写‘实际回款’后，可以在继续选中数据行。",type:"warning",onClose:function(){i.listData[t].check=!1,i.isShowTip=!1}})):(this.listData[t].check=!0,this.listData.splice(t,1),this.topTable.push(a))},nextPage:function(){this.page++,this.page>this.totalPage&&(this.page=this.totalPage),this.getListData()},prevPage:function(){this.page--,this.page<=0&&(this.page=1),this.getListData()},handleTopDialog:function(){var e=this;0===this.topTable.length&&this.$message({message:"请先选择置顶数据后，才能进行操作哦！",type:"warning"}),this.topTable.length<=5&&0!==this.topTable.length&&(this.topTable.forEach((function(t){e.$set(t,"iptVal",t.unverified_money),e.$set(t,"showTip",!1),e.$set(t,"rangeTip",!1)})),this.editTag="",this.dialogData=this.topTable,this.showTopDialog=!0)},closeTopDia:function(e){var t=this;this.showTopDialog=e,setTimeout((function(){t.editTag=""}),200)},subTopDia:function(e,t,a,i){var s=this;this.showTopDialog=e,"edit"!==i?(a.need_audit.forEach((function(e){e.check=!1,s.handleStatus(e),s.checkDetailData.push(e)})),a.not_audit.forEach((function(e){e.check=!1,s.handleStatus(e),s.unCheckDetailData.push(e)}))):(this.checkDetailData.forEach((function(e,t){e.business_id===a.need_audit[0].business_id&&e.deal_id===a.need_audit[0].deal_id&&s.$set(s.checkDetailData,t,a.need_audit[0])})),this.unCheckDetailData.forEach((function(e,t){e.business_id===a.not_audit[0].business_id&&e.deal_id===a.not_audit[0].deal_id&&s.$set(s.unCheckDetailData,t,a.not_audit[0])}))),this.isShowCheck=!0,t&&(this.editTag="",this.topTable=[],this.dialogData=[])},removeTop:function(e){this.dialogData[e].check=!1,this.dialogData.splice(e,1),0===this.dialogData.length&&(this.showTopDialog=!1)},clearData:function(e,t){var a=this;void 0!==t?this.$confirm("您确定要删除？","提示",{}).then((function(){"1"===e?a.checkDetailData.splice(t,1):"2"===e&&a.unCheckDetailData.splice(t,1),0===a.checkDetailData.length&&0===a.unCheckDetailData.length&&(a.isShowCheck=!1)})).catch((function(e){})):this.$confirm("您确定要批量清除您刚选择的合同预测吗？","提示",{}).then((function(){"1"===e?a.checkDetailData.splice(0,a.checkDetailData.length):"2"===e&&a.unCheckDetailData.splice(0,a.unCheckDetailData.length),0===a.checkDetailData.length&&0===a.unCheckDetailData.length&&(a.isShowCheck=!1)})).catch((function(e){}))},editData:function(e){this.titleMsg="修改回款信息",this.editTag="edit",e.showTip=!1,e.rangeTip=!1,this.showTopDialog=!0,this.$set(e,"iptVal",e.actual_money),this.$set(this.dialogData,0,e)},submitFinancer:function(){this.$refs.upload.showVoucher()},uploadSuccess:function(){this.checkDetailData=[],this.getHistory(),this.getWaitData(),0===this.checkDetailData.length&&0===this.unCheckDetailData.length&&(this.isShowCheck=!1)},finishCheck:function(){var e=this,t=[];this.unCheckDetailData.forEach((function(e){var a={business_type:e.business_type,business_id:e.business_id,forecast_step:e.step,forecast_num:e.num,forecast_step_num:e.step_num,actual_money:e.actual_money.toString(),deal_id:e.deal_id};t.push(a)}));var a={bank_flow_id:this.flowId,data:t};this.flag&&(this.flag=!1,this.axios.post("/backend-api/expand/ex-bank-flow/finish-verify",a).then((function(t){e.flag=!0,0===t.data.code?(e.unCheckDetailData=[],e.getHistory(),e.getWaitData(),0===e.checkDetailData.length&&0===e.unCheckDetailData.length&&(e.isShowCheck=!1)):10===t.data.code?(e.checkDialog=!0,e.checkMsg=t.data.msg,e.checkUrl=t.data.data.redirect_url):alert(t.data.msg)})).catch((function(e){console.log(e)})))},revertSub:function(e,t){var a=this;"1"===e?this.$confirm("您确定要撤回核销编号：".concat(t.show_number," 的审核申请吗？"),"提示",{}).then((function(){var e=[{business_type:t.business_type,id:t.business_id,deal_id:t.deal_id,verify_status:t.verify_status}],i={id:a.flowId,list:e};a.axios.post("/backend-api/expand/ex-bank-flow/recall-submit",i).then((function(e){0===e.data.code?(a.$set(t,"iptVal",t.actual_money),a.$set(t,"verify_status","0"),a.$set(t,"verify_status_text","等待提交"),a.$set(t,"showTip",!1),a.$set(t,"rangeTip",!1),t.content=t.pre_paid_content,t.arrival_time=t.actual_datetime,t.unverified_money=e.data.data.business_info[0].unverified_money,"1"===t.business_type.toString()&&(t.business_id=t.forecast_id,t.business_type="3"),a.checkDetailData.push(t),(a.checkDetailData.length>0||a.unCheckDetailData.length>0)&&(a.isShowCheck=!0),a.getWaitData(),a.getHistory()):a.$message(e.data.msg)})).catch((function(e){console.log(e)}))})).catch((function(e){})):"2"===e&&this.$confirm("您确定要批量撤回审核申请吗？","提示",{}).then((function(){var e=[];a.historyCheck.forEach((function(t){var a={business_type:t.business_type,id:t.business_id,deal_id:t.deal_id,verify_status:t.verify_status};t.show_revoke&&e.push(a)}));var t={id:a.flowId,list:e};0!==t.list.length&&a.axios.post("/backend-api/expand/ex-bank-flow/recall-submit",t).then((function(e){0===e.data.code&&(a.historyCheck.forEach((function(t,i){a.$set(t,"iptVal",t.actual_money),a.$set(t,"verify_status","0"),a.$set(t,"verify_status_text","等待提交"),a.$set(t,"showTip",!1),a.$set(t,"rangeTip",!1),t.content=t.pre_paid_content,t.arrival_time=t.actual_datetime,e.data.data.business_info.forEach((function(e){t.business_id==e.business_id&&t.business_type==e.business_type&&(t.unverified_money=e.unverified_money,a.checkDetailData.push(t))})),"1"===t.business_type.toString()&&(t.business_id=t.forecast_id,t.business_type="3")})),(a.checkDetailData.length>0||a.unCheckDetailData.length>0)&&(a.isShowCheck=!0),a.getWaitData(),a.getHistory())})).catch((function(e){console.log(e)}))})).catch((function(e){}))},deleteSub:function(e){var t=this;this.$confirm("您确定要删除核销编号：".concat(e.show_number," 的审核申请吗？"),"提示",{}).then((function(){var a={business_id:e.business_id,business_type:e.business_type};t.axios.post("/backend-api/expand/ex-bank-flow/delete-payment",a).then((function(e){0===e.data.code&&t.getHistory()})).catch((function(e){console.log(e)}))})).catch((function(e){}))},editCheck:function(e){this.titleMsg="修改回款信息",this.$set(e,"showTip",!1),this.$set(e,"rangeTip",!1),this.$set(e,"content",e.pre_paid_content),this.$set(e,"arrival_time",e.actual_datetime),this.showTopDialog=!0,this.editTag="editHistory",this.$set(e,"iptVal",e.actual_money),this.$set(this.dialogData,0,e)},historySuccess:function(e,t){this.editTag="",this.showTopDialog=!1,this.getHistory(),""!==t&&(e.iptVal=t,e.actual_money=t),this.$set(e,"verify_status","0"),this.$set(e,"verify_status_text","等待提交"),this.checkDetailData.push(e),this.checkDetailData.length>0&&(this.isShowCheck=!0)},releaseMoney:function(e,t){this.releaseDialog=!0,this.showLoading=!1,this.release.reason="",this.aliyunArr=[],this.releaseType=e,this.releaseIndex=t;var a=this.historyUncheck[t];"1"===e?"2"===a.business_type.toString()?this.release.title="您确定要对成交单ID：".concat(a.deal_id,"的\n                    核销记录（核销ID：").concat(a.show_number,"；实际回款金额：").concat(a.actual_money,"元） 操作释放金额吗？\n                    若释放金额，请您填写释放原因。"):this.release.title=""===a.num?"您确定要对成交单ID：".concat(a.deal_id,"的\n                    核销记录（核销ID：").concat(a.show_number,"；实际回款金额：").concat(a.actual_money,"元） 操作释放金额吗？\n                    若释放金额，请您填写释放原因。"):"您确定要对成交单ID：".concat(a.deal_id,"的第").concat(a.num,"笔\n                    合同预测的核销记录（核销ID：").concat(a.show_number,"；实际回款金额：").concat(a.actual_money,"元） 操作释放金额吗？\n                    若释放金额，请您填写释放原因。"):"2"===e&&(this.release.title='您确定要当前银行流水中所有已核销的金额吗？若您想操作"释放金额" 请您填写释放原因。')},handleDiff:function(e){var t=this,a={id:this.flowId,type:e};this.axios.post("/backend-api/expand/ex-bank-flow/edit-margin",a).then((function(a){0===a.data.code&&(t.getWaitData(),t.isShowDiff="1"===e?"2":"1")})).catch((function(e){console.log(e)}))},seeProof:function(){var e=this.$router.resolve({path:"/payment/showVoucher",query:{flowId:this.flowId,batchId:this.batchIds}});window.open(e.href,"_blank")},showReason:function(e){this.rejectReason=!0,this.reasonStr=e},seeFile:function(){var e=this;new Promise((function(t,a){e.axios.get("/backend-api/select2/select2/get-file-domain").then((function(a){0===a.data.code&&(e.host=a.data.data.url,t())}))})).then((function(){var t={id:e.flowId};e.axios.get("/backend-api/expand/ex-bank-flow/get-attachment",{params:t}).then((function(t){0===t.data.code&&(e.fileList=t.data.data.attach_list,e.$refs.file.openDialog())})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))},beforeRelease:function(e){this.showLoading||e()},submitRelease:function(){var e=this;return(0,n.default)(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.showLoading=!0,a=null,"1"===e.releaseType?a=e.structureData(1):"2"===e.releaseType&&(a=e.structureData(2)),0!==a.list.length){t.next=6;break}return t.abrupt("return");case 6:if(!(e.aliyunArr.length<=0)){t.next=9;break}return e.releaseApprove(a),t.abrupt("return");case 9:a.attach_list=e.aliyunArr,e.releaseApprove(a),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(0),console.log(t.t0),e.showLoading=!1;case 17:case"end":return t.stop()}}),t,null,[[0,13]])})))()},getFileURL:function(e){var t=this;this.loading=!1,0!==e.length?e.forEach((function(e){if(t.aliyunArr.find((function(t){return t.name===e.originName})))t.$message("已过滤掉重复文件");else{var a={size:parseInt(e.size/1024),path:e.upURL,fileURL:e.fileURL,name:e.originName,extension:e.extension,type:"2"};t.aliyunArr.push(a)}})):this.$message("上传失败,请重新上传")},deleteFile:function(e){this.aliyunArr.splice(e,1)},goNewPage:function(){this.checkDialog=!1,window.open(this.checkUrl,"_blank")},releaseApprove:function(e){var t=this;this.axios.post("/backend-api/expand/ex-bank-flow/release-money",e).then((function(e){t.showLoading=!1,0===e.data.code?(t.releaseDialog=!1,t.getHistory()):1===e.data.code&&t.$message(e.data.msg)})).catch((function(e){console.log(e)}))},structureData:function(e){var t=[];if(1===e&&(this.historyUncheck=[this.historyUncheck[this.releaseIndex]]),this.historyUncheck.forEach((function(e){var a={business_type:e.business_type,id:e.business_id,deal_id:e.deal_id,verify_status:e.verify_status};e.show_free&&t.push(a)})),!(t.length<=0))return{id:this.flowId,list:t,attach_list:this.aliyunArr,reason:this.release.reason};this.$message("当前没有可以批量释放的数据")}},components:{WaitCheck:r.default,TopDialog:c.default,UploadVoucher:d.default,FinanceTable:u.default,CheckFile:h.default,RejectDialog:l.default},created:function(){var e=this;this.flowId=this.$route.query.flowId,this.batchId=this.$route.query.batchId,new Promise((function(t,a){e.getWaitData(t)})).then((function(t){if(t){var a={flow_id:e.flowId};e.axios.get("/backend-api/expand/ex-bank-flow/get-finance-payment",{params:a}).then((function(t){if(0===t.data.code){var a=t.data.data.grid_data;a.forEach((function(t){var a=[],i=[];t.invoice_list.forEach((function(e){a.push(e.begin_title),i.push(e.money)})),t.company=a,t.money=i,t.checkPass=!1,t.checkReject=!1,t.passDisable=!1,t.rejectDisable=!1,e.handleStatus(t)}));var i={data:a,showFile:t.data.data.show_see_attach};e.financeData=i}})).catch((function(e){console.log(e)}))}})).catch((function(e){console.log(e)})),this.getHistory(),this.getListData("init"),this.getRemoteBuild(),this.getRemotePeople(),this.getSignCode()}};t.default=p},5253:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"el-row payment-check"},[a("el-col",{staticClass:"main-info",attrs:{span:24}},[a("el-breadcrumb",{staticClass:"bread-crumb-box",attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",[a("a",{attrs:{href:"/"}},[e._v("首页")])]),a("el-breadcrumb-item",{attrs:{to:{path:"/payment/paymentInformation"}}},[e._v("银行回款信息")]),a("el-breadcrumb-item",[e._v("回款核销")])],1),a("wait-check",{attrs:{tableData:e.waitCheckData}}),e.isFinanceRole?a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowHistory,expression:"isShowHistory"}],staticClass:"history"},[a("div",{staticClass:"v-box"},[a("div",{staticClass:"hd"},[a("h2",{staticClass:"line"},[e._v("历史核销记录")])]),a("div",{staticClass:"bd"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.historyUncheck.length>0,expression:"historyUncheck.length > 0"}],staticClass:"un-need"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.isFreeAll,expression:"isFreeAll"}],staticClass:"clear"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.releaseMoney("2")}}},[e._v(" 批量释放 ")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.historyUncheck,border:""}},[e._l(e.historyHeader,(function(t,i){return["deal_id"===t.prop?a("el-table-column",{key:i,attrs:{resizable:!1,align:"center",label:t.label},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{staticClass:"link",attrs:{href:t.row.deal_url,target:"_blank"}},[e._v(" "+e._s(t.row.deal_id)+" ")])]}}],null,!0)}):"actual_money"===t.prop?a("el-table-column",{key:i,attrs:{resizable:!1,align:"center",label:t.label},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("currency")(t.row.actual_money))+" ")]}}],null,!0)}):a("el-table-column",{key:i,attrs:{resizable:!1,prop:t.prop,width:t.width,label:t.label,align:"center"}})]})),a("el-table-column",{attrs:{resizable:!1,label:"操作",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{directives:[{name:"show",rawName:"v-show",value:t.row.show_back_fee,expression:"scope.row.show_back_fee"}],attrs:{href:e.backUrl,target:"_blank"}},[a("el-button",{attrs:{size:"mini",type:"danger"}},[e._v("退款 ")])],1),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.row.show_free,expression:"scope.row.show_free"}],attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.releaseMoney("1",t.$index)}}},[e._v("释放金额 ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.row.show_reject,expression:"scope.row.show_reject"}],attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleReject(t.$index)}}},[e._v("驳回")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.row.show_reject_reason,expression:"scope.row.show_reject_reason"}],attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.showReason(t.row.reject_reason)}}},[e._v("驳回理由 ")])]}}],null,!1,1641096847)})],2),a("div",{directives:[{name:"show",rawName:"v-show",value:"1"===e.isShowDiff||"2"===e.isShowDiff,expression:"isShowDiff === '1' || isShowDiff === '2'"}],staticClass:"sub-check"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:"1"===e.isShowDiff,expression:"isShowDiff === '1'"}],attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleDiff("1")}}},[e._v(" 差额入库 ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:"2"===e.isShowDiff,expression:"isShowDiff === '2'"}],attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleDiff("2")}}},[e._v(" 取消差额入库 ")])],1)],1)])])])]):a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowHistory,expression:"isShowHistory"}],staticClass:"history"},[a("div",{staticClass:"v-box"},[a("div",{staticClass:"hd"},[a("h2",{staticClass:"line"},[e._v("历史核销记录")])]),a("div",{staticClass:"bd"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.historyUncheck.length>0,expression:"historyUncheck.length > 0"}],staticClass:"un-need"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.isFreeAll,expression:"isFreeAll"}],staticClass:"clear"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.releaseMoney("2")}}},[e._v(" 批量释放 ")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.historyUncheck,border:""}},[e._l(e.historyHeader,(function(t,i){return["deal_id"===t.prop?a("el-table-column",{key:i,attrs:{resizable:!1,align:"center",label:t.label},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{staticClass:"link",attrs:{href:t.row.deal_url,target:"_blank"}},[e._v(" "+e._s(t.row.deal_id)+" ")])]}}],null,!0)}):"actual_money"===t.prop?a("el-table-column",{key:i,attrs:{resizable:!1,align:"center",label:t.label},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("currency")(t.row.actual_money))+" ")]}}],null,!0)}):a("el-table-column",{key:i,attrs:{resizable:!1,prop:t.prop,width:t.width,label:t.label,align:"center"}})]})),a("el-table-column",{attrs:{resizable:!1,label:"操作",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{directives:[{name:"show",rawName:"v-show",value:t.row.show_back_fee,expression:"scope.row.show_back_fee"}],attrs:{href:e.backUrl,target:"_blank"}},[a("el-button",{attrs:{size:"mini",type:"danger"}},[e._v("退款 ")])],1),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.row.show_free,expression:"scope.row.show_free"}],attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.releaseMoney("1",t.$index)}}},[e._v("释放金额 ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.row.show_reject_reason,expression:"scope.row.show_reject_reason"}],attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.showReason(t.row.reject_reason)}}},[e._v("驳回理由 ")])]}}])})],2),a("div",{directives:[{name:"show",rawName:"v-show",value:"1"===e.isShowDiff||"2"===e.isShowDiff,expression:"isShowDiff === '1' || isShowDiff === '2'"}],staticClass:"sub-check"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:"1"===e.isShowDiff,expression:"isShowDiff === '1'"}],attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleDiff("1")}}},[e._v(" 差额入库 ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:"2"===e.isShowDiff,expression:"isShowDiff === '2'"}],attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleDiff("2")}}},[e._v(" 取消差额入库 ")])],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.historyCheck.length>0,expression:"historyCheck.length > 0"}],staticClass:"need"},[a("div",{staticClass:"clear"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.isRevertAll,expression:"isRevertAll"}],attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.revertSub("2")}}},[e._v(" 批量撤回 ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.showReleaseRevoll,expression:"showReleaseRevoll"}],attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.recall("","2")}}},[e._v(" 批量撤回 ")])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.historyCheck,border:""}},[e._l(e.historyHeader,(function(t,i){return["deal_id"===t.prop?a("el-table-column",{key:i,attrs:{resizable:!1,align:"center",label:t.label},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{staticClass:"link",attrs:{href:t.row.deal_url,target:"_blank"}},[e._v(" "+e._s(t.row.deal_id)+" ")])]}}],null,!0)}):"actual_money"===t.prop?a("el-table-column",{key:i,attrs:{resizable:!1,align:"center",label:t.label},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("currency")(t.row.actual_money))+" ")]}}],null,!0)}):a("el-table-column",{key:i,attrs:{resizable:!1,prop:t.prop,width:t.width,label:t.label,align:"center"}})]})),a("el-table-column",{attrs:{resizable:!1,label:"操作",width:"170",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.row.show_revoke||t.row.show_release_revoke,expression:"scope.row.show_revoke || scope.row.show_release_revoke"}],attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.recall(t.row)}}},[e._v("撤回提交 ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.row.show_edit,expression:"scope.row.show_edit"}],attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.editCheck(t.row)}}},[e._v("修改 ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.row.show_delete,expression:"scope.row.show_delete"}],attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.deleteSub(t.row)}}},[e._v("删除 ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.row.show_reject_reason,expression:"scope.row.show_reject_reason"}],attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.showReason(t.row.reject_reason)}}},[e._v("驳回理由 ")])]}}])})],2),a("div",{staticClass:"sub-check"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.isShowFile,expression:"isShowFile"}],attrs:{type:"primary",size:"mini"},on:{click:e.seeFile}},[e._v(" 查看附件 ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.isShowProof,expression:"isShowProof"}],attrs:{type:"primary",size:"mini"},on:{click:e.seeProof}},[e._v(" 查看凭证 ")])],1)],1)])])])]),e.isFinanceRole?a("div",[a("finance-table",{directives:[{name:"show",rawName:"v-show",value:e.financeData.data.length>0,expression:"financeData.data.length > 0"}],ref:"financeTable",attrs:{"batch-ids":e.batchIds},on:{"see-file":e.seeFile,"check-success":e.getWaitData},model:{value:e.financeData,callback:function(t){e.financeData=t},expression:"financeData"}})],1):e._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowCheck,expression:"isShowCheck"}],staticClass:"is-check"},[a("div",{staticClass:"v-box"},[a("div",{staticClass:"hd"},[a("h2",{staticClass:"line"},[e._v("核销的回款详情")])]),a("div",{staticClass:"bd"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.checkDetailData.length>0,expression:"checkDetailData.length > 0"}],staticClass:"check-tb"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.checkDetailData.length>1,expression:"checkDetailData.length > 1"}],staticClass:"clear"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.clearData("1")}}},[e._v(" 批量清除 ")])],1),a("div",{staticClass:"tb-w"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.checkDetailData,border:""}},[e._l(e.checkHeader,(function(t,i){return["deal_id"===t.prop?a("el-table-column",{key:i,attrs:{resizable:!1,align:"center",label:t.label},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{staticClass:"link",attrs:{href:t.row.deal_url,target:"_blank"}},[e._v(" "+e._s(t.row.deal_id)+" ")])]}}],null,!0)}):"actual_money"===t.prop?a("el-table-column",{key:i,attrs:{resizable:!1,align:"center",label:t.label},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("currency")(t.row.actual_money))+" ")]}}],null,!0)}):a("el-table-column",{key:i,attrs:{resizable:!1,prop:t.prop,width:t.width,label:t.label,align:"center"}})]})),a("el-table-column",{attrs:{resizable:!1,label:"操作",width:"130",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.editData(t.row)}}},[e._v("修改 ")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.clearData("1",t.$index)}}},[e._v("删除 ")])]}}])})],2),a("div",{staticClass:"sub-check"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.submitFinancer}},[e._v(" 提交到财务审核 ")])],1)],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.unCheckDetailData.length>0,expression:"unCheckDetailData.length > 0"}],staticClass:"uncheck-tb"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.unCheckDetailData.length>1,expression:"unCheckDetailData.length > 1"}],staticClass:"clear"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.clearData("2")}}},[e._v(" 批量清除 ")])],1),a("div",{staticClass:"tb-w"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.unCheckDetailData,border:""}},[e._l(e.checkHeader,(function(t,i){return["deal_id"===t.prop?a("el-table-column",{key:i,attrs:{resizable:!1,align:"center",label:t.label},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{staticClass:"link",attrs:{href:t.row.deal_url,target:"_blank"}},[e._v(" "+e._s(t.row.deal_id)+" ")])]}}],null,!0)}):"actual_money"===t.prop?a("el-table-column",{key:i,attrs:{resizable:!1,align:"center",label:t.label},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("currency")(t.row.actual_money))+" ")]}}],null,!0)}):a("el-table-column",{key:i,attrs:{resizable:!1,prop:t.prop,width:t.width,label:t.label,align:"center"}})]})),a("el-table-column",{attrs:{resizable:!1,label:"操作",width:"130",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.editData(t.row)}}},[e._v("修改 ")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.clearData("2",t.$index)}}},[e._v("删除 ")])]}}])})],2),a("div",{staticClass:"sub-check"},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.finishCheck}},[e._v(" 完成核销 ")])],1)],1)])])])]),a("div",{staticClass:"search-box"},[a("div",{staticClass:"v-box"},[a("div",{staticClass:"hd"},[a("h2",[e._v("搜索条件")])]),a("div",{staticClass:"bd"},[a("ul",{staticClass:"s-query"},[a("li",[a("div",{staticClass:"th"},[e._v("城市：")]),a("div",{staticClass:"td"},[a("el-select",{attrs:{filterable:e.isCanChoose,placeholder:"请选择"},model:{value:e.form.city,callback:function(t){e.$set(e.form,"city",t)},expression:"form.city"}},e._l(e.dataOption.city,(function(e){return a("el-option",{key:e.id,attrs:{label:e.text,value:e.id}})})),1)],1)]),a("li",[a("div",{staticClass:"th"},[e._v(" 成交单ID： ")]),a("div",{staticClass:"td"},[a("el-input",{model:{value:e.form.dealId,callback:function(t){e.$set(e.form,"dealId",t)},expression:"form.dealId"}})],1)]),a("li",[a("div",{staticClass:"th"},[e._v(" 客户名称： ")]),a("div",{staticClass:"td"},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)]),a("li",[a("div",{staticClass:"th"},[e._v(" 楼盘名称： ")]),a("div",{staticClass:"td"},[a("el-select",{attrs:{filterable:"",clearable:"",remote:"","remote-method":e.getRemoteBuild},model:{value:e.form.building,callback:function(t){e.$set(e.form,"building",t)},expression:"form.building"}},e._l(e.dataOption.buildings,(function(e){return a("el-option",{key:e.id,attrs:{label:e.text,value:e.id}})})),1)],1)]),a("li",{staticClass:"w-auto"},[a("div",{staticClass:"th"},[e._v("网签日期：")]),a("div",{staticClass:"td"},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},model:{value:e.form.netTime,callback:function(t){e.$set(e.form,"netTime",t)},expression:"form.netTime"}})],1)]),a("li",{staticClass:"w-auto"},[a("div",{staticClass:"th"},[e._v("草签日期：")]),a("div",{staticClass:"td"},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},model:{value:e.form.draftTime,callback:function(t){e.$set(e.form,"draftTime",t)},expression:"form.draftTime"}})],1)]),a("li",{staticClass:"w-auto"},[a("div",{staticClass:"th"},[e._v("认购日期：")]),a("div",{staticClass:"td"},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},model:{value:e.form.buyTime,callback:function(t){e.$set(e.form,"buyTime",t)},expression:"form.buyTime"}})],1)]),a("li",{staticClass:"w-auto"},[a("div",{staticClass:"th"},[e._v("排号日期：")]),a("div",{staticClass:"td"},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},model:{value:e.form.rankTime,callback:function(t){e.$set(e.form,"rankTime",t)},expression:"form.rankTime"}})],1)]),a("li",[a("div",{staticClass:"th"},[e._v(" 回款负责人： ")]),a("div",{staticClass:"td"},[a("el-select",{attrs:{filterable:"",clearable:"",remote:"","remote-method":e.getRemotePeople},model:{value:e.form.people,callback:function(t){e.$set(e.form,"people",t)},expression:"form.people"}},e._l(e.dataOption.people,(function(e){return a("el-option",{key:e.id,attrs:{label:e.text,value:e.id}})})),1)],1)])]),a("div",{staticClass:"btn-area"},[a("button",{staticClass:"btn btn-reset",on:{click:e.resetSearch}},[e._v("重置")]),a("button",{staticClass:"btn btn-search",on:{click:e.searchData}},[e._v("搜索")])])])])]),e.isShowOption?a("div",{staticClass:"add"},[a("el-button",{attrs:{disabled:e.isShowTip},on:{click:e.handleTopDialog}},[e._v("操作")])],1):e._e(),a("div",{staticClass:"define-tb-wrap"},[a("table",{directives:[{name:"show",rawName:"v-show",value:e.listData.length>0||e.topTable.length>0,expression:"listData.length > 0 || topTable.length > 0"}],staticClass:"define-table"},[a("thead",[e.isShowOption?a("th",{staticClass:"w-80"},[e._v("选择")]):e._e(),a("th",{staticClass:"w-80"},[e._v("城市")]),a("th",{staticClass:"w-100"},[e._v("成交ID")]),a("th",{staticClass:"w-120"},[e._v("成交楼盘")]),a("th",{staticClass:"w-100"},[e._v("成交客户姓名")]),a("th",{staticClass:"w-120"},[e._v(" 合同主体 ")]),a("th",{staticClass:"w-100"},[e._v("回款负责人")]),a("th",[e._v("结佣类型")]),a("th",{staticClass:"w-200"},[a("div",{staticClass:"w-200"},[e._v(" 合同预测阶段 ")])]),a("th",{staticClass:"w-100"},[e._v("合同预测金额")]),a("th",{staticClass:"w-100"},[e._v("剩余回款金额")])]),a("tbody",[e._l(e.topTable,(function(t,i){return a("tr",{key:i+"top"},[e.isShowOption?a("td",{staticClass:"w-80"},[a("div",{staticStyle:{width:"80px"}},[a("span",{class:{"fake-check":!0,selected:t.check},on:{click:function(a){return e.handleTop("2",i,t)}}},[a("i",{directives:[{name:"show",rawName:"v-show",value:t.check,expression:"item.check"}],staticClass:"el-icon-check",attrs:{"aria-hidden":"true"}})])])]):e._e(),a("td",{staticClass:"w-80"},[a("div",{staticClass:"w-80"},[e._v(" "+e._s(t.city_name)+" ")])]),a("td",{staticClass:"w-100"},[a("div",{staticClass:"w-100"},[a("a",{staticClass:"link",attrs:{href:t.deal_url,target:"_blank"}},[e._v(" "+e._s(t.deal_id)+" ")])])]),a("td",{staticClass:"w-120"},[a("div",{staticClass:"w-120"},[e._v(" "+e._s(t.project_name)+" ")])]),a("td",{staticClass:"w-100"},[a("div",{staticClass:"w-100"},[e._v(" "+e._s(t.username)+" ")])]),a("td",{staticClass:"w-120"},[a("div",{staticClass:"w-120"},[e._v(" "+e._s(t.partner_contract_name)+" ")])]),a("td",{staticClass:"w-100"},[a("div",{staticClass:"w-100"},[e._v(" "+e._s(t.payback_employee)+" ")])]),a("td",{staticClass:"w-100"},[a("div",{staticClass:"w-100"},[e._v(" "+e._s(t.commission_type_text)+" ")])]),a("td",{staticClass:"w-200"},[a("div",{staticClass:"w-200"},[e._v(" "+e._s(t.content)+" ")])]),a("td",{staticClass:"w-100"},[a("div",{staticClass:"w-100"},[e._v(" "+e._s(e._f("currency")(t.pre_paid_money))+" ")])]),a("td",{staticClass:"w-100"},[a("div",{staticClass:"w-100"},[e._v(" "+e._s(e._f("currency")(t.unverified_money))+" ")])])])})),e._l(e.listData,(function(t,i){return a("tr",{key:i},[e.isShowOption?a("td",{staticClass:"w-80"},[a("div",{staticClass:"w-80"},[a("span",{class:{"fake-check":!0,selected:t.check},on:{click:function(a){return e.handleTop("1",i,t)}}},[a("i",{directives:[{name:"show",rawName:"v-show",value:t.check,expression:"item.check"}],staticClass:"el-icon-check",attrs:{"aria-hidden":"true"}})])])]):e._e(),a("td",{staticClass:"w-80"},[a("div",{staticClass:"w-80"},[e._v(" "+e._s(t.city_name)+" ")])]),a("td",{staticClass:"w-100"},[a("div",{staticClass:"w-100"},[a("a",{staticClass:"link",attrs:{href:t.deal_url,target:"_blank"}},[e._v(" "+e._s(t.deal_id)+" ")])])]),a("td",{staticClass:"w-120"},[a("div",{staticClass:"w-120"},[e._v(" "+e._s(t.project_name)+" ")])]),a("td",{staticClass:"w-100"},[a("div",{staticClass:"w-100"},[e._v(" "+e._s(t.username)+" ")])]),a("td",{staticClass:"w-120"},[a("div",{staticClass:"w-120"},[e._v(" "+e._s(t.partner_contract_name)+" ")])]),a("td",{staticClass:"w-100"},[a("div",{staticClass:"w-100"},[e._v(" "+e._s(t.payback_employee)+" ")])]),a("td",{staticClass:"w-100"},[a("div",{staticClass:"w-100"},[e._v(" "+e._s(t.commission_type_text)+" ")])]),a("td",{staticClass:"w-200"},[a("div",{staticClass:"w-200"},[e._v(" "+e._s(t.content)+" ")])]),a("td",{staticClass:"w-100"},[a("div",{staticClass:"w-100"},[e._v(" "+e._s(e._f("currency")(t.pre_paid_money))+" ")])]),a("td",{staticClass:"w-100"},[a("div",{staticClass:"w-100"},[e._v(" "+e._s(e._f("currency")(t.unverified_money))+" ")])])])}))],2)])]),a("div",{staticClass:"page-btn"},[a("button",{directives:[{name:"show",rawName:"v-show",value:e.page>1,expression:"page > 1"}],staticClass:"btn",on:{click:e.prevPage}},[e._v("上一页")]),a("button",{directives:[{name:"show",rawName:"v-show",value:e.page<e.totalPage,expression:"page < totalPage"}],staticClass:"btn",on:{click:e.nextPage}},[e._v("下一页")])])],1),a("top-dialog",{attrs:{"show-top-dialog":e.showTopDialog,"title-msg":e.titleMsg,"top-table":e.dialogData,"edit-tag":e.editTag},on:{"delete-top":e.removeTop,"close-dia":e.closeTopDia,"sub-dia":e.subTopDia,"success-history":e.historySuccess}}),a("upload-voucher",{ref:"upload",attrs:{"check-data":e.checkDetailData},on:{uploaded:e.uploadSuccess}}),a("el-dialog",{staticClass:"reason-dia",attrs:{visible:e.rejectReason,width:"450px"},on:{"update:visible":function(t){e.rejectReason=t}}},[a("h2",{staticClass:"line",attrs:{slot:"title"},slot:"title"},[e._v("驳回理由")]),a("div",{staticClass:"reject-content"},[a("div",{staticClass:"fl"},[e._v(" 驳回理由： ")]),a("div",{staticClass:"reason-content"},[e._v(" "+e._s(e.reasonStr)+" ")])])]),a("check-file",{ref:"file",attrs:{"file-list":e.fileList,host:e.host}}),a("el-dialog",{staticClass:"reject",attrs:{width:"600px",visible:e.releaseDialog,"before-close":e.beforeRelease,"close-on-click-modal":!e.showLoading},on:{"update:visible":function(t){e.releaseDialog=t}}},[a("h2",{staticClass:"line",attrs:{slot:"title"},slot:"title"},[e._v("释放金额审批：")]),a("div",{staticClass:"reject-body"},[a("p",[e._v(" "+e._s(e.release.title)+" ")]),a("ul",{directives:[{name:"loading",rawName:"v-loading",value:e.showLoading,expression:"showLoading"}],staticClass:"s-query"},[a("li",[a("div",{staticClass:"th required"},[e._v("释放原因：")]),a("div",{staticClass:"td"},[a("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.release.reason,expression:"release.reason",modifiers:{trim:!0}}],staticClass:"text-area",attrs:{placeholder:"最多300字，不能为空",maxlength:"300"},domProps:{value:e.release.reason},on:{input:function(t){t.target.composing||e.$set(e.release,"reason",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})])]),a("li",[a("div",{staticClass:"th"},[e._v("上传附件：")]),a("div",{staticClass:"td"},[a("jl-file-upload",{ref:"upload",attrs:{fileMaxSize:"5mb",fileType:"doc,docx,pdf,ppt,pptx,xlsx,xls,jpg,png,jpeg",upID:"fileUpload",isMulti:!0,limit:10-e.aliyunArr.length,ossData:e.ossData},on:{getFileURL:e.getFileURL}},[a("i",{staticClass:"el-icon-upload",attrs:{"aria-hidden":"true"}})]),a("div",{staticClass:"list"},e._l(e.aliyunArr,(function(t,i){return a("div",{key:i,staticClass:"list-item"},[a("span",{staticClass:"name"},[e._v(" "+e._s(t.name)+" ")]),a("span",{staticClass:"delete",on:{click:function(t){return e.deleteFile(i)}}},[e._v("删除")])])})),0)],1)])])]),a("div",{staticClass:"btn-area reject-btn",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"btn close-reject",attrs:{disabled:e.showLoading},on:{click:function(t){e.releaseDialog=!1}}},[e._v("取消 ")]),a("el-button",{staticClass:"btn submit-reject",attrs:{disabled:""===e.release.reason||e.showLoading},on:{click:e.submitRelease}},[e._v(" 确定 ")])],1)]),a("el-dialog",{staticClass:"reject",attrs:{width:"450px",visible:e.checkDialog,"show-close":!1},on:{"update:visible":function(t){e.checkDialog=t}}},[a("h2",{staticClass:"line",attrs:{slot:"title"},slot:"title"},[e._v("核销提示")]),a("div",{staticClass:"reject-body"},[e._v(" "+e._s(e.checkMsg)+" ")]),a("div",{staticClass:"btn-area reject-btn",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"btn close-reject",on:{click:function(t){e.checkDialog=!1}}},[e._v("取消")]),a("el-button",{staticClass:"btn submit-reject",on:{click:e.goNewPage}},[e._v("前往更改流水信息")])],1)]),a("reject-dialog",{attrs:{"dialog-visible":e.rejectDialogShow,"refuse-title":e.rejectTitle,"can-close":e.closeModal},on:{"update:dialogVisible":function(t){e.rejectDialogShow=t},"update:dialog-visible":function(t){e.rejectDialogShow=t},handleConfirm:e.submitRefuse}})],1)},s=[]},5385:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAAdCAYAAABWk2cPAAAAAXNSR0IArs4c6QAAA8FJREFUSA2tVs1rU0EQ33lJbUvEL2wFqwh+ImoTbxb8SJC0IGpLbXPxphcvHvwD1IPgSW/+AYKCmCq1WhRrY7SCBy20TRUUhdqDX4cilhbaNHnjb7Zs+vLyXpOoe5nd2Zn97c7HzpCqYCSfZfaRsttZqahi1cSKNypFASL+BvVvzOp1IGj1nYo1vyEwyx1JywncS42dyOf5qlK8dzk5s0ekJpmsy4mjzbcAbhu+m3qCPng5vnl+PncbwofdCpWsAZ4JBq3TnbHwOy/5EtDkYKaF2e5VzBu8FCrl4aUziul0ojX80K1TBCqAyrbT8FmtW/Dv1mTD8YmuePi+U78Aqk2azb/91xc6D1+c0yzV8MFEbP+o2bPMRPvwH01qziqmHFILqmd4mGsMX4NKlIJRGjREc0iNL0a4LCUlKTTtlkMObZ/4NXbO8DXoYloY1hINcOBQIh7eaim6ssT1npGim43ByJY6Vb9bEd7mGsx8MZ2eqBO2JYnvl4c25esk2btbI5eWAxbA7nj4bCxGuVzArsH3UHCbwcZrG6bs6bgGZbI7zEYJZXUnmX6/Xfh+wAZQPoPk0KeGXD7bD4BAyVlg2HluF76FWx3xEhAeUmeTyi288AN2A/Lc7HM/q+nziKNCLflLZeI34IsmL+BqARfPJ41FdwdGfoOxyg/U8GG+rypYE03E9nwWHi4DFrGYtNwLzRlCQ/WBdXA4edrfKShz8+K+gQ+oMNAC4NOxsVA1gPqcXG3Agq7kVkWDmAdPxnf9MMJt4fAsbt1r1uUoXJI9Ht05JaFdEaj4sCseOYMX6ijtTY1vExC/qPa8APF3sZAlBdhTwMH0CpoFO//SL6odqkVTfPQay5KKX7TjWngBSloYH1cDjNDTWNZii6EmXVhmOSQ/jTGpO2h8gKX4lwycMbNyZeiJbCCQEB5oMUqkwMBexg/QyLuBwS+UMCMjFBa7duzADl0MdD2FotUzODoC/za7BLNM6jF4LeXqLFoU5DulcEYbzB9ynoPb/1zTSNsk2oWvP2Z5jfQ0oDNOYXyDKwDWUQ5QdAC2GpfvdAPiMjkLbYsBFFkNKhPdRGETt/Xt4kSu+kEXulvDKadeAVSY0kRJTwNgbQanYLVzeSEsdz4Rj9xw6xZ6JOdGMj0SkRYDJUqXNedeRXP4UEzqfqHR9QSVTelppMWAny4CvMEoLEclJiRKORi8jsJQFB9OPV9QIyQthlR8trnDVozai/LErNsOAGSVfG34aSTxJQ9NWhj9/0b7X2XWPkp/XA8rlL20F+gfoDC+apDKsoAAAAAASUVORK5CYII="},"59bc":function(e,t,a){"use strict";a("4160"),a("d3b7"),a("ac1f"),a("25f0"),a("5319"),a("159b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={name:"TopDialog",data:function(){return{flowId:"",isShow:!1,isCanSub:"yes",generateData:[],flag:!0}},props:{titleMsg:{type:String,default:""},showTopDialog:{type:Boolean,default:!1},topTable:{type:Array,default:function(){return[]}},editTag:{type:String,default:""}},methods:{removeTop:function(e){this.$emit("delete-top",e)},closeDia:function(){this.isCanSub="yes",this.$emit("close-dia",!1)},regularAmount:function(e){var t=e.replace(/[^\d.]/g,"");return(t=(t=t.replace(/\.{2,}/g,"")).replace(".","$#$").replace(/\./g,"").replace("$#$",".")).replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3")},inputMoney:function(e,t){this.topTable[t].iptVal=this.regularAmount(e)},generateTable:function(){var e=this;this.isCanSub="yes";for(var t=0;t<this.topTable.length;t++)if(""===this.topTable[t].iptVal){this.isCanSub="no",this.$message({message:"实际回款金额输入框不能为空",type:"warning"});break}if(this.topTable.forEach((function(t){(t.showTip||t.rangeTip)&&(e.isCanSub="no")})),"yes"===this.isCanSub&&"editHistory"!==this.editTag){this.generateData=this.topTable;var a=[];this.generateData.forEach((function(e){var t={business_id:e.business_id,business_type:e.business_type,actual_money:e.iptVal,deal_id:e.deal_id,num:e.num};a.push(t)}));var i={flow_id:this.flowId,payment_data:a};this.flag&&(this.flag=!1,this.axios.post("/backend-api/expand/ex-bank-flow/check-payment",i).then((function(t){if(e.flag=!0,0===t.data.code){var a=t.data.data;a.need_audit.forEach((function(t,i){e.generateData.forEach((function(e,s){if(t.business_id===e.business_id&&t.deal_id===e.deal_id){var n=Object.assign({},e,t);a.need_audit[i]=n}}))})),a.not_audit.forEach((function(t,i){e.generateData.forEach((function(e){if(t.business_id===e.business_id&&t.deal_id===e.deal_id){var s=Object.assign({},e,t);a.not_audit[i]=s}}))})),e.$emit("sub-dia",!1,!0,a,e.editTag)}else alert(t.data.msg)})).catch((function(e){console.log(e)})))}else if("yes"===this.isCanSub&&"editHistory"===this.editTag){var s={business_id:this.topTable[0].business_id,business_type:this.topTable[0].business_type};this.flag&&(this.flag=!1,this.axios.post("/backend-api/expand/ex-bank-flow/delete-payment",s).then((function(t){if(e.flag=!0,0===t.data.code){var a=e.topTable[0].iptVal;"1"===e.topTable[0].business_type.toString()&&(e.topTable[0].business_id=e.topTable[0].forecast_id,e.topTable[0].business_type="3"),e.topTable[0].content=e.topTable[0].pre_paid_content,e.topTable[0].arrival_time=e.topTable[0].actual_datetime,e.$emit("success-history",e.topTable[0],a)}else alert(t.data.msg)})))}},verify:function(e,t){""!==e?0===(e*=1)?(this.topTable[t].showTip=!0,this.topTable[t].rangeTip=!1):e>this.topTable[t].unverified_money?(this.topTable[t].rangeTip=!0,this.topTable[t].showTip=!1):(this.topTable[t].rangeTip=!1,this.topTable[t].showTip=!1):(this.topTable[t].rangeTip=!1,this.topTable[t].showTip=!1)}},created:function(){this.flowId=this.$route.query.flowId},watch:{showTopDialog:{handler:function(e,t){this.isShow=e}}}};t.default=i},"6a7a":function(e,t,a){"use strict";a.r(t);var i=a("17dc"),s=a("48ba");for(var n in s)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return s[e]}))}(n);a("eefe");var o=a("2877"),l=Object(o.a)(s.default,i.a,i.b,!1,null,"271baa7b",null);t.default=l.exports},"6e60":function(e,t,a){var i=a("8706");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,a("499e").default)("ea11e782",i,!0,{sourceMap:!1,shadowMode:!1})},"76be":function(e,t,a){(t=a("24fb")(!1)).push([e.i,'.reject-wrap .el-dialog__header>.line[data-v-271baa7b]{border-bottom:1px solid #edeff0;height:46px;line-height:46px;position:relative;padding-left:14px;margin-bottom:10px}.reject-wrap .el-dialog__header>.line[data-v-271baa7b]:before{position:absolute;left:0;top:10px;content:"";width:6px;height:24px;background-color:#4682b4}.reject-wrap[data-v-271baa7b] .el-dialog__body{padding:0 20px}.reject-wrap .reject-body[data-v-271baa7b]{overflow:hidden}.reject-wrap .reject-body .textarea[data-v-271baa7b]{height:120px;width:100%;-webkit-appearance:none;background-color:#fff;border-radius:4px;border:1px solid #dcdfe6;-webkit-box-sizing:border-box;box-sizing:border-box;color:#606266;display:inline-block;font-size:inherit;outline:0;padding:10px 15px}.reject-wrap .reject-body .textarea[data-v-271baa7b]:focus{border-color:#409eff;outline:0}.reject-wrap .reject-body .s-query[data-v-271baa7b]{margin-top:15px}.reject-wrap .reject-body .s-query>li[data-v-271baa7b]{float:none;width:auto;margin:0}.reject-wrap .reject-body .s-query>li .th[data-v-271baa7b]{width:auto}.reject-wrap .reject-btn[data-v-271baa7b]{position:relative;text-align:right}.reject-wrap .reject-btn .close-reject[data-v-271baa7b]{color:#333;border:1px solid #333;margin-right:15px}.reject-wrap .reject-btn .submit-reject[data-v-271baa7b]{background:#337ab7;color:#fff;border:1px solid #337ab7;margin-left:15px}',""]),e.exports=t},"7ad0":function(e,t,a){(t=a("24fb")(!1)).push([e.i,'.wait-check[data-v-5ec98ade]{margin-bottom:20px}.wait-check[data-v-5ec98ade] .el-table colgroup.gutter,.wait-check[data-v-5ec98ade] .el-table th.gutter{display:table-cell!important}.line[data-v-5ec98ade]{position:relative;padding-left:14px;margin-bottom:10px}.line[data-v-5ec98ade]:before{position:absolute;left:0;top:10px;content:"";width:6px;height:24px;background-color:#4682b4}',""]),e.exports=t},"85c4":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={name:"RejectDialog",props:{dialogVisible:{type:Boolean,default:!1},refuseTitle:{type:String,default:""},canClose:{type:Boolean,default:!0}},data:function(){return{refuseReason:"",dialogVisib:this.dialogVisible}},methods:{handleConfirm:function(){this.$emit("handleConfirm",this.refuseReason)},beforeClose:function(e){this.canClose?e():this.$message("数据处理中，请稍后...")},closed:function(){this.dialogVisib=!1,this.refuseReason="",this.$emit("update:dialogVisible",!1)}},watch:{dialogVisible:function(e){this.dialogVisib=e}}};t.default=i},8706:function(e,t,a){(t=a("24fb")(!1)).push([e.i,'.payment-check[data-v-3e662311]{padding:0 20px 20px}.payment-check .line[data-v-3e662311]{position:relative;padding-left:14px;margin-bottom:10px}.payment-check .line[data-v-3e662311]:before{position:absolute;left:0;top:10px;content:"";width:6px;height:24px;background-color:#4682b4}.payment-check[data-v-3e662311] input{background:none}.payment-check[data-v-3e662311] .reset-border{border-top:0 none}.payment-check .add button[data-v-3e662311]{background-color:transparent}.payment-check[data-v-3e662311] .el-button--default{border:1px solid #333;color:#333}.payment-check input[type=checkbox][data-v-3e662311]{-webkit-appearance:checkbox;width:16px;height:16px}.payment-check .s-query[data-v-3e662311]{overflow:hidden}.payment-check .s-query>li.w-auto[data-v-3e662311]{width:auto}.payment-check .btn-reset[data-v-3e662311]{color:#333;border:1px solid #333;margin-right:15px;cursor:pointer}.payment-check .btn-search[data-v-3e662311]{background:#333;color:#fff;border:1px solid #333;margin-left:15px;cursor:pointer}.payment-check .add[data-v-3e662311]{text-align:right;padding-right:20px;margin-bottom:20px}.payment-check .add .btn[data-v-3e662311]{background-color:transparent;border:1px solid #333}.payment-check .link[data-v-3e662311]{color:#00f;text-decoration:underline}.payment-check .page-btn[data-v-3e662311]{padding-right:20px;text-align:right}.payment-check[data-v-3e662311] .display-tb{margin-bottom:20px}.payment-check .page-btn .btn[data-v-3e662311]{background-color:#1662b3;border:1px solid #1662b3;color:#fff}.payment-check .page-btn .btn[data-v-3e662311]:first-child{margin-right:20px}.payment-check .fake-check[data-v-3e662311]{position:relative;display:inline-block;width:16px;height:16px;border-radius:2px;border:1px solid #ccc}.payment-check .selected[data-v-3e662311]{background-color:#409eff;border:1px solid #409eff}.payment-check .el-icon-check[data-v-3e662311]{position:absolute;left:0;top:0;color:#fff;font-size:16px}.payment-check .is-check .check-tb[data-v-3e662311]{margin-bottom:20px}.payment-check .clear[data-v-3e662311]{text-align:right;font-size:16px;color:#00f;cursor:pointer;margin-bottom:10px}.payment-check .sub-check[data-v-3e662311]{text-align:right;font-size:16px;color:#00f;margin-top:10px}.payment-check .sub-check span[data-v-3e662311]{cursor:pointer}.payment-check .un-need[data-v-3e662311]{margin-bottom:20px}.payment-check[data-v-3e662311] .el-button+.el-button{margin-left:0}.payment-check .el-button--mini.is-round[data-v-3e662311],.payment-check[data-v-3e662311] .el-button--mini{padding:6px}.payment-check .define-table[data-v-3e662311]{margin-bottom:20px;min-width:100%}.payment-check .define-table thead[data-v-3e662311],.payment-check .define-table tr[data-v-3e662311]{background-color:#fff}.payment-check .define-table td[data-v-3e662311],.payment-check .define-table th[data-v-3e662311]{text-align:center;font-size:14px;border:1px solid #ebeef5;padding:12px 0;min-width:0;-webkit-box-sizing:border-box;box-sizing:border-box;text-overflow:ellipsis;vertical-align:middle;position:relative}.payment-check .define-table td>div[data-v-3e662311],.payment-check .define-table th>div[data-v-3e662311]{padding:0 10px;margin:0 auto;word-break:break-all}.payment-check .define-tb-wrap[data-v-3e662311]{max-width:100%;overflow-x:auto}.payment-check .define-tb-wrap .w-80[data-v-3e662311]{width:80px}.payment-check .define-tb-wrap .w-100[data-v-3e662311]{width:100px}.payment-check .define-tb-wrap .w-120[data-v-3e662311]{width:120px}.payment-check .define-tb-wrap .w-200[data-v-3e662311]{width:200px}.payment-check .search-box .s-query>li[data-v-3e662311]{height:41px}.payment-check .reason-dia .reason-content[data-v-3e662311]{overflow:hidden;word-break:break-all}.payment-check .reason-dia .reject-content[data-v-3e662311]{overflow:hidden}.payment-check[data-v-3e662311] .reason-dia .el-dialog__body{padding:0 20px 10px}.payment-check[data-v-3e662311] .reason-dia .el-dialog__header{padding-bottom:0}.payment-check[data-v-3e662311] .reason-dia .el-dialog__header>h2,.payment-check[data-v-3e662311] .reject .el-dialog__header>h2{border-bottom:1px solid #edeff0;height:46px;line-height:46px}.payment-check[data-v-3e662311] .reject .el-dialog__body{padding:0 20px}.payment-check[data-v-3e662311] .reject .reject-body{max-height:500px;overflow:auto}.payment-check[data-v-3e662311] .reject .reject-body textarea{height:120px;width:100%}.payment-check[data-v-3e662311] .reject .reject-body .s-query{margin-top:15px}.payment-check[data-v-3e662311] .reject .reject-body .s-query>li{float:none;width:auto;margin:0}.payment-check[data-v-3e662311] .reject .reject-body .s-query>li .th{width:auto}.payment-check[data-v-3e662311] .reject .reject-btn{position:relative;text-align:right}.payment-check[data-v-3e662311] .reject .reject-btn .close-reject{color:#333;border:1px solid #333;margin-right:15px}.payment-check[data-v-3e662311] .reject .reject-btn .submit-reject{background:#337ab7;color:#fff;border:1px solid #337ab7;margin-left:15px}.payment-check .text-area[data-v-3e662311]{-webkit-appearance:none;background-color:#fff;border-radius:4px;border:1px solid #dcdfe6;-webkit-box-sizing:border-box;box-sizing:border-box;color:#606266;display:inline-block;font-size:inherit;height:40px;line-height:40px;outline:0;padding:0 15px;-webkit-transition:border-color .2s cubic-bezier(.645,.045,.355,1);transition:border-color .2s cubic-bezier(.645,.045,.355,1);width:100%}.payment-check .text-area[data-v-3e662311]:focus{border-color:#409eff;outline:0}.payment-check .reject .el-icon-upload[data-v-3e662311]{font-size:30px}.payment-check .reject .list-item[data-v-3e662311]{line-height:30px}.payment-check .reject .list-item .delete[data-v-3e662311]{color:#409eff;cursor:pointer}',""]),e.exports=t},"890a":function(e,t,a){var i=a("e614");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,a("499e").default)("a774623a",i,!0,{sourceMap:!1,shadowMode:!1})},"894f":function(e,t,a){"use strict";a.r(t);var i=a("d19b"),s=a("16e7");for(var n in s)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return s[e]}))}(n);a("078c");var o=a("2877"),l=Object(o.a)(s.default,i.a,i.b,!1,null,"6266e5de",null);t.default=l.exports},"946c":function(e,t,a){"use strict";a("bb4d")},"983b":function(e,t,a){"use strict";a.r(t);var i=a("4b0f"),s=a("256e");for(var n in s)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return s[e]}))}(n);a("4809");var o=a("2877"),l=Object(o.a)(s.default,i.a,i.b,!1,null,"5ec98ade",null);t.default=l.exports},"9c3c":function(e,t,a){var i=a("76be");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,a("499e").default)("a0179162",i,!0,{sourceMap:!1,shadowMode:!1})},a15b:function(e,t,a){"use strict";var i=a("23e7"),s=a("44ad"),n=a("fc6a"),o=a("a640"),l=[].join,r=s!=Object,c=o("join",",");i({target:"Array",proto:!0,forced:r||!c},{join:function(e){return l.call(n(this),void 0===e?",":e)}})},ac2a:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={name:"WaitCheck",data:function(){return{}},props:{tableData:Array}};t.default=i},b9e8:function(e,t,a){"use strict";a.r(t);var i=a("cbee"),s=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t.default=s.a},bb4d:function(e,t,a){var i=a("d3c1");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,a("499e").default)("97ab10c0",i,!0,{sourceMap:!1,shadowMode:!1})},cbee:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={name:"check-file",data:function(){return{fileDialog:!1}},props:{fileList:{type:Array,default:function(){return[]}},host:{type:String,default:""}},methods:{openDialog:function(){this.fileDialog=!0}}};t.default=i},d171:function(e,t,a){"use strict";a.r(t);var i=a("5253"),s=a("31a8");for(var n in s)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return s[e]}))}(n);a("da5b");var o=a("2877"),l=Object(o.a)(s.default,i.a,i.b,!1,null,"3e662311",null);t.default=l.exports},d19b:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dialog-box"},[a("el-dialog",{staticClass:"top-box",attrs:{width:"850px",visible:e.isShow},on:{"update:visible":function(t){e.isShow=t},close:e.closeDia,closed:function(t){e.flag=!0}}},[a("h2",{staticClass:"line",attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.titleMsg))]),a("div",{staticClass:"dialog_body"},[a("div",{staticClass:"list"},e._l(e.topTable,(function(t,i){return a("div",{key:i,staticClass:"item"},[a("div",{staticClass:"sort"},[e._v(" "+e._s(i+1)+" ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:"edit"!==e.editTag&&"editHistory"!==e.editTag,expression:"editTag !== 'edit' && editTag !== 'editHistory'"}],staticClass:"remove",on:{click:function(t){return e.removeTop(i)}}},[e._v(" 移除该项 ")]),a("div",{staticClass:"content"},[a("ul",{staticClass:"s-query"},[a("li",{staticClass:"w-auto"},[a("div",{staticClass:"th"},[e._v("成交单ID：")]),a("div",{staticClass:"td"},[e._v(e._s(t.deal_id))])]),a("li",{staticClass:"w-auto"},[a("div",{staticClass:"th"},[e._v("客户名称：")]),a("div",{staticClass:"td"},[e._v(e._s(t.username))])]),a("li",{staticClass:"w-auto"},[a("div",{staticClass:"th"},[e._v("楼盘名称：")]),a("div",{staticClass:"td"},[e._v(e._s(t.project_name))])]),a("li",{staticClass:"w-auto"},[a("div",{staticClass:"th"},[e._v("城市：")]),a("div",{staticClass:"td"},[e._v(e._s(t.city_name))])]),a("li",{staticClass:"w-auto"},[a("div",{staticClass:"th"},[e._v("合同预测金额：")]),a("div",{staticClass:"td"},[e._v(e._s(t.pre_paid_money))])]),a("li",{staticClass:"w-auto"},[a("div",{staticClass:"th"},[e._v("已核销金额：")]),a("div",{staticClass:"td"},[e._v(e._s(t.verified_money))])]),a("li",{staticClass:"w-auto"},[a("div",{staticClass:"th"},[e._v("剩余回款金额：")]),a("div",{staticClass:"td"},[e._v(e._s(t.unverified_money))])]),a("li",{staticClass:"all-width"},[a("div",{staticClass:"th"},[e._v("合同预测阶段：")]),a("div",{staticClass:"td"},[e._v(e._s(t.content))])]),a("li",{staticClass:"w-auto"},[a("div",{staticClass:"th"},[e._v("实际回款日期：")]),a("div",{staticClass:"td"},[e._v(e._s(t.arrival_time))])]),a("li",{staticClass:"w-auto"},[a("div",{staticClass:"th required"},[e._v("实际回款金额：")]),a("div",{staticClass:"td"},[a("el-input",{attrs:{disabled:"2"===t.business_type.toString(),placeholder:"请输入回款金额"},on:{input:function(a){return e.inputMoney(t.iptVal,i)},blur:function(a){return e.verify(t.iptVal,i)}},model:{value:t.iptVal,callback:function(a){e.$set(t,"iptVal",a)},expression:"item.iptVal"}}),a("p",{directives:[{name:"show",rawName:"v-show",value:t.showTip,expression:"item.showTip"}],staticClass:"error-tip"},[e._v("实际回款金额不能为0")]),a("p",{directives:[{name:"show",rawName:"v-show",value:t.rangeTip,expression:"item.rangeTip"}],staticClass:"error-tip"},[e._v("您输入的金额已经大于回款金额了，请核实")])],1)])])])])})),0)]),a("div",{staticClass:"btn-area",attrs:{slot:"footer"},slot:"footer"},[a("button",{staticClass:"btn cancel",on:{click:function(t){e.isShow=!1}}},[e._v("取消")]),a("button",{staticClass:"btn confirm",on:{click:e.generateTable}},[e._v("确定")])])])],1)},s=[]},d3c1:function(e,t,a){(t=a("24fb")(!1)).push([e.i,'.finance .el-table th div[data-v-07283bf4],.finance[data-v-07283bf4] .el-table .cell{padding:0}.finance[data-v-07283bf4] .el-table td{padding:8px 0}.finance .define li[data-v-07283bf4]{border-bottom:1px solid #ebeef5;line-height:30px}.finance .define li[data-v-07283bf4]:last-child{border-bottom:0 none}.finance .btns-w[data-v-07283bf4]{margin-top:20px;text-align:right;margin-bottom:20px}.finance .line[data-v-07283bf4]{position:relative;padding-left:14px;margin-bottom:10px}.finance .line[data-v-07283bf4]:before{position:absolute;left:0;top:10px;content:"";width:6px;height:24px;background-color:#4682b4}',""]),e.exports=t},da5b:function(e,t,a){"use strict";a("6e60")},e24d:function(e,t,a){"use strict";var i=a("4ea4");a("7db0"),a("4160"),a("a434"),a("b0c0"),a("159b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("96cf");var s=i(a("1da1")),n=a("f946"),o={name:"upload-voucher",props:{checkData:{type:Array,default:function(){return[]}}},data:function(){return{is_voucher_dialog:!1,is_voucher_btn:!1,postData:{id:"",attach_list:[],reason:""},loading:!1,checkDialog:!1,checkMsg:"",checkUrl:"",canSubmit:!0,ossData:{}}},computed:{textOverflowMsg:function(){return this.postData.reason.length>=300}},methods:{getSignCode:function(){var e=this;return(0,s.default)(regeneratorRuntime.mark((function t(){var a,i,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={cate:"uploadVoucher"},t.prev=1,t.next=4,(0,n.getSign)(a);case 4:i=t.sent,0===(s=i.data).code&&(e.ossData=s.data),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})))()},showVoucher:function(){this.is_voucher_dialog=!0,this.loading=!1,this.postData.attach_list=[]},deleteImg:function(e){this.postData.attach_list.splice(e,1)},getFileURL:function(e){var t=this;this.loading=!1,0!==e.length?e.forEach((function(e){if(t.postData.attach_list.find((function(t){return t.name===e.originName})))t.$message("已过滤掉重复图片");else{var a={size:parseInt(e.size/1024),path:e.upURL,fileURL:e.fileURL,name:e.originName,extension:e.extension,type:"1"};t.postData.attach_list.push(a)}})):this.$message("上传失败,请重新上传")},upload:function(){var e=this,t=[];this.checkData.forEach((function(e){var a={business_type:e.business_type,business_id:e.business_id,ex_forecast_id:e.forecast_id,forecast_step:e.step,forecast_num:e.num,forecast_step_num:e.step_num,actual_money:e.actual_money,deal_id:e.deal_id};t.push(a)}));var a={data:t,bank_flow_id:this.postData.id,attach_list:this.postData.attach_list,reason:this.postData.reason};this.canSubmit&&(this.canSubmit=!1,this.axios.post("/backend-api/expand/ex-bank-flow/submit-review",a).then((function(t){0===t.data.code?(e.is_voucher_dialog=!1,e.$emit("uploaded")):10===t.data.code?(e.is_voucher_dialog=!1,e.checkDialog=!0,e.checkMsg=t.data.msg,e.checkUrl=t.data.data.redirect_url):alert(t.data.msg)})))},goNewPage:function(){this.checkDialog=!1,window.open(this.checkUrl,"_blank")}},created:function(){this.postData.id=this.$route.query.flowId,this.getSignCode()}};t.default=o},e3f3:function(e,t,a){"use strict";a.r(t);var i=a("fe04"),s=a("b9e8");for(var n in s)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return s[e]}))}(n);a("3efd");var o=a("2877"),l=Object(o.a)(s.default,i.a,i.b,!1,null,"e025a4fe",null);t.default=l.exports},e614:function(e,t,a){(t=a("24fb")(!1)).push([e.i,'.voucher .warning-msg[data-v-798b06b7]{font-size:12px;color:red}.voucher button[data-v-798b06b7]{background:#fff}.voucher .line[data-v-798b06b7]{position:relative;padding-left:14px;margin-bottom:10px}.voucher .line[data-v-798b06b7]:before{position:absolute;left:0;top:0;content:"";width:6px;height:24px;background-color:#4682b4}.voucher[data-v-798b06b7] .el-dialog__body{padding:0 30px}.voucher[data-v-798b06b7] .add_voucher .label{padding:15px 0 10px;color:#333}.voucher[data-v-798b06b7] .add_voucher .file_img{overflow:hidden}.voucher[data-v-798b06b7] .add_voucher .file_img .text{font-size:14px;color:#333;padding-top:10px}.voucher[data-v-798b06b7] .add_voucher .file_img .voucher_content{height:120px}.voucher[data-v-798b06b7] .add_voucher .file_img .voucher_content>li{position:relative;width:100px;height:100px;margin-top:15px;float:left}.voucher[data-v-798b06b7] .add_voucher .file_img .voucher_content>li .add_img{font-size:35px;position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.voucher[data-v-798b06b7] .add_voucher .file_img .voucher_content>li:last-child{-webkit-box-sizing:border-box;box-sizing:border-box;border:1px double #ccc}.voucher[data-v-798b06b7] .add_voucher .file_img .voucher_content>li+li{margin-left:15px}.voucher[data-v-798b06b7] .add_voucher .file_img .voucher_content>li .img{width:100px;height:100px}.voucher[data-v-798b06b7] .add_voucher .file_img .voucher_content>li .img img{width:100%;height:100%}.voucher[data-v-798b06b7] .add_voucher .file_img .voucher_content>li .delete{position:absolute;width:24px;height:24px;top:-12px;right:-12px}.voucher[data-v-798b06b7] .el-dialog__header>h2{padding-bottom:10px;border-bottom:1px solid #edeff0}.voucher[data-v-798b06b7] .btn-area{text-align:right}.voucher[data-v-798b06b7] .btn-area .cancel{color:#333;border:1px solid #333;margin-right:10px;cursor:pointer}.voucher[data-v-798b06b7] .btn-area .confirm{background:#337ab7;color:#fff;border:1px solid #337ab7;margin-left:10px}',""]),e.exports=t},eefe:function(e,t,a){"use strict";a("9c3c")},f42e:function(e,t,a){"use strict";a.r(t);var i=a("e24d"),s=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t.default=s.a},f58f:function(e,t,a){"use strict";a.r(t);var i=a("269b"),s=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);t.default=s.a},fdff:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"finance"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.financeData.data,border:""}},[a("el-table-column",{attrs:{resizable:!1,prop:"show_number",width:"100px",label:"核销编号",align:"center"}}),a("el-table-column",{attrs:{resizable:!1,prop:"city_name",width:"60px",label:"城市",align:"center"}}),a("el-table-column",{attrs:{resizable:!1,prop:"deal_id",label:"成交ID",align:"center"}}),a("el-table-column",{attrs:{resizable:!1,label:"开票主体",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("ul",{staticClass:"define"},e._l(t.row.company,(function(t,i){return a("li",{key:i},[e._v(e._s(t))])})),0)]}}])}),a("el-table-column",{attrs:{resizable:!1,label:"开票金额",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("ul",{staticClass:"define"},e._l(t.row.money,(function(t,i){return a("li",{key:i},[e._v(e._s(e._f("currency")(t)))])})),0)]}}])}),a("el-table-column",{attrs:{resizable:!1,prop:"pre_paid_content",label:"合同预测阶段",width:"250px",align:"center"}}),a("el-table-column",{attrs:{resizable:!1,label:"合同预测金额",width:"250px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("currency")(t.row.pre_paid_money)))]}}])}),a("el-table-column",{attrs:{resizable:!1,prop:"actual_datetime",label:" 实际回款日期",align:"center"}}),a("el-table-column",{attrs:{resizable:!1,label:"实际回款金额",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("currency")(t.row.actual_money)))]}}])}),a("el-table-column",{attrs:{resizable:!1,prop:"verify_status_text",label:"财务审核状态",align:"center"}}),a("el-table-column",{attrs:{resizable:!1,label:"操作",width:"130",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.row.checkPass,expression:"!scope.row.checkPass"}],attrs:{disabled:t.row.passDisable,type:"primary",size:"mini"},on:{click:function(a){return e.handlePass("1",t.row)}}},[e._v("通过")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.row.checkReject,expression:"!scope.row.checkReject"}],attrs:{disabled:t.row.rejectDisable,size:"mini",type:"danger"},on:{click:function(a){return e.handleReject("1",t.$index)}}},[e._v("驳回")])]}}])})],1),a("div",{staticClass:"btns-w"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.financeData.showFile,expression:"financeData.showFile"}],attrs:{type:"primary",size:"mini"},on:{click:e.seeFile}},[e._v("查看附件")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.seeProof}},[e._v("显示凭证")]),a("el-button",{attrs:{disabled:e.allPass,size:"mini",type:"success"},on:{click:function(t){return e.handlePass("2")}}},[e._v("全部通过")]),a("el-button",{attrs:{disabled:e.allReject,size:"mini",type:"danger"},on:{click:function(t){return e.handleReject("2")}}},[e._v("全部驳回")])],1),a("reject-dialog",{attrs:{"dialog-visible":e.refuseDialog,"refuse-title":e.refuseTitle,"can-close":e.closeModal},on:{"update:dialogVisible":function(t){e.refuseDialog=t},"update:dialog-visible":function(t){e.refuseDialog=t},handleConfirm:e.submitRefuse}})],1)},s=[]},fe04:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return s}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"file",attrs:{visible:e.fileDialog,width:"750px"},on:{"update:visible":function(t){e.fileDialog=t}}},[a("h2",{staticClass:"line",attrs:{slot:"title"},slot:"title"},[e._v("查看附件")]),a("ul",{staticClass:"s-query"},e._l(e.fileList,(function(t,i){return a("li",{key:i,staticClass:"auto"},[a("div",{staticClass:"sub-li"},[a("div",{staticClass:"th"},[e._v("释放原因：")]),a("div",{staticClass:"td"},[e._v(" "+e._s(t.reason)+" ")])]),a("div",{staticClass:"sub-li"},[a("div",{staticClass:"th"},[e._v("附件：")]),a("div",{staticClass:"td"},[a("div",{staticClass:"item"},e._l(t.files,(function(t,s){return a("div",{key:i+"_"+s,staticClass:"sub-item"},[a("span",{staticClass:"name"},[e._v(" "+e._s(t.name)+" ")]),a("span",{staticClass:"down-load"},[a("a",{directives:[{name:"show",rawName:"v-show",value:e.host&&t.path,expression:"host && subItem.path"}],attrs:{href:e.host+t.path,download:""}},[e._v("下载")])])])})),0)])])])})),0)])},s=[]}}]);