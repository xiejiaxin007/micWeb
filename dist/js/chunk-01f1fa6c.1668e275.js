(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-01f1fa6c"],{"334b":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=r("23f7"),n={getDepartList:function(t){return a.axios.post("/backend-api/select2/select2/get-org-list",t)},getOrderCitys:function(t){return a.axios.post("/backend-api/select2/select2/get-all-city",t)},getOrgDepartList:function(t){return a.axios.get("/backend-api/select2/select2/get-org-depart-list",{params:t})},getJobs:function(t){return a.axios.get("/backend-api/select2/select2/get-org-post-list",{params:t})},getAllCityData:function(t){return a.axios.post("/backend-api/select2/select2/get-all-city-code",t)},getCompanyCommonData:function(t){return a.axios.post("/backend-api/org/org/common-select",t)}};e.default=n},"4d9a":function(t,e,r){"use strict";r.d(e,"a",(function(){return a})),r.d(e,"b",(function(){return n}));var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"edit-config"},[r("el-breadcrumb",{staticClass:"bread-crumb",attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",[r("a",{attrs:{href:"/"}},[t._v("首页")])]),r("el-breadcrumb-item",[t._v("加盟商管理")]),r("el-breadcrumb-item",{attrs:{to:{path:"/companyManage/priorityConfigList"}}},[t._v(" 上户优先级 ")]),r("el-breadcrumb-item",[t._v(t._s(t.navTitle))])],1),r("el-form",{ref:"ruleForm",staticClass:"rule-form",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"150px"}},[r("el-form-item",{attrs:{label:"选择订单上户城市：",prop:"cityIds"}},[r("div",{staticClass:"box-wrap"},[r("el-select",{staticClass:"custom-form",attrs:{filterable:"",clearable:"",placeholder:"请选择"},model:{value:t.ruleForm.cityIds,callback:function(e){t.$set(t.ruleForm,"cityIds",e)},expression:"ruleForm.cityIds"}},t._l(t.cityList,(function(t){return r("el-option",{key:t.id,attrs:{label:t.text,value:t.id}})})),1),r("el-button",{directives:[{name:"show",rawName:"v-show",value:t.ruleForm.cityIds,expression:"ruleForm.cityIds"}],staticClass:"btn-check",attrs:{type:"text"},on:{click:function(e){return t.showCityPriorityConf()}}},[t._v(" 查看该城市的优先级配置 ")])],1)]),r("el-form-item",{attrs:{label:"选择公司：",prop:"company"}},[r("el-select",{staticClass:"custom-form",attrs:{filterable:"",clearable:"",placeholder:"请选择"},model:{value:t.ruleForm.company,callback:function(e){t.$set(t.ruleForm,"company",e)},expression:"ruleForm.company"}},t._l(t.belongCompanyList,(function(t){return r("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})})),1)],1),r("el-form-item",{attrs:{label:"优先级：",prop:"priority"}},[r("jl-number-input",{staticClass:"number-form",attrs:{maxVal:1e3,reg:"parseInt"},model:{value:t.ruleForm.priority,callback:function(e){t.$set(t.ruleForm,"priority",e)},expression:"ruleForm.priority"}}),r("span",{staticClass:"notice-msg"},[t._v("提示：如果输入的优先级和已有的生效中的数据重复，那么会将生效中及后面的数据的优先级批量+1")])],1),r("el-form-item",{attrs:{label:"状态：",prop:"status"}},[r("el-radio-group",{model:{value:t.ruleForm.status,callback:function(e){t.$set(t.ruleForm,"status",e)},expression:"ruleForm.status"}},t._l(t.statusList,(function(e){return r("el-radio",{key:e.value,attrs:{label:e.value}},[t._v(" "+t._s(e.name)+" ")])})),1)],1),r("el-form-item",{attrs:{required:"",label:"上户目标配置："}},[r("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[r("el-table-column",{attrs:{prop:"hour",label:"截止时间点","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.$index;return[r("el-select",{staticClass:"custom-form",attrs:{filterable:"",placeholder:"请选择"},model:{value:t.tableData[a].hour,callback:function(e){t.$set(t.tableData[a],"hour",e)},expression:"tableData[$index].hour"}},t._l(t.dateHours,(function(t,e){return r("el-option",{key:e,attrs:{label:t+"点",value:t}})})),1)]}}])}),r("el-table-column",{attrs:{prop:"percent",label:"需要达到今日上户目标的百分比","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.$index;return[r("div",{staticClass:"box-wrap"},[r("jl-number-input",{attrs:{maxVal:100,reg:"parseInt"},model:{value:t.tableData[a].percent,callback:function(e){t.$set(t.tableData[a],"percent",e)},expression:"tableData[$index].percent"}}),r("div",{staticClass:"percent-unit"},[t._v("%")])],1)]}}])}),r("el-table-column",{attrs:{label:"操作","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.$index;return[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.handleDelete(a)}}},[t._v("删除")])]}}])})],1),r("div",{staticClass:"add-goal",on:{click:t.handleAdd}},[t._v(" + 添加目标 ")])],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v(" 保存 ")])],1)],1),r("PriorityConfigDialog",{attrs:{dialogVisible:t.dialogShow,cityName:t.getCityNameById(t.ruleForm.cityIds),tableData:t.priorityConfs},on:{closeDialog:t.closeDialog}})],1)},n=[]},"5c85":function(t,e,r){"use strict";r.r(e);var a=r("a2c3"),n=r.n(a);for(var i in a)["default"].indexOf(i)<0&&function(t){r.d(e,t,(function(){return a[t]}))}(i);e.default=n.a},6062:function(t,e,r){"use strict";var a=r("6d61"),n=r("6566");t.exports=a("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),n)},6566:function(t,e,r){"use strict";var a=r("9bf2").f,n=r("7c73"),i=r("e2cc"),o=r("0366"),s=r("19aa"),u=r("2266"),l=r("7dd0"),c=r("2626"),d=r("83ab"),f=r("f183").fastKey,p=r("69f3"),m=p.set,v=p.getterFor;t.exports={getConstructor:function(t,e,r,l){var c=t((function(t,a){s(t,c,e),m(t,{type:e,index:n(null),first:void 0,last:void 0,size:0}),d||(t.size=0),null!=a&&u(a,t[l],{that:t,AS_ENTRIES:r})})),p=v(e),g=function(t,e,r){var a,n,i=p(t),o=b(t,e);return o?o.value=r:(i.last=o={index:n=f(e,!0),key:e,value:r,previous:a=i.last,next:void 0,removed:!1},i.first||(i.first=o),a&&(a.next=o),d?i.size++:t.size++,"F"!==n&&(i.index[n]=o)),t},b=function(t,e){var r,a=p(t),n=f(e);if("F"!==n)return a.index[n];for(r=a.first;r;r=r.next)if(r.key==e)return r};return i(c.prototype,{clear:function(){for(var t=p(this),e=t.index,r=t.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete e[r.index],r=r.next;t.first=t.last=void 0,d?t.size=0:this.size=0},delete:function(t){var e=p(this),r=b(this,t);if(r){var a=r.next,n=r.previous;delete e.index[r.index],r.removed=!0,n&&(n.next=a),a&&(a.previous=n),e.first==r&&(e.first=a),e.last==r&&(e.last=n),d?e.size--:this.size--}return!!r},forEach:function(t){for(var e,r=p(this),a=o(t,arguments.length>1?arguments[1]:void 0,3);e=e?e.next:r.first;)for(a(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!b(this,t)}}),i(c.prototype,r?{get:function(t){var e=b(this,t);return e&&e.value},set:function(t,e){return g(this,0===t?0:t,e)}}:{add:function(t){return g(this,t=0===t?0:t,t)}}),d&&a(c.prototype,"size",{get:function(){return p(this).size}}),c},setStrong:function(t,e,r){var a=e+" Iterator",n=v(e),i=v(a);l(t,e,(function(t,e){m(this,{type:a,target:t,state:n(t),kind:e,last:void 0})}),(function(){for(var t=i(this),e=t.kind,r=t.last;r&&r.removed;)r=r.previous;return t.target&&(t.last=r=r?r.next:t.state.first)?"keys"==e?{value:r.key,done:!1}:"values"==e?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),c(e)}}},"6d61":function(t,e,r){"use strict";var a=r("23e7"),n=r("da84"),i=r("94ca"),o=r("6eeb"),s=r("f183"),u=r("2266"),l=r("19aa"),c=r("861d"),d=r("d039"),f=r("1c7e"),p=r("d44e"),m=r("7156");t.exports=function(t,e,r){var v=-1!==t.indexOf("Map"),g=-1!==t.indexOf("Weak"),b=v?"set":"add",h=n[t],y=h&&h.prototype,x=h,k={},w=function(t){var e=y[t];o(y,t,"add"==t?function(t){return e.call(this,0===t?0:t),this}:"delete"==t?function(t){return!(g&&!c(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return g&&!c(t)?void 0:e.call(this,0===t?0:t)}:"has"==t?function(t){return!(g&&!c(t))&&e.call(this,0===t?0:t)}:function(t,r){return e.call(this,0===t?0:t,r),this})};if(i(t,"function"!=typeof h||!(g||y.forEach&&!d((function(){(new h).entries().next()})))))x=r.getConstructor(e,t,v,b),s.REQUIRED=!0;else if(i(t,!0)){var C=new x,_=C[b](g?{}:-0,1)!=C,D=d((function(){C.has(1)})),I=f((function(t){new h(t)})),F=!g&&d((function(){for(var t=new h,e=5;e--;)t[b](e,e);return!t.has(-0)}));I||((x=e((function(e,r){l(e,x,t);var a=m(new h,e,x);return null!=r&&u(r,a[b],{that:a,AS_ENTRIES:v}),a}))).prototype=y,y.constructor=x),(D||F)&&(w("delete"),w("has"),v&&w("get")),(F||_)&&w(b),g&&y.clear&&delete y.clear}return k[t]=x,a({global:!0,forced:x!=h},k),p(x,t),g||r.setStrong(x,t,v),x}},7034:function(t,e,r){"use strict";r("74a4")},"74a4":function(t,e,r){var a=r("e2e6");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,r("499e").default)("735dd378",a,!0,{sourceMap:!1,shadowMode:!1})},8538:function(t,e,r){"use strict";var a=r("4ea4");r("7db0"),r("d81d"),r("a434"),r("d3b7"),r("6062"),r("3ca3"),r("ddb0"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(r("2909"));r("96cf");var i=a(r("1da1")),o=a(r("9404")),s=a(r("334b")),u={name:"EditPriorityConfig",components:{PriorityConfigDialog:a(r("f97d3")).default},data:function(){return{dialogShow:!1,priorityConfs:[],loading:!1,navTitle:"添加配置",ruleForm:{company:"",cityIds:"",priority:"",status:"1"},tableData:[],rules:{company:[{required:!0,message:"公司没有填写",trigger:"change"}],cityIds:[{required:!0,message:"订单上户城市没有填写",trigger:"change"}],priority:[{required:!0,message:"优先级没有填写",trigger:"blur"}],status:[{required:!0,message:"状态没有填写",trigger:"change"}]},belongCompanyList:[],statusList:[],cityList:[],dateHours:this.createHours(),isReq:!1}},created:function(){if(this.id=this.$route.query.id||"",""!==this.id){this.navTitle="编辑配置",document.title="编辑配置"}},mounted:function(){this.getCityList(),this.getCompanyList(),this.getConfStatus(),this.id&&this.getInitInfo()},methods:{getCityNameById:function(t){return this.cityList.find((function(e){return e.id===t}))&&this.cityList.find((function(e){return e.id===t})).text},createHours:function(){for(var t=[],e=0;e<24;e++){var r=e;t.push(r+"")}return t},showCityPriorityConf:function(){var t=this;return(0,i.default)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getPriorityList();case 2:t.dialogShow=!0;case 3:case"end":return e.stop()}}),e)})))()},getPriorityList:function(){var t=this;return(0,i.default)(regeneratorRuntime.mark((function e(){var r,a,n,i,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r={city_id:t.ruleForm.cityIds},e.next=4,o.default.getPriorityList(r);case 4:a=e.sent,n=a.data,i=n.code,s=n.data,u=n.msg,0===i?t.priorityConfs=s.list:t.$message.error(u),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.warn(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))()},handleAdd:function(){this.tableData.push({hour:"",percent:""})},handleDelete:function(t){this.tableData.splice(t,1)},submitForm:function(){var t=this;return(0,i.default)(regeneratorRuntime.mark((function e(){var r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$refs.ruleForm.validate();case 3:if(r=e.sent,a=t.tableData.length>0&&t.tableData.find((function(t){return t.hour||t.percent})),r){e.next=7;break}return e.abrupt("return");case 7:if(a){e.next=10;break}return t.$message.error("上户目标配置必须至少存在一条数据！"),e.abrupt("return");case 10:if(i=t.tableData.map((function(t){return t.hour})),i.length===(0,n.default)(new Set(i)).length){e.next=15;break}return t.$message.error("上户目标配置中存在重复的数据，请检查"),e.abrupt("return");case 15:t.saveInfo(),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),console.log(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})))()},saveInfo:function(){var t=this;return(0,i.default)(regeneratorRuntime.mark((function e(){var r,a,n,i,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t.isReq){e.next=3;break}return e.abrupt("return");case 3:return t.isReq=!0,t.loading=!0,r=t.ruleForm,a={id:t.id,org_id:r.company,city_id:r.cityIds,priority:r.priority,status:r.status,hour_detail:t.tableData},e.next=9,o.default.saveConfigInfo(a);case 9:n=e.sent,i=n.data,s=i.code,u=i.msg,t.isReq=!1,t.loading=!1,0===s?t.$router.push({name:"PriorityConfigList"}):t.$message.error(u),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(0),console.warn(e.t0),t.loading=!1;case 22:case"end":return e.stop()}}),e,null,[[0,18]])})))()},getCityList:function(){var t=this;return(0,i.default)(regeneratorRuntime.mark((function e(){var r,a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.default.getAllCityData();case 3:r=e.sent,a=r.data,n=a.data,0===a.code&&(t.cityList=n||[]),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.warn(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()},getConfStatus:function(){var t=this;return(0,i.default)(regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.default.getCompanyCommonData({type:"org_priority_status"});case 3:r=e.sent,a=r.data.data,t.statusList=a.org_priority_status||[],e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.warn(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},getInitInfo:function(){var t=this;return(0,i.default)(regeneratorRuntime.mark((function e(){var r,a,n,i,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,r={id:t.id},e.next=5,o.default.getInitConfInfo(r);case 5:a=e.sent,n=a.data,i=n.code,s=n.data,0===i?(u=s.config,t.ruleForm.company=u.org_id,t.ruleForm.cityIds=u.city_id,t.ruleForm.priority=u.priority,t.ruleForm.status=u.status,t.tableData=s.hour_detail,t.loading=!1):t.loading=!1,e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),t.loading=!1,console.warn(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))()},getCompanyList:function(){var t=this;return(0,i.default)(regeneratorRuntime.mark((function e(){var r,a,n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.default.getDepartList({is_without_julive:!1});case 3:r=e.sent,a=r.data,n=a.code,i=a.data,0===n&&(t.belongCompanyList=i||[]),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.warn(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()},closeDialog:function(t){this.dialogShow=t}}};e.default=u},9404:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=r("23f7"),n={getInitConfInfo:function(t){return a.axios.post("/backend-api/org/alloc-priority-config/init",t)},saveConfigInfo:function(t){return a.axios.post("/backend-api/org/alloc-priority-config/save",t)},getPriorityList:function(t){return a.axios.post("/backend-api/org/alloc-priority-config/get-city-priority-list",t)}};e.default=n},"97eb":function(t,e,r){"use strict";r.d(e,"a",(function(){return a})),r.d(e,"b",(function(){return n}));var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"dialog-box"},[r("el-dialog",{attrs:{title:t.cityName+"的优先级配置",visible:t.dialogVisibles,width:"30%"},on:{"update:visible":function(e){t.dialogVisibles=e},closed:t.closeDialog}},[r("div",[r("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData}},[r("el-table-column",{attrs:{prop:"priority",label:"优先级"}}),r("el-table-column",{attrs:{prop:"org_name",label:"公司"}})],1)],1)])],1)},n=[]},"9d69":function(t,e,r){"use strict";r.r(e);var a=r("4d9a"),n=r("dd28");for(var i in n)["default"].indexOf(i)<0&&function(t){r.d(e,t,(function(){return n[t]}))}(i);r("7034");var o=r("2877"),s=Object(o.a)(n.default,a.a,a.b,!1,null,"6c675904",null);e.default=s.exports},a2c3:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={props:{dialogVisible:{type:Boolean,default:!1},cityName:{type:String,default:""},tableData:{type:Array,default:function(){return[]}}},data:function(){return{dialogVisibles:!1}},watch:{dialogVisible:function(t,e){this.dialogVisibles=t}},methods:{closeDialog:function(){this.$emit("closeDialog",!1)}}};e.default=a},bb2f:function(t,e,r){var a=r("d039");t.exports=!a((function(){return Object.isExtensible(Object.preventExtensions({}))}))},dd28:function(t,e,r){"use strict";r.r(e);var a=r("8538"),n=r.n(a);for(var i in a)["default"].indexOf(i)<0&&function(t){r.d(e,t,(function(){return a[t]}))}(i);e.default=n.a},e2e6:function(t,e,r){(e=r("24fb")(!1)).push([t.i,".edit-config[data-v-6c675904]{padding:20px 30px}.edit-config .normal-input[data-v-6c675904]{width:200px}.edit-config .box-wrap[data-v-6c675904]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.edit-config .btn-check[data-v-6c675904]{margin-left:20px}.edit-config .percent-unit[data-v-6c675904]{margin-left:10px}.rule-form[data-v-6c675904]{margin-top:20px;padding:40px 30px 20px;background-color:#fff}.rule-form .number-form[data-v-6c675904]{width:200px}.rule-form .add-goal[data-v-6c675904]{margin-top:25px;line-height:40px;font-size:16px;text-align:center;border:1px dashed #ccc;cursor:pointer}.rule-form .notice-msg[data-v-6c675904]{color:#909399}",""]),t.exports=e},f183:function(t,e,r){var a=r("d012"),n=r("861d"),i=r("5135"),o=r("9bf2").f,s=r("90e3"),u=r("bb2f"),l=s("meta"),c=0,d=Object.isExtensible||function(){return!0},f=function(t){o(t,l,{value:{objectID:"O"+ ++c,weakData:{}}})},p=t.exports={REQUIRED:!1,fastKey:function(t,e){if(!n(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!i(t,l)){if(!d(t))return"F";if(!e)return"E";f(t)}return t[l].objectID},getWeakData:function(t,e){if(!i(t,l)){if(!d(t))return!0;if(!e)return!1;f(t)}return t[l].weakData},onFreeze:function(t){return u&&p.REQUIRED&&d(t)&&!i(t,l)&&f(t),t}};a[l]=!0},f97d3:function(t,e,r){"use strict";r.r(e);var a=r("97eb"),n=r("5c85");for(var i in n)["default"].indexOf(i)<0&&function(t){r.d(e,t,(function(){return n[t]}))}(i);var o=r("2877"),s=Object(o.a)(n.default,a.a,a.b,!1,null,null,null);e.default=s.exports}}]);